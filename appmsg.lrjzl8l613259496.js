function e(){import.meta.url,import("_").catch((()=>1))}import"./modulepreload-polyfill.lrjzl8l64abee2a4.js";/* empty css                                        */import{V as t}from"./vue.runtime.esm.lrjzl8l67cbeb265.js";import{n as i,u as n,e as o,w as a,j as s,o as r,A as c,a as d,b as l,P as p,m,c as _,d as u,B as w,f as h,L as g,g as f,s as y,K as b,h as v,i as x,k,l as A,p as C,q as T}from"./index.lrjzl8l6221a74f6.js";import{P as I,W as S,M as j,R as E,i as R,B,C as N,a as L,b as P,c as D,d as q,e as z,f as O,g as M,h as W,j as H,w as U,A as F,p as J,k as V}from"./wxwork_hidden.lrjzl8l6efa153e6.js";import{t as X,s as $}from"./topbar.lrjzl8l67f6ff7c6.js";import G from"./ext_loading.lrjzl8l65c08a031.js";import{A as K,$ as Q,U as Y,c as Z,j as ee,a as te,g as ie}from"./device.lrjzl8l65ebf7685.js";import{C as ne}from"./class.lrjzl8l632861355.js";import{m as oe,J as ae}from"./core.lrjzl8l6633d1da5.js";import{p as se,A as re,w as ce}from"./page_utils.lrjzl8l63eb24f31.js";import{p as de,e as le}from"./page_cls_ctrl.lrjzl8l6bbe1df6f.js";import{D as pe}from"./event.lrjzl8l682acd1b6.js";import{T as me}from"./tmpl.lrjzl8l6b6faf396.js";import{u as _e}from"./comm_utils.lrjzl8l689333dc8.js";import{w as ue}from"./comm_report.lrjzl8l63dc1a3ca.js";import{d as we}from"./base64.lrjzl8l618dbe4cd.js";import{p as he,o as ge,a as fe}from"./page_utils.lrjzl8l6968f639d.js";import"./appmsgext.lrjzl8l6b6efefef.js";import{O as ye}from"./outer_link.lrjzl8l6d612eaca.js";import{D as be,N as ve,I as xe}from"./dom.lrjzl8l6c37e669f.js";import{R as ke}from"./review_image.lrjzl8l62b522351.js";import{u as Ae,g as Ce}from"./pay_report_utils.lrjzl8l6b359e101.js";import{g as Te,i as Ie}from"./index.lrjzl8l62af67608.js";import{s as Se}from"./set_article_read.lrjzl8l6a1652eae.js";import{h as je}from"./render_utils.lrjzl8l6373276d5.js";import{n as Ee}from"./_plugin-vue2_normalizer.lrjzl8l6fc2fb13f.js";import{L as Re,a as Be}from"./like_and_share.lrjzl8l6bdb5787f.js";import{r as Ne,a as Le,c as Pe,V as De,q as qe,k as ze}from"./voice_component.lrjzl8l6879e6e29.js";import{m as Oe}from"./underline_action.lrjzl8l6d5f94995.js";import{i as Me,a as We,g as He,b as Ue,s as Fe,c as Je,d as Ve,f as Xe}from"./advance.lrjzl8l6918bc40b.js";import{I as $e}from"./interaction.lrjzl8l6ad36f1bf.js";import{B as Ge,V as Ke}from"./background_color.lrjzl8l65dd5e477.js";import{i as Qe}from"./article_bottom_bar.lrjzl8l605a06c69.js";import{D as Ye}from"./img_onload_handler.lrjzl8l6ce139fc0.js";import{h as Ze}from"./moment.lrjzl8l607db360f.js";import{r as et}from"./pre_loading.lrjzl8l6807b610a.js";import{g as tt}from"./get_word_cnt.lrjzl8l61a70c97b.js";import"./set_custom_ele.lrjzl8l6f9e0beb6.js";import"./modal.lrjzl8l6d01ea73f.js";import"./intersection-observer.lrjzl8l6e16580c9.js";import"./range_close.lrjzl8l6999db38f.js";import"./storage.lrjzl8l6595374ad.js";import"./wxgspeedsdk.lrjzl8l6180611fe.js";import"./i18n.lrjzl8l62e3f9c7c.js";import"./get_page_read_pos.lrjzl8l6911ed9d5.js";import"./body_first_observer.lrjzl8l655cb6e3e.js";import"./stream_hide_useless.lrjzl8l6e7a65152.js";import"./bind_element.lrjzl8l61e4c871e.js";const it=[];function nt(){try{!function(){window.location.href.indexOf("clearStorage=1")>=0&&(localStorage.removeItem("max-age-storage-test"),console.log("clear localStorage"));var e=window.user_uin||0;if(0!==e&&Math.floor(e/100)%1e3<1&&(K({type:"GET",url:"/mp/reportcache?type=1&random="+Math.random()}),(new Image).src="/mp/reportcache?type=2&uin="+uin,localStorage&&null==localStorage.getItem("max-age-storage-test"))){console.log("localStorage empty");try{localStorage.setItem("max-age-storage-test",!0),console.log("localStorage set success")}catch(t){}K({type:"GET",url:"/mp/reportcache?type=3&random="+Math.random()})}}(),"undefined"==typeof getComputedStyle&&document.body.currentStyle&&(window.getComputedStyle=function(e){return e.currentStyle}),function(){let e=window.user_uin||0;if(!(0!==e&&Math.floor(e/100)%1e3<10))return;let t=document.getElementsByTagName("img"),i=t.length,n=document.getElementById("img-content"),o=n.offsetWidth,a=0,s=0,r=getComputedStyle(n);a=parseInt(r.paddingLeft)+parseInt(r.paddingRight),o-=a,o||(o=window.innerWidth-30);for(let c=0;c<i;++c){if(!t[c].getAttribute("data-src"))continue;let e=1*t[c].getAttribute("data-w")||o,i=1*t[c].getAttribute("data-ratio");i&&i>0&&e>o&&s++}s>0&&it.push({idkey:28307,order:22,num:s})}(),function(){let e="/mp/jsmonitor?idkey=",t=[];for(let i=0,n=it.length;i<n;++i){let e=it[i],n=e.idkey.toString()+"_"+e.order.toString()+"_"+e.num.toString();t.push(n)}e+=t.join(";"),it.length>0&&((new Image).src=e)}()}catch(e){console.error(e)}}let ot=!1;const at=navigator.userAgent.match(/MicroMessenger\/(\d+)\.(\d+)\.(\d+)/);if(at){const e=Number(at[1]),t=Number(at[2]),i=Number(at[3]);(e>6||6===e&&t>5||6===e&&5===t&&i>=3)&&(ot=!0)}const st={tagName:"mp-wxaproduct",isWechat:(oe.isAndroid||oe.isIOS)&&oe.isWechat&&!oe.isWxWork,isPcWechat:oe.isWindowsWechat||oe.isMacWechat,screen_height:_e.getInnerHeight(),canJumpOnTap:ot,commonReportData:{},minishopDom:[],appmsgType:1*window.appmsg_type||9},rt=(e={})=>{const t=e.dom,i=e.minishopInfo;pe.on(t,"tap",(function(e){e.stopPropagation(),e.preventDefault(),ue.report(22042,Object.assign({},st.commonReportData,{ActionType:2,toWxaAppId:i.appid,CardType:"large"===i.cardtype?1:0,ProductId:i.productId,isMassSend:st.appmsgType})),((e={})=>{st.isWechat||st.isPcWechat?st.canJumpOnTap?S.jumpUrl({options:{userName:e.username,scene:1058,sceneNote:encodeURIComponent(location.href),relativeURL:e.path},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){"openWeApp:ok"===e.err_msg||console.error(e.err_msg)}}):console.log("cant jumpOnTap"):new I({msg:"请使用微信打开。"})})(i)}),!0),pe.on(t,"click",(e=>{e.preventDefault(),e.stopPropagation()}),!0)},dt=()=>{for(let e=0;e<st.minishopDom.length;e++){const t=st.minishopDom[e];if(1*t.getAttribute("data-hasreport")!=1){const e=document.documentElement.scrollTop||document.body.scrollTop,i=t.getAttribute("data-wxaproduct-productid")||"0",n=t.getAttribute("data-wxaproduct-appid")||"",o=t.getAttribute("data-wxaproduct-cardtype")||"mini";t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+st.screen_height&&(t.setAttribute("data-hasreport",1),ue.report(22042,Object.assign({},st.commonReportData,{ActionType:1,toWxaAppId:n,CardType:"large"===o?1:0,ProductId:i,isMassSend:st.appmsgType})))}}};pe.on(window,"scroll",dt);const lt=(e={})=>{if(e.node&&e.data&&e.data.headimg){const t=function(e){let t=e.node,i=e.data;return function(){let e=document.createElement("div");e.innerHTML=me.tmpl('<# if(cardtype === \'mini\') {#>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_small js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>购买</button>\n    </div>\n  </div>\n</div>\n<#} else { #>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_large js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd weui-flex__item">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>购买</button>\n    </div>\n  </div>\n</div>\n<# } #>',i,!0).replace(/>\s*</g,"><").replace(/^\s+/,"").replace(/\s+$/,"");let n=e.firstChild;t.parentNode.insertBefore(n,t.nextSibling);let o=t.parentNode.querySelector('[data-preloadingid="'+i.productId+'"]');o&&o.parentNode.removeChild(o),rt({dom:n,minishopInfo:i}),st.minishopDom.push(n),dt()}}(e),i=function(){this.onload=null,this.onerror=null,t()};let n=new Image;n.onload=i,n.onerror=i,n.src=e.data.headimg}},pt=e=>{K({url:"/mp/wapwxaproduct?action=batch_get_product&product_ids=".concat(JSON.stringify({list:e})),type:"GET",dataType:"json",success(e){e&&e.base_resp&&1*e.base_resp.ret==0&&"[object Array]"===Object.prototype.toString.call(e.product_list)&&((e=[])=>{const t=document.querySelectorAll(st.tagName);for(let i=0,n=t.length;i<n;i++){let n=t[i];const o=decodeURIComponent(n.getAttribute("data-wxaproduct-productid")||""),a=e.find((e=>e.product_id===o))||{},s={productId:o,title:n.getAttribute("data-wxaproduct-title")||"",price:decodeURIComponent(n.getAttribute("data-wxaproduct-price")||""),headimg:decodeURIComponent(n.getAttribute("data-wxaproduct-headimg")||""),cardtype:decodeURIComponent(n.getAttribute("data-wxaproduct-cardtype")||""),avatar:a.avatar||"",nickname:a.nickname||"",appid:a.appid||decodeURIComponent(n.getAttribute("data-wxaproduct-appid")||""),path:a.path||"",username:a.username||""};lt({data:s,node:n})}})(e.product_list)},error(t){st.retry?(st.retry--,pt(e)):console.error(t)}})},mt=(e={})=>{e.minishopCards&&(st.commonReportData={BizUin:1*we(e.biz),MsgId:window.parseInt(e.mid,10)||0,ItemIdx:window.parseInt(e.idx,10)||0,Scene:window.parseInt(e.source,10)||0,SubScene:window.parseInt(e.subscene,10)||0,EnterId:window.parseInt(e.enterid,10)||0},pt(e.minishopCards.list),dt())},_t='<span class="qa__card js_qa_card_inner">\n  <# if (qaDeleted) { #>\n    <span class="qa__card-deleted">讨论内容已被删除</span>\n  <# } else { #>\n    <span>\n      <span class="qa__card-hd">\n        <span class="qa__hd-notice"><#=nickname#> 发起了一个读者讨论</span>\n        <span class="qa__hd-question"><#==title#></span>\n      </span>\n      <# if (!answerCount) { #>\n        <# if (isLogin) { #>\n          \x3c!-- <# if (disableAnswerWord) { #>\n            <span class="qa__list-answer qa__list-answer_desc"><#=disableAnswerWord#></span>\n          <# } else { #>\n            <span class="qa__list-answer js_qa_write_answer">参与讨论</span>\n          <# } #> --\x3e\n          <span class="qa__list-answer qa__list-answer_desc">讨论已结束</span>\n        <# } #>\n      <# } else { #>\n        <span>\n          <span class="qa__list-hd">\n            <span class="qa__list-hd-title js_qa_list_head_title">精选讨论内容</span>\n            \x3c!-- <# if (isLogin) { #>\n              <# if (disableAnswerWord) { #>\n                <span class="qa__list-hd-desc"><#=disableAnswerWord#></span>\n              <# } else { #>\n                <span class="qa__list-hd-action js_qa_write_answer">参与讨论</span>\n              <# } #>\n            <# } #> --\x3e\n          </span>\n          <span class="qa__list js_qa_qna_answer_list"><#==answerListStr#></span>\n          <# if (leftAnswerCnt) { #>\n            <p class="qa__list-more js_more_answer_entry" data-count="<#=answerCount#>"><#=leftAnswerCnt#></p>\n          <# } #>\n        </span>\n      <# } #>\n    </span>\n  <# } #>\n</span>',ut='<div class="qa__list-item js_qa_list_item">\n  \x3c!-- 层主头像 --\x3e\n  <section class="qa__item-avatar">\n    <img src="<#=user_info.headimg#>">\n  </section>\n  <section class="qa__item-bd">\n    <div class="qa__item-info">\n      \x3c!-- 层主昵称 --\x3e\n      <div class="qa__item-nickname">\n        <#=user_info.nickname#>\n      </div>\n      \x3c!-- 点赞 --\x3e\n      <div class="qa__item-action">\n        \x3c!-- span加praised点赞 --\x3e\n        <# if (is_my_answer && canOp) { #>\n          <div class="qa__action js_delete_answer" data-id="<#=answer_id#>"><i class="icon_delete"></i></div>\n        <# } #>\n        \x3c!-- 精选之后的才能点赞 --\x3e\n        <# if (answer_status && isLogin) { #>\n          <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="1" data-id="<#=answer_id#>">\n            <i class="icon_praise_gray"></i>\n            <span class="js_like_num" data-num="<#=like_num#>">\n              <#=likeNumFormated#>\n            </span>\n          </div>\n        <# } #>\n        <# if (!answer_status) { #>\n          <div class="qa__action qa__action_normal">未精选</div>\n        <# } #>\n      </div>\n    </div>\n\n    \x3c!-- 回答内容 --\x3e\n    <p class="qa__item-content js_qa_item_content"><#=content#></p>\n    \x3c!-- <# if (is_my_answer && canOp) { #>\n    <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (replyListHtml) { #>style="display: none;"<# } #>><span>回复</span></div>\n    <# } #> --\x3e\n\n    \x3c!-- 回复 --\x3e\n    <section class="qa__reply">\n      <section class="js_qa_reply_list js_qa_reply_list_<#=answer_id#>">\n        <#=replyListHtml#>\n      </section>\n      <# if (replyListHtml && leftReplyCount) { #>\n        <p class="qa__reply-more js_get_more_reply js_get_more_reply_<#=answer_id#>" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>">\n          <#=leftReplyTips#>\n        </p>\n      <# } #>\n      \x3c!-- <# if (is_my_answer && canOp) { #>\n      <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (!replyListHtml) { #>style="display: none;"<# } #>><span>回复</span></div>\n      <# } #> --\x3e\n    </section>\n  </section>\n</div>',wt='<section class="qa__reply-item js_qa_reply_item<# if (is_my_reply) { #> js_qa_my_reply<# } #>">\n  <div class="qa__reply-hd">\n    <div class="qa__reply-nickname">\n      <# if (is_biz_reply) { #>\n        作者\n      <# } else { #>\n        <#=user_info.nickname#>\n      <# } #>\n    </div>\n    <div class="qa__item-action">\n      <# if (is_my_reply && canOp) { #>\n        <div class="qa__action js_delete_reply" data-id="<#=reply_id#>"><i class="icon_delete"></i></div>\n      <# } #>\n      \x3c!-- 精选之后的才能点赞 --\x3e\n      <# if (replyStatus && isLogin) { #>\n        <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="2" data-id="<#=reply_id#>">\n          <i class="icon_praise_gray"></i>\n          <span class="js_like_num" data-num="<#=like_num#>">\n            <#=likeNumFormated#>\n          </span>\n        </div>\n      <# } #>\n      <# if (!replyStatus) { #>\n        <div class="qa__action qa__action_normal">未精选</div>\n      <# } #>\n    </div>\n  </div>\n  <p class="qa__reply-content js_qa_reply_content"><#=content#></p>\n</section>',ht='<div class="qa__modal-reply">\n  <div class="qa__modal-reply-msg js_reply_top_content"></div>\n  <div class="frm_textarea_box_wrp">\n    <span class="frm_textarea_box" style="position: relative; display: block;">\n      <div style="position: relative; height: 9.6em; overflow: hidden; font-size: 17px;">\n        <textarea class="frm_textarea js_qa_input" placeholder="内容被公众号精选后，将对所有人可见。" style="height: 9.6em; width: 100%; border: none; outline: none;"></textarea>\n      </div>\n      <div class="emotion_tool">\n        <span class="emotion_switch" style="display:none;"></span>\n        <span id="js_qa_emotion_switch" class="pic_emotion_switch_wrp">\n          <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n          <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n          <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n          <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n        </span>\n      </div>\n    </span>\n  </div>\n  <div class="emotion_panel" id="js_qa_emotion_panel">\n    <span class="emotion_panel_arrow_wrp" id="js_qa_emotion_panel_arrow_wrp">\n      <i class="emotion_panel_arrow arrow_out"></i>\n      <i class="emotion_panel_arrow arrow_in"></i>\n    </span>\n    <div class="emotion_list_wrp" id="js_qa_emotion_slide_wrapper"></div>\n    <ul class="emotion_navs" id="js_qa_emotion_navbar"></ul>\n  </div>\n</div>\n<div class="qa__list-wrp">\n  <div class="qa__list-hd js_qa_write_head" style="display: none;">\n    <span class="qa__list-hd-title">我的讨论内容</span>\n  </div>\n  <div class="qa__list js_qa_qna_answer_list"></div>\n</div>\n\n<div class="js_loading_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-loading weui-icon_toast"></i>\n    <p class="weui-toast__content js_loading_content">正在加载</p>\n  </div>\n</div>\n\n<div class="js_sended_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n    <p class="weui-toast__content" id="js_toast_msg">已发送</p>\n  </div>\n</div>\n\n<div class="qa__toast-alert js_alert_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class=" qa__icon-alert"></i>\n    <p class="weui-toast__content js_alert_toast_word"></p>\n  </div>\n</div>',gt="weui-btn_disabled",ft="page_no_scroll",yt="".concat(screen.height/4*3,"px"),bt={top:Q.os.pc?"20%":"".concat(screen.height/4-(screen.height-window.innerHeight),"px"),btnText:"提交",hasHeader:!0,clickMask2Hide:!0,animationType:"bottom",scroll2Hide:!0};function vt(e,t,i,n){i=n?"".concat(i,"px"):i,e.style[t]=i}class xt{constructor(e,t={}){t=Object.assign({},bt,t);const i=document.createElement("div");i.innerHTML=me.tmpl('<div class="wx_bottom_modal_wrp <#=extClass#>">\n  <div\n    class="weui-half-screen-dialog wx_bottom_modal js_bottom_modal_content"\n    role="dialog"\n    aria-modal="true"\n    aria-hidden="true"\n    tabindex="0"\n    <# if (!autoHeight) { #>\n      style="max-height: none;"\n    <# } else { #>\n      style="max-height: <#=maxHeight#>;"\n    <# } #>\n  >\n    <# if (hasHeader) { #>\n      <div class="weui-half-screen-dialog__hd__wrp">\n        <div class="weui-half-screen-dialog__hd js_bottom_modal_hd">\n          <div class="weui-half-screen-dialog__hd__side">\n            <button class="weui-btn_icon js_close_bottom_modal weui-wa-hotarea">关闭<i class="weui-icon-half-screen-close"></i></button>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__main">\n            <strong class="weui-half-screen-dialog__title js_bottom_modal_title">标题</strong>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__side">\n            <# if (hasBtn) { #>\n              <# if (btnSlot) { #>\n                <div role="button" class="js_submit_bottom_modal weui-wa-hotarea">\n                  <#==btnSlot#>\n                </div>\n              <# } else { #>\n                <button class="weui-btn weui-btn_primary weui-btn_xmini js_submit_bottom_modal weui-wa-hotarea"><#=btnText#></button>\n              <# } #>\n            <# } #>\n            <button class="weui-btn_icon" style="display:none;">更多<i class="weui-icon-more"></i></button>\n          </div>\n        </div>\n      </div>\n    <# } #>\n    <div class="weui-half-screen-dialog__bd js_bottom_modal_bd">\n      <div role="alert" class="wx_bottom_modal_msg_wrp js_modal_loading" style="display: none;">\n        <div class="wx_bottom_modal_msg">\n          <i class="weui-loading" role="img" aria-label="加载中"></i>\n        </div>\n      </div>\n      \x3c!-- 上下拉加载loading --\x3e\n      <div role="alert" class="weui-loadmore js_pull_loading" style="display: none;">\n        <i class="weui-loading"></i>\n        <span class="weui-loadmore__tips">正在加载</span>\n      </div>\n\n      \x3c!-- 加载完成的dom，插到js_bottom_modal_bd下 --\x3e\n      <div role="option" class="weui-loadmore weui-loadmore_line weui-loadmore_dot js_modal_end_line" style="display: none;">\n        <div class="weui-hidden_abs">已无更多数据</div>\n        <span class="weui-loadmore__tips"></span>\n      </div>\n    </div>\n    <# if (hasFooter) { #>\n      <div class="weui-half-screen-dialog__ft js_bottom_modal_ft"></div>\n    <# } #>\n  </div>\n  <# if (hasMask) { #>\n    \x3c!-- 透明mask，用于防止点透 --\x3e\n    <div class="wx_bottom_modal_mask_fixed js_bottom_modal_mask_not_click"></div>\n\n    \x3c!-- 有底色的mask --\x3e\n    <div class="weui-mask wx_bottom_modal_mask js_bottom_modal_mask"></div>\n  <# } #>\n</div>',{hasBtn:t.hasBtn,btnText:t.btnText,extClass:t.extClass||"",hasMask:!t.removeMask,isTopic:!!t.isTopic,hasHeader:t.hasHeader,hasFooter:!!t.footerEl,btnSlot:t.btnSlot,autoHeight:t.autoHeight,maxHeight:yt});const n=i.firstChild;this.scrollLock=!1,this.curScrollTop=0,this.touches={startX:0,startY:0,curX:0,curY:0,isScreenLeft:!1,direction:"",times:0},this.opt=t,this.rootEle=n,this.contentEle=e,this.contentAreaWrp=n.getElementsByClassName("js_bottom_modal_bd")[0],this.contentAreaWrp.appendChild(e),this.contentArea=n.getElementsByClassName("js_bottom_modal_content")[0],this.loading=this.rootEle.getElementsByClassName("js_modal_loading")[0],this.pullLoading=this.rootEle.getElementsByClassName("js_pull_loading")[0],this.endLine=this.rootEle.getElementsByClassName("js_modal_end_line")[0],this.enableGesture=!1,this.triggerEl=null,this.isAutoFocus=!0,t.removeMask||(this.maskEle=n.getElementsByClassName("js_bottom_modal_mask")[0],this.maskNotClick=n.getElementsByClassName("js_bottom_modal_mask_not_click")[0],t.transparentMask&&vt(this.maskEle,"opacity",0)),t.hasHeader&&(this.headAreaWrp=n.getElementsByClassName("js_bottom_modal_hd")[0],this.submitBtn=this.headAreaWrp.getElementsByClassName("js_submit_bottom_modal")[0],this.closeBtn=this.headAreaWrp.getElementsByClassName("js_close_bottom_modal")[0],this.setTitle(t.title)),t.footerEl&&(this.footAreaWrp=n.querySelector(".js_bottom_modal_ft"),this.footAreaWrp.appendChild(t.footerEl)),"right"===t.animationType&&this.rootEle.classList.add("wx_bottom_modal_right"),document.body.appendChild(n),t.cb&&t.cb(),this.bindEvent()}bindEvent(){this.maskEle&&(this.opt.clickMask2Hide&&pe.tap(this.maskEle,(()=>{this.hide()})),pe.on(this.contentArea,"transitionend",(e=>{e.target!==this.contentArea||"transform"!==e.propertyName&&"-ms-transform"!==e.propertyName||(""!==this.contentArea.style.transform?this.contentArea.style.removeProperty("transform"):this.getShowStatus()?"function"==typeof this.opt.onShowAfterAnimation&&this.opt.onShowAfterAnimation():(vt(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&vt(this.contentArea,"top",this.opt.top)))})),pe.tap(this.maskNotClick,(()=>setTimeout((()=>{this.hide(),vt(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&vt(this.contentArea,"top",this.opt.top)}),300))),pe.on(this.maskEle,"touchmove",(e=>{e.preventDefault()}))),this.headAreaWrp&&(pe.on(this.headAreaWrp,"touchstart",(e=>this.onTouchStart(e))),pe.on(this.headAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),pe.on(this.headAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.footAreaWrp&&(pe.on(this.footAreaWrp,"touchstart",(e=>this.onTouchStart(e))),pe.on(this.footAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),pe.on(this.footAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.closeBtn&&pe.on(this.closeBtn,"click",(()=>{this.hide()})),this.submitBtn&&pe.on(this.submitBtn,"click",(()=>{ne.hasClass(this.submitBtn,gt)||this.opt.btnClickCb&&this.opt.btnClickCb()})),pe.on(this.contentAreaWrp,"scroll",(()=>{this.checkReachBoundary(),this.contentAreaWrp.scrollTop>0?ne.addClass(this.contentArea,"weui-half-screen-dialog_headline"):ne.removeClass(this.contentArea,"weui-half-screen-dialog_headline")})),this.headAreaWrp&&pe.tap(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0],(()=>{this.opt.titleClickCb&&this.opt.titleClickCb()})),pe.on(this.contentAreaWrp,"touchstart",(e=>this.onTouchStart(e))),pe.on(this.contentAreaWrp,"touchmove",(e=>{const t=e.changedTouches[0];if(this.getTouchDirection(t)){if("Y"===this.touches.direction){const n=this.contentAreaWrp,o=t.pageY,a=o-this.touches.startY,s=n.scrollTop<=0&&a>0,r=(i=n,Math.ceil(i.scrollTop+i.offsetHeight)>=i.scrollHeight&&a<0);s||r?(s&&!this.opt.onPullDownLoad&&this.move(o),e.preventDefault()):this.resetMovement(),this.touches.curY=o}else e.preventDefault(),this.moveByDirection(t)}var i})),pe.on(this.contentAreaWrp,"touchend",(e=>this.onTouchEnd(e))),pe.on(window,"unload",(()=>{this.opt.removeMask||i.hide()}))}checkReachBoundary(e=!0,t=!0){this.scrollLock&&0!==this.contentAreaWrp.scrollTop||(this.scrollLock=!0,setTimeout((()=>{this.scrollLock=!1}),50),e&&!this.pullingDownLock&&this.contentAreaWrp.scrollTop<=0&&(this.opt.onPullDownLoad&&this.opt.onPullDownLoad(),this.pullingDownLock=!0),setTimeout((()=>{t&&!this.pullingUpLock&&this.contentAreaWrp.scrollTop+this.contentAreaWrp.offsetHeight+100>this.contentEle.offsetHeight&&(this.opt.onPullUpLoad&&this.opt.onPullUpLoad(),this.pullingUpLock=!0)}),100),this.opt.onScroll&&this.opt.onScroll(this.contentAreaWrp.scrollTop>this.curScrollTop?"up":"down"),this.curScrollTop=this.contentAreaWrp.scrollTop)}onTouchStart(e){const t=e.touches[0];this.touches={startX:t.pageX,startY:t.pageY,curX:t.pageX,curY:t.pageY,isScreenLeft:this.enableGesture&&t.pageX<=30,direction:"",times:0},this.contentArea.style.transition="none"}onTouchEnd(e){const t=this.touches.direction,i="X"===t?100:this.contentArea.offsetHeight/4,n=e.changedTouches[0]["page".concat(t)]-this.touches["start".concat(t)],o=this.contentArea.dataset;this.contentArea.style.removeProperty("transition"),o.distance&&(n>i?this.hide():this.contentArea.style.transform="translateY(0)",delete o.distance)}getTouchDirection(e){if(this.touches.direction)return!0;if(!this.touches.isScreenLeft)return this.touches.direction="Y",!0;this.touches.times++;const t=Math.abs(e.pageX-this.touches.startX),i=Math.abs(e.pageY-this.touches.startY);return this.touches.times>=3?(this.touches.direction=t>=i?"X":"Y",!0):t>=5&&t>=i?(this.touches.direction="X",!0):i>=5&&(this.touches.direction="Y",!0)}moveByDirection(e){const t=this.touches.direction,i=e["page".concat(t)];i-this.touches["start".concat(t)]>0?this.move(i):this.resetMovement(),this.touches["cur".concat(t)]=i}move(e){if(this.opt.sideslip2Hide&&"X"===this.touches.direction||this.opt.scroll2Hide&&"Y"===this.touches.direction){const t=this.contentArea.dataset;t.distance=1*(t.distance||0)+e-this.touches["cur".concat(this.touches.direction)],this.contentArea.style.transform="translateY(".concat(t.distance,"px)")}}resetMovement(){delete this.contentArea.dataset.distance,this.contentArea.style.removeProperty("transform")}show(e,t,o,a=!0){ne.addClass(document.body,ft),this.triggerEl=o||window.event&&window.event.target,this.isAutoFocus=a,this.getShowStatus()||(e||this.opt.autoHeight||(vt(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight)),vt(this.contentArea,"visibility","visible"),ne.addClass(this.rootEle,"wx_bottom_modal_show"),this.setAriaHidden(!1),this.contentArea.focus(),this.maskEle&&this.opt.clickMask2Hide&&vt(this.maskNotClick,"visibility","visible"),this.opt.removeMask||i.show({alpha:this.opt.transparentMask?0:.6,callback:e=>{e&&"function"==typeof this.opt.onShowNavShadow&&this.opt.onShowNavShadow()},onClick:()=>{this.hide()}}),this.opt.sideslip2Hide&&(Q.os.ios?ae.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!0},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!0)})):n.disable({onGoBack:()=>{this.hide()},onDisable:()=>{this.enableGesture=!0},onEnable:()=>{this.enableGesture=!1}})),e&&(ne.addClass(this.rootEle,"wx_bottom_modal_form"),vt(this.contentArea,"top","25px")),setTimeout((()=>{e||"right"===this.opt.animationType&&(vt(this.contentArea,"-ms-transform","translateX(0)"),vt(this.contentArea,"transform","translateX(0)"))})),e&&(setTimeout((()=>{"bottom"===this.opt.animationType?vt(this.contentArea,"top","100%"):vt(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight),ne.removeClass(this.rootEle,"wx_bottom_modal_form"),setTimeout((()=>{vt(this.contentArea,"top",this.opt.top),"right"===this.opt.animationType&&(vt(this.contentArea,"-ms-transform","translateX(0)"),vt(this.contentArea,"transform","translateX(0)"))}))}),50),Q.os.ios?t.focus():(this.tmpInputEle||(this.tmpInputEle=t.cloneNode(!0)),this.tmpInputEle.style.opacity=0,this.tmpInputEle.style.position="fixed",this.tmpInputEle.style.top=0,this.tmpInputEle.style.zIndex="-1",document.body.appendChild(this.tmpInputEle),setTimeout((()=>{t.focus(),this.opt.makeInputEleBigger&&this.opt.makeInputEleBigger(),document.body.removeChild(this.tmpInputEle)}),300),this.tmpInputEle.focus()),Q.os.ios&&!this.hasBindInputEvent&&this.opt.makeFakeInputEle&&this.opt.removeInputEle&&(this.hasBindInputEvent=!0,pe.on(t,"focus",(()=>{setTimeout((()=>{t.style.opacity=1,this.opt.removeInputEle()}),50)})),pe.on(t,"blur",(()=>{this.opt.makeFakeInputEle(),t.style.opacity=0})))),this.opt.onShow&&this.opt.onShow())}hide(e){ne.removeClass(document.body,ft),e&&vt(this.maskNotClick,"visibility","hidden"),this.getShowStatus()&&(this.contentArea.style.removeProperty("-ms-transform"),this.contentArea.style.removeProperty("transform"),ne.removeClass(this.rootEle,"wx_bottom_modal_show"),this.setAriaHidden(!0),this.isAutoFocus&&function(e){if(!(e&&e instanceof HTMLElement))return!1;const t=window.getComputedStyle(e);return 0!==t.width&&0!==t.height&&0!==t.opacity&&"none"!==t.display&&"hidden"!==t.visibility&&null!==e.offsetParent}(this.triggerEl)&&(this.triggerEl.setAttribute("tabindex","0"),this.triggerEl.focus()),this.opt.removeMask||i.hide(),this.opt.sideslip2Hide&&(Q.os.ios?ae.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!1},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!1)})):n.enable({onEnable:()=>{this.enableGesture=!1}})),this.opt.onHide&&this.opt.onHide())}disableBtn(){this.submitBtn&&ne.addClass(this.submitBtn,gt)}enableBtn(){this.submitBtn&&ne.removeClass(this.submitBtn,gt)}finishPullUpLoad(){this.pullingUpLock=!1}finishPullDownLoad(){this.pullingDownLock=!1}setTitle(e){this.headAreaWrp&&("string"==typeof e?this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e:"object"==typeof e&&e.innerHTML&&(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e.innerHTML))}scrollTo(...e){this.contentAreaWrp.scrollTo(...e)}getRootEle(){return this.rootEle}getBdEle(){return this.contentAreaWrp}getScrollEle(){return this.contentAreaWrp}setCloseBtnStyle(e){if(this.closeBtn){const t=this.closeBtn.getElementsByTagName("i")[0],i="weui-icon-close-thin",n="weui-icon-back-arrow-thin";"back"===e?(ne.removeClass(t,i),ne.addClass(t,n)):(ne.removeClass(t,n),ne.addClass(t,i))}}getShowStatus(){return ne.hasClass(this.rootEle,"wx_bottom_modal_show")}showLoading(){vt(this.loading,"display","block")}hideLoading(){vt(this.loading,"display","none")}showPullUpLoading(){this.contentAreaWrp.appendChild(this.pullLoading),vt(this.pullLoading,"display","block")}hidePullUpLoading(){vt(this.pullLoading,"display","none")}showPullDownLoading(){this.contentAreaWrp.insertBefore(this.pullLoading,this.contentAreaWrp.firstChild),vt(this.pullLoading,"display","block")}hidePullDownLoading(){vt(this.pullLoading,"display","none")}showEndLine(){this.contentAreaWrp.appendChild(this.endLine),vt(this.endLine,"display","block")}setAriaHidden(e){this.contentArea.setAttribute("aria-hidden",e.toString())}disablePullDownLoad(){this.opt.onPullDownLoad=null}}function kt(e,t,i=0){return e.getElementsByClassName(t)[i]}const At=document.getElementsByTagName("mp-qa")[0];let Ct,Tt,It,St,jt,Et,Rt,Bt,Nt,Lt,Pt={},Dt=0,qt=0,zt=0,Ot="";const Mt=10,Wt="answerList",Ht="myAnswerList",Ut="praised",Ft="modalWriteAnswerClass",Jt="25px",Vt={__biz:At&&At.dataset.bizuin,question_id:At&&At.dataset.id,qna_sn:At&&function(e){let t;if(window.qnaCardData)try{t=JSON.parse(window.qnaCardData);const i=t.list;if(i&&i.length)for(let t=0;t<i.length;t++)if(e===i[t].question_id)return i[t].qna_sn}catch(i){console.error(i)}return""}(At.dataset.id)},Xt={};function $t(e){e&&(e.style.display="none")}function Gt(e){e&&(e.style.display="block")}function Kt(e,t){a.jsmonitor({id:223326,key:e,value:t})}function Qt(){window.weui.topTips("系统错误，请稍后再试")}function Yt(e={}){ue.report(20883,Object.assign({Device:Q.os.ios?1:Q.os.android?2:-1,MsgId:1*Vt.mid,ItemIdx:1*Vt.idx,BizUin:Pt.biz,ItemShowType:1*Pt.itemShowType,SessionId:Pt.sessionId,EnterId:1*Pt.enterId,Scene:1*Pt.scene,SubScene:1*Pt.subScene,QaId:At.dataset.id},e))}function Zt(e,t,i){const n={replyListHtml:"",replyList:document.createDocumentFragment()};return e&&e.reply_list&&e.reply_list.length&&(n.leftReplyCount=e.left_reply_cnt,n.leftReplyTips="余下#value#条回复".replace("#value#",e.left_reply_cnt),e.reply_list.forEach((e=>{e.canOp=i,e.content=e.content.htmlEncode(),e.content=o.encode(e.content),e.likeNumFormated=he.formatReadNum(e.like_num),e.replyStatus=void 0===e.reply_status?1:e.reply_status,e.isLogin=Ct;const t=document.createElement("div");t.innerHTML=me.tmpl(wt,e,!1),n.replyListHtml+=t.innerHTML,n.replyList.appendChild(t.firstChild)}))),n}function ei(e,t,i=""){const n={answerListHtml:"",fragment:document.createDocumentFragment()};return e.forEach((e=>{e.likeNumFormated=he.formatReadNum(e.like_num),e.canOp=t,e.answer_sn=e.answer_sn||"",e.content=e.content.htmlEncode(),e.oriContent=e.content,e.content=o.encode(e.content),e.isLogin=Ct;const i=Zt(e.reply_info,e.answer_id,t);Object.assign(e,i);const a=document.createElement("div");a.innerHTML=me.tmpl(ut,e,!1),n.answerListHtml+=a.innerHTML,n.fragment.appendChild(a.firstChild)})),i===Ht?qt+=Mt:i===Wt&&(Dt+=Mt),n}function ti(e={}){const t=Object.assign({action:e.action,limit:Mt,offset:e.offset},Vt);K({url:Y.join("/mp/qna",t),dataType:"json",success(t){let i;t&&(i=t.qna_info?t.qna_info.answer_info:t.answer_info,e.successCb(i,t))},complete(){e.complete&&e.complete()}})}function ii(e,t){let i=0;for(;e.offsetParent&&e!==t;)i+=e.offsetTop,e=e.offsetParent;return i}function ni(e,t,i){const n=e.dataset.answerid,o=i?ii(e,It.getScrollEle()):0;K({url:Y.join("/mp/qna",Object.assign({action:"get_more_reply",answer_id:n,answer_sn:e.dataset.answersn,limit:10},Vt)),dataType:"json",success(t){if(t&&t.reply_info&&t.reply_info.reply_list&&t.reply_info.reply_list.length){const n=Zt(t.reply_info,0,!0);n.replyListHtml?(kt(e.parentNode,"js_qa_reply_list").appendChild(n.replyList),n.leftReplyCount?e.innerHTML=n.leftReplyTips:$t(e),i&&It.scrollTo(0,o-48)):$t(e)}}})}function oi(e){const t=kt(St,"js_get_more_reply_".concat(e));t&&ni(t,0,!0)}function ai(){return kt(Et,"js_qa_input")}function si(){const e=ai();return(e.value||e.innerHTML).trim()}function ri(){si()?jt.enableBtn():jt.disableBtn()}function ci(e={}){ti({action:e.action,offset:e.offset,successCb(t,i){if(t&&t.answer_list&&t.answer_list.length){let i,n;"get_my_answer"===e.action?(i=Ht,n=Et,Gt(kt(Et,"js_qa_write_head"))):(i=Wt,n=St);kt(n,"js_qa_qna_answer_list").appendChild(ei(t.answer_list,!0,i).fragment)}e.cb&&e.cb(t,i)}})}function di(){if(!Et)return;const e="回复: #value#".replace("#value#",o.encode(Ot)),t=kt(Et,"js_reply_top_content");Rt?(t.innerHTML=e,Gt(t)):$t(t)}function li(e){kt(Et,"js_alert_toast_word").innerHTML=e,Gt(kt(Et,"js_alert_toast")),setTimeout((()=>{$t(kt(Et,"js_alert_toast"))}),800)}function pi(){let e=0;const t=St.getElementsByClassName("js_qa_list_item");for(let i=0;i<t.length&&t[i].getBoundingClientRect().y<_e.getInnerHeight();i++)e++;e>zt&&(zt=e)}function mi(e,t){if(It)return It.show(),void(e&&t&&oi(t));let i;St=At.firstChild.cloneNode(!0);const n=kt(St,"qa__list-more"),o=kt(St,"js_qa_write_answer");n&&$t(n),o&&ne.addClass(o,Ft),kt(St,"js_qa_qna_answer_list").innerHTML="",It=new xt(St,{title:"读者讨论",extClass:"qa__card",onPullUpLoad(){i>0&&(It.showPullUpLoading(),ci({action:"get_more_answer",offset:Dt,cb(e,t){It.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?It.finishPullUpLoad():It.showEndLine()}}))},cb(){ci({action:"get_more_answer",offset:Dt,cb(n){if(e&&t)oi(t);else{const e=Tt.dataset.count,t=ii(kt(St,"js_qa_list_item",e),It.getScrollEle());It.scrollTo(0,t-96)}i=n.left_answer_cnt,i||It.showEndLine()}})},onScroll(){pi()},onHide(){pi(),Yt({EventType:3,Exposure:zt}),zt=0}}),It.show(),pe.on(St,"tap",".js_get_more_reply",(e=>{ni(e.delegatedTarget)}))}function _i(e){let t;const i=Rt?"写回复":"参与讨论";if(jt)return di(),jt.setTitle(i),e?jt.setCloseBtnStyle("back"):jt.setCloseBtnStyle("close"),void jt.show(!0,ai());Et=document.createElement("div"),Et.innerHTML=me.tmpl(ht,{}),jt=new xt(Et,{title:i,top:Jt,extClass:"qa__card qa__card_write",hasBtn:!0,disableTransition:!0,onPullUpLoad(){t>0&&(jt.showPullUpLoading(),ci({action:"get_my_answer",offset:qt,cb(e,t){jt.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?jt.finishPullUpLoad():jt.showEndLine()}}))},onHide(){ai().blur()},onScroll(e){"up"===e&&ai().blur()},cb(){ci({action:"get_my_answer",offset:qt,cb(e){t=e.left_answer_cnt,t||jt.showEndLine()}})},btnClickCb(){jt.disableBtn();const e=Rt?"add_reply":"add_answer";Gt(kt(Et,"js_loading_toast")),K({url:"/mp/qna?action=".concat(e),type:"POST",dataType:"json",data:Object.assign({answer_id:Nt,answer_sn:Lt,content:si(),my_reply_cnt:Bt+1,ignore_tips:1},Vt),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){if(Gt(kt(Et,"js_sended_toast")),setTimeout((()=>{$t(kt(Et,"js_sended_toast"))}),800),ai().value="",jt.disableBtn(),Rt&&e.reply_info&&e.reply_info.reply_list){const t=Zt(e.reply_info,0,!0).replyList,i=kt(Et,"js_qa_reply_list_".concat(Nt));i.appendChild(t.cloneNode(!0)),Gt(kt(i.parentNode,"js_write_reply")),$t(kt(i.parentNode.parentNode,"js_write_reply"))}else if(!Rt&&e.answer_info&&e.answer_info.answer_list){const t=kt(Et,"js_qa_qna_answer_list");t.insertBefore(ei(e.answer_info.answer_list,!0).fragment,t.firstChild),Gt(kt(Et,"js_qa_write_head"))}}else jt.enableBtn(),168003===e.base_resp.ret||168007===e.base_resp.ret?li("内容涉嫌违反平台协议或法规政策"):168004===e.base_resp.ret?li("关注该公众号才能参与讨论"):168005===e.base_resp.ret?li("关注该公众号3天及以上才能参与讨论"):168008===e.base_resp.ret||168009===e.base_resp.ret?li("字数不能多于"+(Rt?140:600)):Qt()},error(){Qt(),jt.enableBtn()},complete(){$t(kt(Et,"js_loading_toast")),ai().blur()}})},makeFakeInputEle(){const e=ai(),t=e.cloneNode();t.id="tmp_input",t.style.top=0,t.style.position="absolute",e.parentNode.insertBefore(t,e),t.value=e.value,t.scrollTop=e.scrollTop},removeInputEle(){const e=document.getElementById("tmp_input");e&&e.parentNode.removeChild(e)},makeInputEleBigger(){const e=ai(),t="1000px";e.style.borderTop="solid ".concat(t," transparent"),e.style.position="relative",e.style.top="-".concat(t)}}),di(),jt.disableBtn(),e?jt.setCloseBtnStyle("back"):jt.setCloseBtnStyle("close"),jt.show(!0,ai()),function(){const e=ai();pe.on(Et,"tap",".js_get_more_reply",(e=>{ni(e.delegatedTarget)})),pe.on(e,"input",ri),pe.on(e,"tap",(()=>{jt.scrollTo(0,0)}))}(),new o.Emotion({emotionPanel:s("#js_qa_emotion_panel"),inputArea:s(ai()),emotionPanelArrowWrp:s("#js_qa_emotion_panel_arrow_wrp"),emotionSwitcher:s("#js_qa_emotion_switch"),emotionSlideWrapper:s("#js_qa_emotion_slide_wrapper"),emotionNavBar:s("#js_qa_emotion_navbar"),inputEmotion(){ri()}})}const ui={renderQaCard:function(e={}){At&&(Vt.mid=e.mid,Vt.idx=e.idx,Pt.userUin=e.userUin,Pt.biz=e.biz,Pt.itemShowType=e.itemShowType,Pt.enterId=e.enterId,Pt.scene=e.scene,Pt.subScene=e.subScene,Pt.sessionId=e.sessionId,Ct=e.isLogin,ti({action:"get_qna_info",successCb(e,t){let i,n,a,s;const c=t.base_resp.ret,d=168001===c,l=t.qna_info&&t.qna_info.question_info;d?At.innerHTML=me.tmpl(_t,{qaDeleted:d}):0===c&&("1"===Y.getQuery("js_my_answer")&&(_i(),Kt(4)),e&&e.answer_list&&e.answer_list.length&&(a=ei(e.answer_list,!1).answerListHtml,n=e.answer_list.length,e.left_answer_cnt&&(i="余下#value#条讨论内容".replace("#value#",e.left_answer_cnt))),1===l.can_answer_type&&0===t.qna_info.is_fans?s="作者已设置关注后才可参与讨论":2===l.can_answer_type&&0===t.qna_info.is_fans_days&&(s="作者已设置关注7天后才可参与讨论"),At.innerHTML=me.tmpl(_t,{qaDeleted:d,answerCount:n,leftAnswerCnt:i,answerListStr:a,disableAnswerWord:s,title:o.encode(l.question_title.htmlEncode()),nickname:l.biz_info.nickname,isLogin:Ct}),Tt=kt(At,"js_more_answer_entry"),function(){let e;function t(){if(e)return;const t=At.firstChild,i=r.getOffset(t).offsetTop,n=_e.getScrollTop();n+_e.getInnerHeight()>=i&&n<=i+t.offsetHeight&&(Yt({EventType:1}),Kt("0"),e=!0)}pe.on(At,"tap",".js_get_more_reply",(e=>{const t=e.delegatedTarget.dataset.answerid;Xt[t]?mi():(mi(!0,t),Xt[t]=!0)})),pe.on(document.body,"click",".js_qa_write_answer",(e=>{Rt=!1,_i(ne.hasClass(e.delegatedTarget,Ft)),Kt(2)})),pe.on(document.body,"click",".js_write_reply",(e=>{const t=e.delegatedTarget,i=t.parentNode.parentNode;if(Nt=t.dataset.answerid,Lt=t.dataset.answersn,i){const e=i.getElementsByClassName("js_qa_reply_content");Bt=i.getElementsByClassName("js_qa_my_reply").length,Ot=e.length?e[e.length-1].innerHTML:kt(i,"js_qa_item_content").innerHTML}Rt=Nt,Rt&&(_i(!0),Kt(3))})),pe.on(Tt,"click",(()=>{mi(),Yt({EventType:2}),Kt(1)})),pe.on(document.body,"tap",".js_qa_like",(e=>{const t=e.delegatedTarget,i=ne.hasClass(t,Ut);ne.toggleClass(t,Ut);const n=kt(t,"js_like_num");let o=(parseInt(n.dataset.num,10)||0)+(i?-1:1);o=o>=0?o:0,n.innerHTML=he.formatReadNum(o),n.dataset.num=o,Kt("2"===t.dataset.type?6:5),K({url:"/mp/qna?action=like",type:"POST",data:Object.assign({like_type:t.dataset.type,op:i?2:1,answer_id:t.dataset.id,reply_id:t.dataset.id},Vt)})})),pe.on(document.body,"tap",".js_delete_answer",(e=>{const t=e.delegatedTarget;Kt(7),setTimeout((()=>{window.weui.confirm("确定删除讨论内容吗？",{buttons:[{label:"取消",type:"default"},{label:"删除",type:"primary",onClick(){K({url:"/mp/qna?action=del_answer",type:"POST",dataType:"json",data:Object.assign({answer_id:t.dataset.id},Vt),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode.parentNode;e&&ne.hasClass(e,"js_qa_list_item")&&e.parentNode.removeChild(e)}else Qt()}})}}]})}),50)})),pe.on(document.body,"tap",".js_delete_reply",(e=>{const t=e.delegatedTarget;Kt(8),setTimeout((()=>{window.weui.confirm("确定删除回复吗？",{buttons:[{label:"取消",type:"default"},{label:"删除",type:"primary",onClick(){K({url:"/mp/qna?action=del_reply",type:"POST",dataType:"json",data:Object.assign({reply_id:t.dataset.id},Vt),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode;if(e&&ne.hasClass(e,"js_qa_reply_item")){const t=e.parentNode;t.removeChild(e),t.children.length||($t(t.parentNode),$t(kt(t.parentNode,"js_write_reply")),Gt(kt(t.parentNode.parentNode,"js_write_reply")))}}else Qt()}})}}]})}),50)})),_e.bindDebounceScrollEvent(t),t()}())}}))}};let wi=[],hi=0;const gi={auditing:1,ban:2};function fi(e,t){const i="object"==typeof e?e:wi[e];if(i.dataset.hasBanner)return;const n=document.createElement("div");n.dataset.hasBanner=1,n.style="background-color: var(--weui-BG-1);font-size: 14px;color: var(--weui-FG-2);text-align: left;margin-top: 20px;margin-bottom: 4px;padding: 4px 8px 6px 8px;border-radius:4px;";const o=document.createElement("span");o.style="color: var(--weui-FG-0);padding: 2px;display: inline-block;vertical-align: middle; width: 20px;height: 20px;margin-right: 4px; background-size: cover;background-position: center center;-webkit-mask: url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20'%3E  %3Cpath fill-opacity='.3' fill-rule='evenodd' d='M10 1.667a8.333 8.333 0 1 1 0 16.666 8.333 8.333 0 0 1 0-16.666zm-.004 11.115a.732.732 0 0 0-.746.735c0 .416.33.735.746.735a.73.73 0 0 0 .752-.735.73.73 0 0 0-.752-.735zm.638-7.669h-1.27l.091 6.33h1.088l.091-6.33z'/%3E%3C/svg%3E\") no-repeat 50% 50%;mask: url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20'%3E  %3Cpath fill-opacity='.3' fill-rule='evenodd' d='M10 1.667a8.333 8.333 0 1 1 0 16.666 8.333 8.333 0 0 1 0-16.666zm-.004 11.115a.732.732 0 0 0-.746.735c0 .416.33.735.746.735a.73.73 0 0 0 .752-.735.73.73 0 0 0-.752-.735zm.638-7.669h-1.27l.091 6.33h1.088l.091-6.33z'/%3E%3C/svg%3E\") no-repeat 50% 50%;background-color: currentColor;";const a=document.createElement("span");a.style="display: inline-block;line-height: 14px;vertical-align: middle;",a.innerHTML=t,n.appendChild(o),n.appendChild(a),i.parentNode.insertBefore(n,i,null),i.dataset.hasBanner=1}function yi(e,t,i){const n=e.length,o=[...Array(n)].map((()=>"〇")).join(""),{childNodes:a}=t;let s=i;for(let r=0;r<a.length;r++){const e=a[r];3===e.nodeType?s>e.data.length?s-=e.data.length:e.data=e.data.slice(0,s).concat(o).concat(e.data.slice(s+n)):1===e.nodeText&&(s-=e.innerText&&e.innerText.length||0)}}function bi(e,t,i){const n=e.length,{$node:o,realOffset:a}=be.findChildIndex(t,i);try{o.splitText(a)}catch(c){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","splitText Error",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{type:"disputeText textNode",data:e,cursor:i}})}const s=o.nextSibling;try{s.splitText(n)}catch(c){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","splitText Error",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{type:"disputeText nextSibling",data:e,cursor:i}})}const r=document.createElement("span");r.style="background-color: rgba(0,0,0,0.10);",r.appendChild(s.cloneNode(!0)),s.parentNode.replaceChild(r,s)}function vi(e,t){const i=document.createElement("span");i.style="position:relative;display: inline-block;";const n=document.createElement("span");n.style="\n            position: absolute;\n            top: 4px;\n            left: 4px;\n            display: inline-block;\n            vertical-align: middle;\n            width: 24px;\n            height: 24px;\n            background-size: cover;\n            background-image: url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23FFF' fill-rule='evenodd' d='M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2zm-.004 13.339a.878.878 0 0 0-.896.882c0 .499.396.882.896.882.512 0 .902-.383.902-.882 0-.5-.39-.882-.902-.882zm.765-9.203h-1.524l.11 7.596h1.305l.11-7.596z'/%3E%3C/svg%3E\");\n    ";const o=t.parentNode;i.appendChild(t.cloneNode(!1)),o.replaceChild(i,t),i.appendChild(n)}function xi(e,t){t.style.filter="blur(10px)",t.style["-webkit-filter"]="blur(10px)"}function ki(e,t){const{data:i,meta:n,index:o,idx:a}=e,s=t.data,r=(n||"")+i;if(-1===s.indexOf(r))return{hit:!1};const c=be.getNodeByIndex(wi[a],o);c?hi++:"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","text node cannot find",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{anchor:e,wholeText:s}});const d=c&&c.innerText.indexOf(r)+(n||"").length;return{hit:!!c,$hitDom:c,cursor:d}}function Ai(e,t){const{index:i,idx:n,data:o}=e,a=wi[n].querySelectorAll("img")[i];return(a&&(a.getAttribute("data-src")||a.getAttribute("src")))===o?(hi++,{hit:!0,$hitDom:t,cursor:0}):{hit:!1}}function Ci(e,t){return(i,n,o)=>{const{hit:a,$hitDom:s,cursor:r}=i(e,t);a&&(n(e.data,s,r),o())}}function Ti(e,t){if(!e)return null;const{type:i,data:n,meta:o}=t;if(i===ve.text){const t=e.innerText||"",i=((o||"")+n).replace(/&amp;/g,"&");if(-1!==t.indexOf(i)){return{cursor:t.indexOf(i)+(o||"").length,node:e}}}if(i===ve.img){if((e&&(e.getAttribute("data-src")||e.getAttribute("src")))===n.replace(/&amp;/g,"&"))return{cursor:0,node:e}}return null}function Ii(e,t){wi=be.getParaList(e,{getNestedStructure:!0,removeIgoreEle:!1});const i=(n="idx",t.reduce(((e,t)=>(void 0===t[n]||(e[t[n]]||(e[t[n]]=[]),e[t[n]].push(t)),e)),{}));var n;wi&&((wi||[]).forEach(((e,t)=>{const n=i[t];n&&n.length>0&&(fi(t,(n[0],'以下内容存在争议 <a style="color: var(--weui-LINK);" target="_blank" href="https://mp.weixin.qq.com/s/_2kC-fXw7UjneZSrsC9CVQ">了解更多</a>')),function(e,t){const i=[],n=[...e];i.push(t);let o=null;const a=()=>{o=n.shift()};for(a();i.length>0&&n.length>=0&&o;){const e=i.pop();if(!e)continue;if(!o)continue;const{nodeType:t,tagName:n}=e,s=Ci(o,e);if(3===t){o.type===ve.text&&s(ki,o.status===gi.ban?yi:bi,a);continue}if(1===t&&n===xe){o.type===ve.img&&s(Ai,o.status===gi.ban?xi:vi,a);continue}const r=e.childNodes;for(let o=r.length-1;o>=0;o--)i.push(r[o])}}(n,e))})),t&&t.length!==hi&&"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","totalHit",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{totalHit:hi,anchors:t}}))}function Si(e,t){const i=[],n=[],o=[],a={};t.forEach(((t,s)=>{const{selector:r,index:c,total:d}=function(e){if(!e)return{};const[t,i]=e.split("|"),[n,o]=i.split(" ");return{selector:t.replace(/&gt;/g,">"),total:1*n,index:1*o}}(t.selector);let l=a[r]||[];if(0===l.length)try{l=e.querySelectorAll(r),a[r]=l}catch(g){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","splitText Error",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{anchor:t}})}let p=c,m=c;const _=[];let u=null,w=0,h=0;for(_.push(l[c]);_.length;){const e=Ti(_.pop(),t);if(h++,e&&e.node){u=e.node,w=e.cursor;break}p-1>=0&&l[p-1]&&(_.push(l[p-1]),p-=1),m+1<l.length&&l[m+1]&&(_.push(l[m+1]),m+=1)}u?(o.push({anchor:t,node:u,cursor:w}),function(e,t){const i=be.getPureBlockNode(e);i&&fi(i,'以下内容存在争议 <a style="color: var(--weui-LINK);" target="_blank" href="https://mp.weixin.qq.com/s/_2kC-fXw7UjneZSrsC9CVQ">了解更多</a>')}(u)):r&&-1!==r.lastIndexOf(">")&&i.push({...t,selector:r&&r.slice(0,r.lastIndexOf(">"))+"|".concat(d," ").concat(c)}),n[s]=h})),o.forEach((e=>{!function(e,t,i){const{type:n,data:o,status:a}=e;a===gi.ban&&(n===ve.text&&yi(o,t,i),n===ve.img&&xi(0,t))}(e.anchor,e.node,e.cursor)})),i.length&&(Si(e,i),"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Error","missNodes",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{missNodes:i}})),"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.report("ArticleMask:Info","querycount",{mid:"mmbizwap:articlemask_Monitor",view:"wap_business",_info:{countList:n}})}const ji={init:function(e,t){let i=[],n=[];t.forEach((e=>{e.selector?n.push(e):i.push(e)})),function(e,t){Si(e,t)}(e,n),i.length>0&&Ii(e,i)}},Ei=function(e,t){let i=!1,n=e;if(e===t)i=!0;else for(;n.parentNode&&(n=n.parentNode,1!==n.nodeType||"body"!==n.tagName.toLowerCase());)if(n===t){i=!0;break}return i},Ri=function(e){this.biz=e.biz,this.logid=e.logid,this.baseData=e.baseData,this.isPaySubscribe=e.isPaySubscribe,this.container=e.container,this.totalLength=this.container.innerText.length,this.initEvent()};Ri.prototype.initEvent=function(){pe.on(document,"copy",(()=>{const e=[].concat(this.baseData),t=this.getContentData().trim();t.length&&(e.push(this.totalLength),e.push(""),e.push(t.length),e.push(this.isPaySubscribe),this.report(e.join(",")))}))},Ri.prototype.getContentData=function(){const e=document.getSelection(),t=this.container;let i="";if(e&&e.rangeCount){const n=e.getRangeAt(0);if(!n.collapsed){const o=n.startContainer,a=n.startOffset,s=n.endContainer,r=n.endOffset,c=Ei(o,t),d=Ei(s,t);if(c&&d)i=n.toString();else if(c||d){const e=document.createRange();e.setStart(o,a),e.setEnd(s,r),!d&&e.setEndAfter(t),!c&&e.setStartBefore(t),i=e.toString()}else if(e.containsNode&&e.containsNode(t,!0)){const e=document.createRange();e.setEndAfter(t),e.setStartBefore(t),i=e.toString()}}}return i},Ri.prototype.report=function(e){const t=this.biz,i=this.logid;K({url:"/mp/webcommreport?action=report&report_useruin=1&__biz="+t,type:"POST",data:{logid:i,buffer:e},async:!1,timeout:2e3})};const Bi={copyright_top:0};function Ni(e){let t=["/mp/copyrightreport?action=report&biz=",biz,"&scene=",e.scene,"&user_uin=",user_uin,"&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&mid=",window.mid,"&idx=",window.idx,"&source_biz=",window.source_biz,"&source_mid=",window.source_mid,"&source_idx=",window.source_idx,"&card_version=2","&show_appmsg_scene=",window.source,"&session_id=",window.sessionid,"&has_recommend_msg=",window.hasRecommendMsg,"&reprint_type=",window.reprint_type,"&t=",Math.random()].join("");window.isSg&&(t+="&from=sougou"),(new Image).src=t.substr(0,1024)}function Li(){(window.pageYOffset||document.documentElement.scrollTop)+_e.getInnerHeight()>Bi.copyright_top&&(Ni({scene:"1",card_pos:"0"}),pe.off(window,"scroll",Li),Li=Bi.copyright_top=null)}function Pi(e){return document.getElementById(e)}const Di={card_click_report:Ni,card_pv_report:function(){if("2"==__appmsgCgiData.copyright_stat){let e=Pi("copyright_info"),t=Pi("js_article");for(;e&&t!==e;)Bi.copyright_top+=e.offsetTop,e=e.offsetParent;pe.on(window,"scroll",Li),Li()}}};const qi=Ee({name:"mp-sponsor-ad",components:{[c.name]:c},data:()=>({posType:d.AD_POS.POS_SPONSOR}),methods:{handleAdFrameMessage(e){e===d.FRAME_READY&&l.report115849(63)}}},(function(){var e=this;return(0,e._self._c)("mp-ad-frame",{attrs:{"pos-type":e.posType},on:{"ad-frame-message":e.handleAdFrameMessage}})}),[],!1,null,null,null,null).exports;const zi=Ee({name:"mp-pay-wall",filters:{formatNum:e=>e>=1e4?"en"===window.LANG?"10k+":"1万+":e},data:()=>({perLine:p.getCountPerLine()}),computed:{...m(["cgiData","extRes"]),...m("mp-pay-read",["paySubscribeInfo"]),total(){return 3*this.perLine},wrapWidth(){return 40*this.perLine-8},avatarList(){var e,t,i,n;return this.paySubscribeInfo?this.cgiData.isPaid&&!this.cgiData.payFreeGift?[null==(e=this.paySubscribeInfo)?void 0:e.my_head_img_info,...((null==(t=this.paySubscribeInfo)?void 0:t.pay_head_img_infos)||[]).slice(0,this.total-1)]:(null==(n=null==(i=this.paySubscribeInfo)?void 0:i.pay_head_img_infos)?void 0:n.slice(0,this.total))||[]:[]}},methods:{onPayNumClick(){p.goUrl("/mp/paysub?action=evaluate_show_page&__biz=".concat(this.cgiData.biz,"&product_type=").concat(this.cgiData.productPayPackage.product_type,"&product_id=").concat(this.cgiData.productPayPackage.product_id,"&sn=").concat(this.cgiData.sn,"&link=").concat(encodeURIComponent(this.cgiData.msg_link),"&from_scene=").concat(this.cgiData.source,"&from_subscene=").concat(this.cgiData.subscene,"&is_fans=").concat(this.cgiData.isFans))},onRewardNumClick(){const e=(Math.ceil((_e.getInnerHeight()-188)/42)+1)*Math.floor((innerWidth-15)/42);p.goUrl("/mp/reward?act=getrewardheads&__biz=".concat(this.cgiData.biz,"&appmsgid=").concat(this.cgiData.mid,"&idx=").concat(this.cgiData.idx,"&sn=").concat(this.cgiData.sn,"&offset=0&count=").concat(e,"&source=1"))}}},(function(){var e=this,t=e._self._c;return e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt?t("div",{staticClass:"pay__detail-wrp pay__detail-wrp_inner pay__detail-wrp_v2",attrs:{id:"js_pay_wall_wrap"}},[t("div",{staticClass:"pay__detail"},[t("div",{staticClass:"pay__detail-content"},[t("div",{staticClass:"pay__detail-summary",on:{click:e.onPayNumClick}},[t("span",[e._v(e._s(e._f("formatNum")(e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt))+" 人付费")]),e.extRes.reward_total_count?t("span",[e._v("，"+e._s(e._f("formatNum")(e.extRes.reward_total_count))+" 人喜欢")]):e._e(),t("i",{staticClass:"weui-icon-arrow reward_area_arrow"})]),t("div",{staticClass:"pay__detail-wall-wrp",style:{width:"".concat(e.wrapWidth,"px")}},[t("div",{staticClass:"pay__detail-wall",attrs:{id:"js_pay_wall"}},e._l(e.avatarList,(function(i){return t("div",{key:i.head_img_url,class:"pay__avatar-wrp ".concat(i.hide_status>0?"pay__avatar-mask":"")},[t("img",{attrs:{alt:"",src:i.head_img_url}}),i.reward_status?t("div",{staticClass:"pay__tag-reward js_reward"}):e._e()])})),0)])])])]):e._e()}),[],!1,null,null,null,null).exports;const Oi=Ee({name:"mp-pay-btn",props:{buttonText:{type:String,default:"微信豆兑换"}},computed:{...m(["cgiData"]),...m("mp-pay-read",["loading","isInMiniProgram"])},methods:{..._("mp-pay-read",["payFunc"])}},(function(){var e=this,t=e._self._c;return t("button",{ref:"payPanelBtn",staticClass:"js_pay_btn js_article_bottom weui-btn weui-btn_loading",class:{btn_disabled:e.isInMiniProgram},on:{click:e.payFunc}},[e.loading?t("div",{staticClass:"js_button_loading"},[e._m(0),e._v(" 加载中 ")]):t("div",[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price js_pay_fee",attrs:{id:"js_pay_fee_normal"}},[e._v(e._s(e.cgiData.wecoin_amount))]),e._v(" "+e._s(e.buttonText)+" ")])])}),[function(){var e=this._self._c;return e("span",{staticClass:"weui-primary-loading weui-primary-loading_transparent"},[e("i",{staticClass:"weui-primary-loading__dot"})])}],!1,null,null,null,null).exports,Mi=8+window.parseInt(window.getComputedStyle(document.documentElement).getPropertyValue("--sab"));let Wi=0,Hi=0,Ui=!1,Fi=0;const Ji=window.scrollY,Vi=window.innerHeight/3;const Xi=Ee({name:"mp-pay-gift",data:()=>({giftBarTitleText:"可赠送给一位朋友免费阅读"}),computed:{...m(["cgiData"]),...m("mp-pay-read",["paySubscribeInfo"])},mounted(){const e=window.localStorage.getItem("paySuc"),t=this.$refs.giftBar.getBoundingClientRect().top;"1"===e&&t>window.innerHeight?(window.localStorage.setItem("paySuc","0"),this.$refs.giftBar.className="pay__gift-send show",this.giftBarTitleText="已兑换，可赠送给一位朋友",p.reportSend(2),pe.on(window,"scroll",this.scrollHandler),pe.on(this.$refs.giftBar,"touchstart",this.touchStartHandler),pe.on(this.$refs.giftBar,"touchmove",this.touchMoveHandler),pe.on(this.$refs.giftBar,"touchend",this.touchEndHandler)):!ne.hasClass(this.$refs.giftBar,"show")&&t<=window.innerHeight&&(this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",p.reportSend(4))},beforeDestroy(){pe.off(window,"scroll",this.scrollHandler)},methods:{present(){if(Q.os.iphone||Q.os.ipad||Q.os.android){let e=this.paySubscribeInfo.gift_url.html(),t="";const i=e.indexOf("#");-1!==i&&(t=e.substring(i),e=e.substring(0,i)),ne.hasClass(this.$refs.giftBar,"pay__gift-send_static")?p.reportSend(5):p.reportSend(3),p.goUrl("".concat(e,"&sessionid=").concat(this.cgiData.sessionid,"&enterid=").concat(this.cgiData.enterid,"&scene=").concat(this.cgiData.source,"&subscene=").concat(this.cgiData.subscene,"&biz=").concat(this.cgiData.biz,"&mid=").concat(this.cgiData.mid,"&idx=").concat(this.cgiData.idx).concat(t))}else window.weui.alert("请使用移动端微信打开")},touchStartHandler(e){ne.hasClass(this.$refs.giftBar,"show")&&(Ui=!0,Fi=e.touches[0].clientY,Wi=Hi)},touchMoveHandler(e){e.preventDefault();const t=e.touches[0].clientY-Fi;ne.hasClass(this.$refs.giftBar,"show")&&Ui&&(t+Wi>=0&&t+Wi<=Mi?(this.$refs.giftBar.style.transform="translate3d(0, ".concat(t+Wi,"px, 0)"),Hi=t+Wi):t+Wi>Mi?(this.$refs.giftBar.style.transform="translate3d(0, ".concat(Mi,"px, 0)"),Hi=Mi):t+Wi<0&&(this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",Hi=0))},touchEndHandler(){Ui=!1,ne.hasClass(this.$refs.giftBar,"show")&&Hi===Mi&&(this.$refs.giftBar.className="pay__gift-send",pe.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),pe.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),pe.off(this.$refs.giftBar,"touchend",this.touchEndHandler))},scrollHandler(){const e=document.getElementById("js_pay_wall_wrap").getBoundingClientRect();e.top+e.height-48<=window.innerHeight?(this.giftBarTitleText="可赠送给一位朋友免费阅读",this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",pe.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),pe.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),pe.off(this.$refs.giftBar,"touchend",this.touchEndHandler),pe.off(window,"scroll",this.scrollHandler),p.reportSend(4)):window.scrollY-Ji>Vi&&(this.$refs.giftBar.className="pay__gift-send")}}},(function(){var e=this,t=e._self._c;return t("div",{ref:"giftBar",staticClass:"pay__gift-send_static pay__gift-send",attrs:{id:"js_pay_gift_bar"}},[t("div",{staticClass:"pay__gift-send-content"},[t("div",{staticClass:"pay__gift-send-title",attrs:{id:"js_pay_gift_bar_title"}},[e._v(" "+e._s(e.giftBarTitleText)+" ")])]),t("div",{staticClass:"pay__gift-send-btn",attrs:{id:"js_send_pay_gift"},on:{click:e.present}},[e._v("去赠送")])])}),[],!1,null,null,null,null).exports;const $i=Ee({name:"mp-pay-read-qrcode",computed:{src(){if(oe.isWindows||oe.isMac&&!oe.isIOS){return"/mp/paysubqrcode?action=get_article_qrcode&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"#wechat_redirect")}return""}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"pay__notice-qrcode js_pay_qrcode_wrap js_pay_fee_display"},[t("div",{staticClass:"pay__qrcode-wrp"},[t("img",{staticClass:"js_pay_qrcode",attrs:{src:e.src}})]),t("div",{staticClass:"pay__qrcode-title"},[e._v("微信扫一扫付费阅读本文")])])}),[],!1,null,null,null,null).exports;const Gi=Ee({name:"mp-pay-read-bottom",components:{[$i.name]:$i,[Oi.name]:Oi},props:{payTopicNoticeText:{type:String,default:""},visible:{type:Boolean}},data:()=>({addLargeFontStyle:!1,bottomHeight:0}),computed:{...m(["cgiData"]),...m("mp-pay-read",["wecoinText","loading"]),...m("mp-stream",["articleFoldStatus"]),...u("mp-pay-read",["topicLink"]),showBottomBar(){return 2===this.cgiData.show_version&&!Q.os.pc&&!oe.isNewMpApp},payBtnText(){return this.showBottomBar?"读全文":"微信豆兑换"}},watch:{articleFoldStatus(e){!e&&this.showBottomBar&&this.$nextTick((()=>{this.judgeHeight("100")}))}},created(){this.unwatchVisible=this.$watch("visible",(e=>{var t,i,n;if(e){const e=null==(i=null==(t=this.$refs.button)?void 0:t.$el)?void 0:i.getBoundingClientRect().height,o=null==(n=this.$refs.content)?void 0:n.getBoundingClientRect().height;this.addLargeFontStyle=o/e>108/52,this.unwatchVisible()}}))},mounted(){this.showBottomBar&&(ae.on("menu:setfont",(e=>{this.judgeHeight(e.fontScale)})),this.$nextTick((()=>{this.judgeHeight("100")})))},methods:{..._("mp-pay-read",["payFunc","goBuyTopic"]),getBottomBarHeight(){const e=document.getElementById("js_article_bottom_bar");return e?Math.floor(null==e?void 0:e.getBoundingClientRect().height):0},judgeHeight(e="100"){setTimeout((()=>{var t,i,n;let o=!1;if("100"===e){const e=null==(i=null==(t=this.$refs.button)?void 0:t.$el)?void 0:i.getBoundingClientRect().height;o=(null==(n=this.$refs.content)?void 0:n.getBoundingClientRect().height)/e>.7}this.addLargeFontStyle=1*e>=140||o,this.bottomHeight=this.getBottomBarHeight()}),100)}}},(function(){var e=this,t=e._self._c;return 1!==e.cgiData.isPayTopic?t("div",{staticClass:"pay pay__notice",class:{pay__notice_largeFont:e.addLargeFontStyle,"pay__notice_new pay_new":e.showBottomBar,pay__notice_hiden:e.articleFoldStatus},style:{bottom:e.bottomHeight+"px"},attrs:{id:"js_pay_panel_bottom"}},[t("div",{staticClass:"pay__notice-intro"},[t("div",{ref:"content",staticClass:"pay__intro-content"},[t("p",{staticClass:"pay__notice-title"},[e._v(" 可试读"+e._s(e.cgiData.preview_percent)+"% ")]),t("div",{staticClass:"pay__notice-desc",attrs:{id:"js_pay_panel_bottom_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")])]),t("div",{staticClass:"pay__notice-btn-wrp"},[t("mp-pay-btn",{ref:"button",attrs:{"button-text":e.payBtnText}}),t("mp-pay-read-qrcode")],1)])]):t("div",{staticClass:"pay pay__notice pay__topic-notice",class:{"pay_new pay__notice_new":e.showBottomBar,pay__notice_hiden:e.articleFoldStatus},style:{bottom:e.bottomHeight+"px"},attrs:{id:"js_pay_topic_panel_bottom"}},[t("div",{staticClass:"pay__notice-intro"},[t("div",{staticClass:"pay__intro-content"},[t("div",{staticClass:"pay__notice-desc"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),e.showBottomBar?e._e():t("p",{staticClass:"pay__notice-title"},[e._v(e._s(e.cgiData.payTopicTitle))])]),t("div",{staticClass:"pay__notice-btn-wrp"},[t("button",{staticClass:"js_pay_topic_btn weui-btn",class:{btn_disabled:e.cgiData.payTopicRemoveFlag>0},attrs:{"data-url":e.topicLink},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")]),t("mp-pay-read-qrcode")],1)])])}),[],!1,null,null,null,null).exports;const Ki=Ee({name:"mp-buy-wecoin-btn",computed:{...m("mp-pay-read",["wecoinRemain"])}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"pay__wecoin-entry"},[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price",attrs:{id:"js_wecoin_remain"}},[e._v(e._s(e.wecoinRemain))])])}),[],!1,null,null,null,null).exports;const Qi=Ee({name:"mp-pay-edu-tips",components:{[w.name]:w},computed:{...m(["cgiData"]),...m("mp-pay-read",["payEduTips"]),top:()=>window.innerHeight-467},methods:{...h("mp-pay-read",["setWecoinRemain","setPayLock","setPayEduTips"]),hideEduTipsCb(){this.$refs.bottomModal.hide(),g.show(),ae.invoke("getWCCoinBalance",{},(e=>{g.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1?(this.setWecoinRemain(e.balance),this.$emit("show-confirm")):this.setPayLock(!1)})),this.setPayEduTips({...this.payEduTips,firstWecoinRecharge:0})},show(){this.$refs.bottomModal.show()}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__edu-modal","has-header":!1,top:"".concat(e.top,"px")},on:{hide:e.hideEduTipsCb},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a",{staticClass:"weui-btn weui-btn_default",on:{click:e.hideEduTipsCb}},[e._v("我知道了")])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin-edu-profile"},[t("div",{staticClass:"pay__wecoin-edu-title"},[e._v(" 可在「我>个人信息>微信豆」页面，查看微信豆消费明细。 ")]),t("div",{staticClass:"pay__wecoin-edu-pic"},[t("div",{staticClass:"pay__wecoin-edu-avatar"},[t("img",{attrs:{src:e.payEduTips&&e.payEduTips.userImgUrl}})]),t("div",{staticClass:"pay__wecoin-edu-nic"},[e._v(" "+e._s(e.payEduTips&&e.payEduTips.userNickname)+" ")])])])])}),[],!1,null,null,null,null).exports;const Yi=Ee({name:"mp-pay-confirm",components:{[w.name]:w,[Qi.name]:Qi,[Ki.name]:Ki},props:{title:{type:String,default:""}},data:()=>({agreeStat:!1}),computed:{...m(["cgiData"]),...m("mp-pay-read",["wecoinRemain","payEduTips","encodeRespBuff"]),needTopup(){return this.wecoinRemain<this.cgiData.wecoin_amount},btnDisabled(){return this.needTopup&&!1===this.agreeStat},wecoinTitle(){return this.needTopup?"微信豆不足，兑换全文还需":"兑换全文"},wecoinPrice(){return this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:this.cgiData.wecoin_amount},wecoinTips(){return"售价 ".concat(this.wecoinPrice/10,"元")}},methods:{...h("mp-pay-read",["setPayLock","setWecoinRemain"]),..._("mp-pay-read",["paySuc","pollCheck"]),onLinkClick(e){e&&e.preventDefault(),Ae.reportPayAppmsg(17),ae.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1})},onTermClick(e){"A"===e.target.tagName&&ae.invoke("openUrlWithExtraWebview",{url:this.cgiData.paySubscribeInfo.agreement_url.htmlDecode(),openType:1})},onTermCheckboxToggle(e){const{footerBtn:t}=this.$refs;e.target.checked?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")},show(){this.$refs.bottomModal.show()},hide(){this.$refs.bottomModal.hide()},onFooterBtnClick(){if(this.$refs.footerBtn.getAttribute("disabled"))return;const{wecoin_amount:e}=this.cgiData;Z.log("[Appmsg] pay process 5 wecoinAmountRemain=".concat(this.wecoinRemain," wecoin_amount=").concat(e)),this.needTopup?(this.hide(),setTimeout((()=>{Ae.reportPayAppmsg(19),Z.log("[Appmsg] pay process 6.1 buyWCCoin");const e=e=>{g.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.needTopup?this.show():this.consumeWCCoin())},t={businessId:2,scene:4,panelShowType:"present",diffWecoinCount:this.cgiData.wecoin_amount>this.wecoinRemain?this.cgiData.wecoin_amount-this.wecoinRemain:0};oe.isAndroid&&oe.gtVersion("8.0.18",!0)&&(t.mode=2,t.agreementVersion=this.cgiData.paySubscribeInfo.agreement_version,t.customCount=this.cgiData.wecoin_amount-this.wecoinRemain,t.productId=this.cgiData.paySubscribeInfo.recharge_product_id),ae.invoke("buyWCCoin",t,(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?oe.isIOS&&oe.ltVersion("8.0.17")||oe.isAndroid&&oe.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(g.show(),ae.invoke("getWCCoinBalance",{},e)):ae.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{g.show(),ae.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)):(this.hide(),this.consumeWCCoin())},consumeWCCoin(){const{encodeRespBuff:e}=this;Z.log("[Appmsg] pay process 3 can_use_wecoin=".concat(this.cgiData.can_use_wecoin)),Z.log("[Appmsg] pay process 4 on payBtn tap"),g.show();const t=Math.round(new Date/1e3);ae.invoke("consumeWCCoin",{buff:e,businessId:2},(i=>{console.log("consumeWCCoin res",i),this.setPayLock(!1),i&&i.err_msg&&i.err_msg.indexOf("ok")>-1?(Ae.reportPay(t,1,e),this.pollCheck()):i&&i.err_msg&&i.err_msg.indexOf("fail")>-1&&(Ae.reportPay(t,3,e,i.err_msg,i.err_code,i.err_domain),weui.alert("兑换失败，请稍后再试"))}))},buyWecoin(){this.hide();const e=e=>{g.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.show())};setTimeout((()=>{Ae.reportPayAppmsg(14);const t=this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:0;ae.invoke("buyWCCoin",{businessId:2,scene:3,panelShowType:"present",diffWecoinCount:t},(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?oe.isIOS&&oe.ltVersion("8.0.17")||oe.isAndroid&&oe.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(g.show(),ae.invoke("getWCCoinBalance",{},e)):ae.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{g.show(),ae.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)}}},(function(){var e=this,t=e._self._c;return t("div",[t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__bottom-modal","has-btn":"","auto-height":""},on:{submit:e.buyWecoin,hide:function(t){return e.setPayLock(!1)}},scopedSlots:e._u([{key:"btn",fn:function(){return[t("mp-buy-wecoin-btn")]},proxy:!0},{key:"footer",fn:function(){return[t("div",[e.needTopup?t("div",{ref:"footerTerm",staticClass:"pay__wecoin-term weui-cells_checkbox",attrs:{id:"js_wecoin_term"},on:{click:e.onTermClick}},[t("label",{attrs:{for:"js_wecoin_term_check"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.agreeStat,expression:"agreeStat"}],ref:"wecoinCheck",staticClass:"weui-check",attrs:{id:"js_wecoin_term_check",type:"checkbox"},domProps:{checked:Array.isArray(e.agreeStat)?e._i(e.agreeStat,null)>-1:e.agreeStat},on:{change:function(t){var i=e.agreeStat,n=t.target,o=!!n.checked;if(Array.isArray(i)){var a=e._i(i,null);n.checked?a<0&&(e.agreeStat=i.concat([null])):a>-1&&(e.agreeStat=i.slice(0,a).concat(i.slice(a+1)))}else e.agreeStat=o}}}),t("i",{staticClass:"weui-icon-checked"}),e._v("同意"),t("a",{attrs:{href:"javascript:;"}},[e._v("《微信豆充值协议》")])])]):e._e(),t("div",{staticClass:"weui-half-screen-dialog__btn-area"},[t("a",{ref:"footerBtn",staticClass:"weui-btn weui-btn_primary",attrs:{disabled:e.btnDisabled},on:{click:e.onFooterBtnClick}},[e._v(e._s(e.needTopup?"去充值":"兑换"))])]),t("div",{staticClass:"weui-half-screen-dialog__attachment-wrp",on:{click:e.onLinkClick}},[t("a",{staticClass:"weui-half-screen-dialog__attachment-link",attrs:{href:"javascript:;"}},[e._v("常见问题")])])])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin"},[t("div",{staticClass:"pay__wecoin-title",staticStyle:{"font-weight":"normal"},attrs:{id:"js_wecoin_title"}},[e._v(" "+e._s(e.wecoinTitle)+" ")]),t("div",{staticClass:"pay__wecoin-content pay__wecoin-content-price"},[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price",attrs:{id:"js_wecoin_price"}},[e._v(e._s(e.wecoinPrice))])]),t("div",{ref:"wecoinTipsDom",staticClass:"pay__wecoin-tips",attrs:{id:"js_wecoin_tips"}},[e._v(" "+e._s(e.wecoinTips)+" ")])])]),t("mp-pay-edu-tips",{ref:"eduTipsModal",on:{"show-confirm":function(t){return e.$refs.bottomModal.show()}}})],1)}),[],!1,null,null,null,null).exports;const Zi=Ee({name:"mp-wecoin-tips",components:{[w.name]:w},computed:{...m("mp-pay-read",["wecoinText"]),top:()=>innerHeight-375},methods:{onQuestionClick(e){e&&e.preventDefault(),Ae.reportPayAppmsg(17),ae.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1}),this.$refs.bottomModal.hide()},show(){this.$refs.bottomModal.show()}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__wecoin-edu-modal",top:"".concat(e.top,"px")},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a",{staticClass:"pay__wecoin-edu-link",on:{click:e.onQuestionClick}},[e._v("常见问题")])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin-edu"},[t("div",{staticClass:"pay__wecoin-title"},[t("div",{staticClass:"pay__icon-wecoin"}),t("div",[e._v("付费内容需用微信豆兑换")])]),t("div",{staticClass:"pay__wecoin-edu-desc"},[e._v(" 微信豆是用于兑换微信内虚拟物品和服务的道具。 "),t("span",[e._v(e._s(e.wecoinText))]),e._v(" 微信豆还可用于兑换直播间的虚拟礼物等。 ")])])])}),[],!1,null,null,null,null).exports;const en=Ee({name:"mp-pay-read",components:{[zi.name]:zi,[Gi.name]:Gi,[$i.name]:$i,[Yi.name]:Yi,[Oi.name]:Oi,[Zi.name]:Zi,[Xi.name]:Xi},data:()=>({iapPriceInfo:null,payReadBottomVisible:!1}),computed:{...m(["cgiData","extRes"]),...m("mp-pay-read",["wecoinText","payLock","wecoinRemain","loading","isInMiniProgram","paySubscribeInfo"]),...u("mp-pay-read",["isPaidLSKey","topicLink"]),contentTextLen(){var e;return 1*(null==(e=this.cgiData.payforread_info)?void 0:e.content_plain_text_len)},canGift(){return!!this.paySubscribeInfo&&this.cgiData.payGiftsCount-this.paySubscribeInfo.gifted_count>0},payFee(){var e;return(1*(null==(e=this.cgiData.payforread_info)?void 0:e.fee)/100).toFixed(2)},isPaid(){return this.cgiData.isPaid},previewPercent(){return this.cgiData.preview_percent},payTopicNoticeText(){return 0===this.previewPercent?"兑换合集后可阅读全文":"兑换合集后可阅读剩余".concat(100-this.previewPercent,"%")},payTopicFreqText(){const e=this.cgiData.payTopicCount,t=this.cgiData.payTopicTotalCount;return e<t?"已发表".concat(e,"个")+" "+"计划发表".concat(t,"个"):"已完结 共".concat(e,"个")},payTopicList(){return this.cgiData.payTopicArticleTitles?this.cgiData.payTopicArticleTitles.slice(0,4):[]},previewTipsText:()=>/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"付费后可赠送给一位朋友免费阅读 (1元 = 7微信豆)":"付费后可赠送给一位朋友免费阅读 (1元 = 10微信豆)",tempkey(){return this.cgiData.tempkey},payFeeNormalText(){const{wecoin_amount:e,fee:t}=this.cgiData;return e>0?e:t/10},showBottomBar(){return 2===this.cgiData.show_version&&!Q.os.pc&&!oe.isNewMpApp},payBtnText(){return this.showBottomBar?"读全文":"微信豆兑换"}},watch:{extRes(e){e.pay_subscribe_info&&(this.setPayEduTips({firstWecoinRecharge:1*e.pay_subscribe_info.first_wecoin_recharge,userImgUrl:e.pay_subscribe_info.user_img_url,userNickname:e.pay_subscribe_info.user_nick_name}),this.setPayGlobal({enable_custom_recharge:e.pay_subscribe_info.enable_custom_recharge,agreement_url:e.pay_subscribe_info.agreement_url,agreement_version:e.pay_subscribe_info.agreement_version,agreement_status:e.pay_subscribe_info.agreement_status,recharge_product_id:e.pay_subscribe_info.recharge_product_id,price:e.pay_subscribe_info.price}),e.pay_subscribe_info.wecoin_tips&&(oe.isIOS||oe.isAndroid)&&!oe.isWxWork&&this.$refs.wecoinTipsModal.show())}},created(){this.iapPriceInfo=this.cgiData.iapPriceInfo},mounted(){ae.on("onScreenShot",(()=>{ee.setSum(114217,15,1)})),Z.log("[Appmsg] pay process 1 isPaySubscribe=".concat(this.cgiData.isPaySubscribe)),ae.on("onScreenShot",(()=>{Ae.reportPayAppmsg(6)}));const e=oe.isWindows||oe.isMac&&!oe.isIOS,t=document.getElementById("js_content"),i=e=>{"IMG"===e.target.tagName&&e.preventDefault()};e&&(t.addEventListener("dragstart",i),oe.isWechat||t.addEventListener("contextmenu",i)),Z.log("[Appmsg] pay process 2 isPaid=".concat(this.isPaid)),this.isPaid||this.initPay()},beforeDestroy(){pe.off(this.cgiData,"scroll",this.togglePayPanelBottom)},methods:{...h("mp-pay-read",["setPayEduTips","setPayGlobal","setConfirmModal"]),..._("mp-pay-read",["payFunc","goBuyTopic"]),initPay(){const e=document.getElementById("js_pay_panel");oe.isAndroid&&"1"===localStorage.getItem(this.isPaidLSKey)&&Ae.report110809(30),this.cgiData.jump2pay&&pe.on(window,"load",(()=>{window.scrollTo(0,e.getBoundingClientRect().top-_e.getInnerHeight()/3)})),this.setConfirmModal(this.$refs.payConfirm),this.togglePayPanelBottom(),pe.on(window,"scroll",this.togglePayPanelBottom)},togglePayPanelBottom(){const e=this.$refs.payReadBottom.$el,t=this.cgiData.isPayTopic?document.getElementById("js_pay_topic_btn"):this.$refs.payBtn.$el,{top:i}=t.getBoundingClientRect(),n=window.getComputedStyle(e);if(i+(40+parseInt(n.paddingTop,10)+parseInt(n.paddingBottom,10))>this.cgiData.innerHeight){if(1*this.cgiData.previewPercent==0)return;if(this.cgiData.isRemovedFromPayTopic&&!this.cgiData.isPaid)return;this.payReadBottomVisible=!0}else this.payReadBottomVisible=!1,window.is_finished_preview=1}}},(function(){var e=this,t=e._self._c;return t("div",[e.isPaid?[t("mp-pay-wall"),e.canGift?t("mp-pay-gift"):e._e()]:[e.previewPercent>0?t("div",{staticClass:"pay__mask_static"}):e._e(),t("div",{staticClass:"pay pay__static",class:{pay_new:e.showBottomBar},attrs:{id:"js_pay_panel"}},[1===e.cgiData.isPayTopic&&e.cgiData.payTopicRemoveFlag>0?t("div",{staticClass:"pay__topic-tips"},[e._v(" "+e._s(1===e.cgiData.payTopicRemoveFlag?"此内容已从合集中移除，不支持付费":"付费合集已被作者删除，不支持付费")+" ")]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!(1!==e.cgiData.isPayTopic||2===e.cgiData.payTopicRemoveFlag),expression:"!(cgiData.isPayTopic !== 1 || cgiData.payTopicRemoveFlag === 2)"}],staticClass:"pay__topic"},[t("div",{staticClass:"pay__topic-hd"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),t("div",{staticClass:"pay__topic-bd"},[t("div",{staticClass:"pay__topic-main"},[t("div",{staticClass:"pay__topic-main-wrp"},[t("div",{staticClass:"pay__topic-title"},[e._v(e._s(e.cgiData.payTopicTitle))]),t("div",{staticClass:"pay__topic-meta"},[t("span",{attrs:{id:"js_pay_topic_freq"}},[e._v(" "+e._s(e.payTopicFreqText)+" ")])])]),t("a",{class:"weui-btn weui-btn_mini ".concat(e.cgiData.payTopicRemoveFlag>0&&!e.isPaid?"weui-btn_disabled":"weui-btn_primary"," weui-wa-hotarea pay__topic-btn"),attrs:{id:"js_pay_topic_btn","data-url":e.topicLink,href:"javascript:;"},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")])]),t("ul",{staticClass:"pay__topic-list"},e._l(e.payTopicList,(function(i,n){return t("li",{key:i},[e._v(e._s(n+1)+". "+e._s(i))])})),0)])]),t("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.cgiData.isPayTopic,expression:"cgiData.isPayTopic !== 1"}],staticClass:"pay__main"},[e.cgiData.payDesc&&0===e.previewPercent?t("div",{staticClass:"pay__head-notice"},[e._v(" 正文需付费后才可阅读 ")]):e._e(),t("div",{staticClass:"pay__notice-btn-wrp",class:{"pay__notice-btn-lg":e.showBottomBar}},[t("mp-pay-btn",{ref:"payBtn",attrs:{"button-text":e.payBtnText}}),0!==e.cgiData.payGiftsCount?t("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_preview_tips"}},[e._v(" "+e._s(e.previewTipsText)+" ")]):t("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")]),e.tempkey?t("div",{staticClass:"pay__preview-tips js_pay_fee_display"},[e._v(" 预览状态下不会扣费 ")]):e._e(),t("mp-pay-read-qrcode")],1)]),t("mp-pay-wall")],1),t("transition",{attrs:{name:"fade"}},[t("mp-pay-read-bottom",{directives:[{name:"show",rawName:"v-show",value:e.payReadBottomVisible,expression:"payReadBottomVisible"}],ref:"payReadBottom",attrs:{visible:e.payReadBottomVisible,"pay-topic-notice-text":e.payTopicNoticeText}})],1),t("mp-pay-confirm",{ref:"payConfirm"})],t("mp-wecoin-tips",{ref:"wecoinTipsModal"})],2)}),[],!1,null,"f96c4240",null,null).exports,tn={itemClassName:"album_read_directory_item",albumId:window.appmsg_album_info.id,pageCount:10,isPC:oe.isWindows||oe.isMac&&!oe.isIOS,isInsertBlock:!1};let nn;const on="&cur_album_id=".concat(tn.albumId),an=document.createElement("div");function rn(){const e=document.createElement("div"),t=document.createElement("span");return t.setAttribute("role","option"),t.innerHTML='<span aria-label="合集：">#</span>'.concat(window.appmsg_album_info.title),e.appendChild(t),e.innerHTML}function cn(){const e=document.createElement("div");e.style.position="relative",e.style.cursor="pointer",e.setAttribute("role","listbox");let t,i,n,o,a,s=[],r=!0,c=!0,d=1;function l(e,s=!1,r=!0){const c=document.createDocumentFragment();if(i)if(s){d=1;for(let t=0;t<e.length;t++)if(e[t].msgid.toString()===window.appmsgid.toString()&&e[t].itemidx.toString()===window.idx.toString()){d=t;break}e.forEach(((e,i)=>{e.index=n?t-(i-d):t+(i-d)}))}else r?e.forEach(((e,t)=>{e.index=n?a.index-t-1:a.index+t+1})):e.forEach(((t,i)=>{t.index=n?o.index+(e.length-i):o.index-(e.length-i)}));return e.forEach((e=>{const t=document.createElement("div");if(ne.addClass(t,tn.itemClassName),e.msgid.toString()===window.mid.toString()&&e.itemidx.toString()===window.idx.toString()?ne.addClass(t,"album_read_directory_current"):1===e.user_read_status&&(ne.addClass(t,"album_read_directory_disabled"),ne.addClass(t,"js_wx_tap_highlight"),ne.addClass(t,"wx_tap_cell")),i){const i=document.createElement("span");i.className="album_read_directory_item_index",i.innerText="".concat(e.index,"."),t.appendChild(i)}const n=document.createElement("span");n.className="album_read_directory_title_wrp";const o=document.createElement("span");o.className="album_read_directory_title_wrp",o.innerText=e.title,n.appendChild(o),t.setAttribute("data-url",e.url),t.setAttribute("role","option");const a=document.createElement("span");if(e.is_paid){const e="已付费";ne.addClass(a,"wx_icon_pay_tag"),ne.addClass(a,"wx_icon_pay_tag_paid"),a.innerText=e,n.appendChild(a)}else if(e.is_pay_subscribe){const e="付费";ne.addClass(a,"wx_icon_pay_tag"),a.innerText=e,n.appendChild(a)}t.appendChild(n),c.appendChild(t)})),c}function p(e){1*e.reverse_continue_flag||(r=!1,nn.disablePullDownLoad()),1*e.continue_flag||(c=!1)}const m={extClass:"album_read_directory weui-half-screen-dialog_fold",hasBtn:!0,btnSlot:'<div id="js_topic_detail" class="weui-btn__word-wrp">\n                  <span class="weui-btn__word">详情</span>\n                  <i class="weui_right_arrow"></i>\n                </div>',title:rn(),btnClickCb(){Ne({ActionType:6}),Le(15),function(){const e=window.appmsg_album_info;if(e.link){const t=e.link.replace("#wechat_redirect","&subscene=159&subscene=".concat(window.source,"&scenenote=").concat(encodeURIComponent(window.location.href),"&nolastread=1#wechat_redirect"));ge.openUrlWithExtraWebview(t.htmlDecode())}}()},cb(){var s;s=s=>{nn.hideLoading(),n=s.base_info.is_reverse,t=s.base_info.cur_article_num,i=s.base_info.is_numbered,e.appendChild(l(s.article_list,!0)),o=s.article_list[0],a=s.article_list[s.article_list.length-1],p(s),c||nn.showEndLine(),r&&(e.firstChild.parentNode.insertBefore(an,e.firstChild),tn.isInsertBlock=!0,nn.scrollTo(0,e.firstChild.offsetTop+1));const m=e.childNodes[d];setTimeout((()=>{m.offsetTop+m.clientHeight>nn.contentAreaWrp.clientHeight&&nn.scrollTo(0,e.offsetHeight)}),200)},K({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(tn.albumId,"&cur_msgid=").concat(window.appmsgid,"&cur_itemidx=").concat(window.idx,"&count=").concat(tn.pageCount),timeout:5e3,dataType:"json",success:function(e){e.base_resp&&0===e.base_resp.ret&&s(e.getalbum_resp)},error(){console.log("[error]")}})},onShow(){Ne({ActionType:4}),Le(14)},onPullUpLoad(){c&&(nn.showPullUpLoading(),K({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(tn.albumId,"&begin_msgid=").concat(a.msgid,"&begin_itemidx=").concat(a.itemidx,"&count=").concat(tn.pageCount),timeout:5e3,dataType:"json",success:function(t){nn.hidePullUpLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const i=t.getalbum_resp.article_list;p(t.getalbum_resp),e.appendChild(l(i,!1,!0)),s=s.concat(i),nn.finishPullUpLoad(),a=s[s.length-1],1*t.getalbum_resp.continue_flag||nn.showEndLine()}},error:function(){}}))},onPullDownLoad(){r&&(tn.isInsertBlock&&(an.parentNode.removeChild(an),tn.isInsertBlock=!1),nn.showPullDownLoading(),K({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(tn.albumId,"&begin_msgid=").concat(o.msgid,"&begin_itemidx=").concat(o.itemidx,"&count=").concat(tn.pageCount,"&isbackward=1"),timeout:5e3,dataType:"json",success:function(t){nn.hidePullDownLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const i=t.getalbum_resp.article_list,n=t.getalbum_resp.continue_flag;t.getalbum_resp.continue_flag=t.getalbum_resp.reverse_continue_flag,t.getalbum_resp.reverse_continue_flag=n,p(t.getalbum_resp);const a=l(i,!1,!1),r=e.firstChild;e.insertBefore(a,r),s=i.concat(s),nn.scrollTo(0,r.offsetTop-62),setTimeout((()=>{nn.finishPullDownLoad()}),500),o=s[0]}},error:function(){}}))}};var _;window.appmsg_album_info.size<=4&&(m.top="".concat(screen.height/2-(screen.height-window.innerHeight),"px")),nn=new xt(e,m),nn.showLoading(),!tn.isPC&&nn.show(),(_=e)&&pe.on(_,"click",".".concat(tn.itemClassName),(e=>{const t=e.delegatedTarget;if(ne.hasClass(t,"album_read_directory_current"))return;let i;i=t.dataset.url.includes("#")?t.dataset.url.replace("#","".concat(on,"&scene=190#")):t.dataset.url+"".concat(on,"&scene=190"),Ne({ActionType:5,Url:i}),se.jumpUrl(i,!0,{useFastLoad:!0}),ne.addClass(t,"album_read_directory_disabled")}))}an.style.height="1px";const dn=Ee({name:"mp-keep-read",components:{[f.name]:f},data:()=>({isPC:oe.isWindows||oe.isMac&&!oe.isIOS}),computed:{...m({appmsgAlbumInfo:e=>e.cgiData.appmsg_album_info,appmsgAlbumExtInfo:e=>e.extRes.appmsg_album_extinfo}),showCard(){return this.appmsgAlbumExtInfo&&(this.appmsgAlbumExtInfo.pre_article_link||this.appmsgAlbumExtInfo.next_article_link)}},watch:{appmsgAlbumExtInfo:{handler(e){this.showCard&&this.$nextTick((()=>{this.initExposeReport()}))},immediate:!0}},methods:{onShow(){document.body.classList.add("page_no_scroll")},onHide(){document.body.classList.remove("page_no_scroll")},showBottomModal(e){nn?!this.isPC&&nn.show():cn(),this.isPC&&(this.$refs.albumKeepRead.style.overflow="visible",nn.contentAreaWrp.style.height="355px",nn.endLine.childNodes[3].style.background="var(--weui-BG-5)",this.$refs.pcPopoverContent.appendChild(nn.contentAreaWrp))},jumpPrev(){let e;Ne({ActionType:2,SubActionType:1}),Le(12),e=this.appmsgAlbumExtInfo.pre_article_link.includes("#")?this.appmsgAlbumExtInfo.pre_article_link.replace("#","".concat(on,"&scene=189#")):this.appmsgAlbumExtInfo.pre_article_link+"".concat(on,"&scene=189"),location.href=e.replace(/&amp;/g,"&")},jumpNext(){let e;Ne({ActionType:2,SubActionType:2}),Le(13),e=this.appmsgAlbumExtInfo.next_article_link.includes("#")?this.appmsgAlbumExtInfo.next_article_link.replace("#","".concat(on,"&scene=189#")):this.appmsgAlbumExtInfo.next_article_link+"".concat(on,"&scene=189"),location.href=e.replace(/&amp;/g,"&")},gotoAlbumInfo(){if(Ne({ActionType:6}),Le(15),this.appmsgAlbumInfo.link){const e=this.appmsgAlbumInfo.link.replace("#wechat_redirect","&subscene=159&subscene=".concat(window.source,"&scenenote=").concat(encodeURIComponent(window.location.href),"&nolastread=1#wechat_redirect"));ge.openUrlWithExtraWebview(e.htmlDecode())}},initExposeReport(){let e;const t=this.$refs.albumKeepRead,i=t&&t.offsetHeight/2||0;function n(){if(e)return;const n=r.getOffset(t).offsetTop||0,o=_e.getScrollTop();o+_e.getInnerHeight()>=n+i&&o<=n+i&&(Ne({ActionType:1}),Le(11),e=!0)}_e.bindDebounceScrollEvent(n),n()}}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showCard,expression:"showCard"}],ref:"albumKeepRead",staticClass:"appmsg_card_context album_read_card"},[e.showCard?[t("div",{staticClass:"album_read_hd weui-flex",attrs:{role:"button"},on:{click:function(t){return t.stopPropagation(),e.showBottomModal.apply(null,arguments)}}},[e.isPC?t("mp-popover",{attrs:{wrpClass:"popover-wrp-class",extClass:"popover-ext-class"},on:{show:e.onShow,hide:e.onHide}},[t("div",{staticClass:"album_read_source",attrs:{slot:"target"},slot:"target"},[t("span",{staticClass:"wx_tap_link js_album_directory__name"},[e._v(e._s(e.appmsgAlbumInfo.title)+" · 目录")]),t("i",{staticClass:"weui-icon-read"})]),t("div",{staticClass:"album_name_title",attrs:{slot:"title"},on:{click:function(t){return t.stopPropagation(),e.gotoAlbumInfo.apply(null,arguments)}},slot:"title"},[e._v("#"+e._s(e.appmsgAlbumInfo.title))]),t("div",{ref:"pcPopoverContent"})]):t("div",{staticClass:"album_read_source"},[t("span",{staticClass:"wx_tap_link js_album_directory__name"},[e._v(e._s(e.appmsgAlbumInfo.title)+" · 目录")]),t("i",{staticClass:"weui-icon-read"})])],1),t("div",{staticClass:"album_read_bd weui-flex"},[e.appmsgAlbumExtInfo.pre_article_link?t("span",{staticClass:"album_read_nav_item album_read_nav_prev weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpPrev}},[t("span",{staticClass:"album_read_nav_inner"},[t("span",{staticClass:"album_read_nav_btn"},[e._v("上一篇")]),t("span",{staticClass:"album_read_nav_title"},[t("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.pre_article_title.htmlDecode()||""))])])])]):e._e(),e.appmsgAlbumExtInfo.next_article_link?t("span",{staticClass:"album_read_nav_item album_read_nav_next weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpNext}},[t("span",{staticClass:"album_read_nav_inner"},[t("span",{staticClass:"album_read_nav_btn"},[e._v("下一篇")]),t("span",{staticClass:"album_read_nav_title"},[t("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.next_article_title.htmlDecode()||""))])])])]):e._e()])]:e._e()],2)}),[],!1,null,null,null,null).exports,ln=document.getElementById("js_tags_preview_toast");let pn=null;const mn={init(e){if(1===window.reprint_style||2===window.reprint_style||3===window.reprint_style||1*e.dataset.len==0)return;const t=e=>{if(window.is_temp_url)ln&&(ln.style.display="",pn&&clearTimeout(pn),pn=setTimeout((()=>{ln.style.display="none",pn=null}),3e3));else{const t={};let i=e.url;t.scene=window.source,t.subscene=window.subscene,t.sessionid=window.sessionid,t.enterid=window.enterid;let n=0;window.isPayTopic&&(n=0===window.isPaid?1:2),Pe({eventType:2,albumId:e.album_id,albumType:0,tagSrc:e.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:n}),se.goUrl(i,Object.assign({},t,{scene:173,from_msgid:window.mid,from_itemidx:window.idx,count:3,nolastread:1}))}};if(ne.hasClass(e,"js_single")){const i=e.querySelector(".js_tag").dataset;pe.on(e,"click",(()=>t(i)))}else pe.on(e,"click",(i=>{let n=i.target;n&&n!==e&&!ne.hasClass(n,"js_tag")&&(n=n.parentNode),n&&ne.hasClass(n,"js_tag")&&t(n.dataset)}));const i=t=>{const n=_e.getInnerHeight()+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);e.offsetTop<n?("function"!=typeof t&&pe.off(window,"scroll",i),Array.prototype.forEach.call(e.getElementsByClassName("js_tag"),(e=>{const t=e.dataset;let i=0;window.isPayTopic&&(i=0===window.isPaid?1:2),Pe({eventType:1,albumId:t.album_id,albumType:0,tagSrc:t.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:i})}))):"function"==typeof t&&t()};i((()=>{pe.on(window,"scroll",i)}))}};const _n=Ee({name:"mp-album",filters:{htmlDecode:e=>"".concat(e).html(!1)},props:{albumTags:{type:Array,default:()=>[]}},computed:{showAlbum(){return this.albumTags.length>0}},mounted(){mn.init(this.$refs.albumArea)}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showAlbum,expression:"showAlbum"}],ref:"albumArea",staticClass:"article-tag__list",attrs:{"data-len":e.albumTags.length}},[t("div",{staticClass:"article-tags"},e._l(e.albumTags,(function(i,n){return t("div",{key:n,staticClass:"article-tag__item-wrp js_tag weui-wa-hotarea js_wx_tap_highlight wx_tap_link",attrs:{"data-url":i.link.htmlDecode()||"/mp/publictag?action=get&tag_id=".concat(i.tagId,"&start=0"),"data-tag_id":i.tagId,"data-album_id":i.albumId,"data-tag_source":i.tagSource,role:"link",tabindex:"0"}},[t("span",{staticClass:"article-tag__item"},[t("i",{staticClass:"weui-icon-album"}),e._v(e._s(e._f("htmlDecode")(i.title)))]),i.size>0?t("span",{staticClass:"article-tag__item-num"},[t("span",{attrs:{id:""}},[e._v(e._s(i.size))])]):e._e()])})),0)])}),[],!1,null,null,null,null).exports,un=[2390745668,3099420829,3872121626,3203738065,3072206507,3566970574,3002803029,3099387730,3559965496,3525314097,2390323860,3084276724,3289028514,3003793452,3003972371,2398512110,3071748654,3233018348,3095049467,3076061592,3273032305,3264278949,3086344434,3014829842,3294546013,2058310401,2397841479,2397640820,3282179238,3072107639,3521076442,3554888231,2397274880,2394106525,3077726226,2103095721,3593723769,2395186785,2393698643,3944000110,2397445840,2394144447,3082139483,3070806332,3016714421,3006879186,3213574124,3221398587,3078448935,3591999034,3551390431];Oe(window.user_uin);const wn=["testrd","otherrd"];let hn=0;try{hn=1*window.atob(window.biz)}catch(ps){}let gn={report_action:2,share_type:5};function fn(e,t,i){let n="",o="";try{""!=tid&&(o="tid="+tid+"&aid=54");let a=e.split("?")[1]||"";if(a=a.split("#")[0],""==a);else{let s=[a,"mpshare=1","scene="+t,"srcid="+srcid,"sharer_shareinfo="+i],r=Y.getQuery("sharer_shareinfo_first")||Y.getQuery("sharer_shareinfo");if(r?s.push("sharer_shareinfo_first="+r):s.push("sharer_shareinfo_first="+i),""!=o&&s.push(o),a=s.join("&"),2===t&&un&&un.indexOf(hn)>-1){let t=Math.floor(Math.random()*wn.length),i=wn[t];n=e.split("?")[0]+"?"+a+"&testtype=".concat(i)+"#"+(e.split("#")[1]||"")}else n=e.split("?")[0]+"?"+a+"#"+(e.split("#")[1]||"")}}catch(ps){n=""}return n||(n=location.href+"#wechat_redirect",ee.setLogs({id:28307,key:47,value:1,lc:1,log0:"[share_link]["+encodeURIComponent(location.href)+"]["+encodeURIComponent(e)+"]["+encodeURIComponent(msg_link)+"]"})),n}ae.call("hideToolbar"),ae.call("showOptionMenu");let yn=msg_title.htmlDecode(),bn="",vn=cdn_url_1_1||msg_cdn_url||ori_head_img_url||round_head_img,xn=vn,kn=msg_link.htmlDecode(),An=msg_desc.htmlDecode();function Cn(e,t,i,n,o=0){re.shareReport({link:e,action_type:i,sharer_shareinfo:n,share_source:window.customShareSource||(0===o?1:2)})}function Tn(e,t){return e.isCDN()&&(e=Y.addParam(e,"wxfrom",t,!0)),e}An=An||" ",An=An.replace(/<br\/>/g,"\n"),idx>1&&document.getElementById("js_content")&&ct<1446652800&&(An=document.getElementById("js_content").innerHTML.replace(/<\/?[^>]*\/?>/g,"").htmlDecode().replace(/^(\s*)|(\s*)$/g,"").substr(0,54)),window.isPayTopic&&(An="收录于付费合集"+window.payTopicTitle||""),vn=vn.compressCDNImgSize(),xn=xn.compressCDNImgSize(),malicious_title_reason_id&&(yn=j.maliciousTitleMap[malicious_content_type][malicious_title_reason_id]||yn,An=j.maliciousDescMap[malicious_content_type][malicious_title_reason_id]||An,1!=malicious_content_type&&(vn="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png")),("1"==is_limit_user||window.cps_article_data)&&ae.call("hideOptionMenu"),window.is_temp_url&&ae.invoke("hideMenuItems",{menuList:["menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:qzone","menuitem:share:weibo","menuItem:share:WeiboApp","menuItem:share:QZone","menuitem:facebook","menuItem:copyUrl","menuItem:share:email","menuitem:copy_url","menuitem:share:haokan"]},(function(e){}));let In="https://res.wx.qq.com/op_res/Fwh9olR917lxUMxpJVM5sCCyrQOJSm68IEt-HfL7vpc5-_etzmyuLg1kPdU6RNRX";function Sn(){let e=Oe(window.user_uin+"_"+Date.now());if(window.is_wash)return{img_url:In,img_width:"640",img_height:"640",link:fn(kn,2,e),desc:"",title:"原文存在洗稿行为，你可以阅读以下原创作者的内容"};{let t=vn;oe.isIOS||(t=Tn(vn,"2"));let i={img_url:t,img_width:"640",img_height:"640",link:kn,desc:An,title:yn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(i,window.customShareInfo),"string"==typeof i.forbid_msg){let e=i.forbid_msg.replace("#op#","分享");return void(window.weui||window).alert(e)}return i.link=fn(i.link,2,e),i}}function jn(){const e=function(){let e=Oe(window.user_uin+"_"+Date.now());if(window.is_wash)return{img_url:In,img_width:"640",img_height:"640",link:fn(kn,type,e),desc:"你可以阅读以下原创作者的内容",title:"原文存在洗稿行为"};{let t=1,i=Tn(vn,"1");1==malicious_content_type&&(i="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png");let n={appid:bn,img_url:i,img_width:"640",img_height:"640",link:kn,desc:An,title:yn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(n,window.customShareInfo),"string"==typeof n.forbid_msg){let e=n.forbid_msg.replace("#op#","分享");return void(window.weui||window).alert(e)}return n.link=fn(n.link,t,e),n}}();e&&ae.invoke("shareCustomContent",{friend:e,timeline:Sn()},(t=>{console.info("shareCustomContent res",t);let i=Oe(window.user_uin+"_"+Date.now());Cn(kn,0,1,i,2),y.commit("mp-related-article/setSources","share"),e.vid&&(gn=Object.assign(gn,{vid:e.vid,share_type:2}),b.reportKanData(gn))}))}ae.on("menu:share:appmessage",(function(e){let t=Oe(window.user_uin+"_"+Date.now());if(window.is_wash)ae.invoke("sendAppMessage",{img_url:In,img_width:"640",img_height:"640",link:fn(kn,type,t),desc:"你可以阅读以下原创作者的内容",title:"原文存在洗稿行为"},(function(i){Cn(kn,fakeid,type,t,e.shareScene)}));else{let i=1,n=Tn(vn,"1");if(e&&"favorite"==e.scene&&(i=24,n=Tn(vn,"4"),y.commit("mp-related-article/setSources",["favorite"]),oe.isWindowsWechat&&"207"===Y.getQuery("subscene"))){const e=oe.getWindows();if(e&&parseInt(e,16)>=parseInt("0x63090500",16)&&parseInt(e,16)<=parseInt("0x630905FF",16))return void ae.invoke("handleMPPageAction",{action:"doFavorite"},(function(e){e.err_msg&&e.err_msg.indexOf("ok")>0?weui.toast("已收藏"):weui.toast("收藏失败")}))}1==malicious_content_type&&(n="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png");let o={appid:bn,img_url:n,img_width:"640",img_height:"640",link:kn,desc:An,title:yn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(o,window.customShareInfo),"string"==typeof o.forbid_msg){let t=o.forbid_msg.replace("#op#","favorite"===e.scene?"收藏":"分享");return void(window.weui||window).alert(t)}o.link=fn(o.link,i,t),ae.invoke("sendAppMessage",o,(function(e){Cn(kn,fakeid,i,t,0),y.commit("mp-related-article/setSources",[24===i?"favorite":"share"]),o.vid&&(gn=Object.assign(gn,{vid:o.vid,share_type:2}),b.reportKanData(gn))}))}})),ae.on("menu:share:timeline",(function(e){let t=Oe(window.user_uin+"_"+Date.now());if(window.is_wash)ae.invoke("shareTimeline",{img_url:In,img_width:"640",img_height:"640",link:fn(kn,2,t),desc:"",title:"原文存在洗稿行为，你可以阅读以下原创作者的内容"},(function(i){Cn(kn,fakeid,2,t,e.shareScene)}));else{let i=vn;oe.isIOS||(i=Tn(vn,"2"));let n={img_url:i,img_width:"640",img_height:"640",link:kn,desc:An,title:yn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(n,window.customShareInfo),"string"==typeof n.forbid_msg){let e=n.forbid_msg.replace("#op#","分享");return void(window.weui||window).alert(e)}n.link=fn(n.link,2,t),ae.invoke("shareTimeline",n,(function(i){Cn(kn,fakeid,2,t,e.shareScene),y.commit("mp-related-article/setSources",["share"]),n.vid&&(gn=Object.assign(gn,{vid:n.vid,share_type:1}),b.reportKanData(gn))}))}})),ae.on("menu:share:weiboApp",(function(e){let t=Oe(window.user_uin+"_"+Date.now());ae.invoke("shareWeiboApp",{img_url:vn,link:fn(kn,3,t),title:yn},(function(e){Cn(kn,fakeid,3,t)}))})),ae.on("menu:share:facebook",(function(e){let t=Oe(window.user_uin+"_"+Date.now());Cn(kn,fakeid,7,t),ae.invoke("shareFB",{img_url:xn,img_width:"640",img_height:"640",link:fn(kn,43,t),desc:An,title:yn},(function(e){}))})),ae.on("menu:share:QZone",(function(e){let t=Tn(vn,"6"),i=Oe(window.user_uin+"_"+Date.now());Cn(kn,fakeid,5,i),ae.invoke("shareQZone",{img_url:t,img_width:"640",img_height:"640",link:fn(kn,22,i),desc:An,title:yn},(function(e){}))})),ae.on("menu:share:qq",(function(e){let t=Tn(vn,"7"),i=Oe(window.user_uin+"_"+Date.now());Cn(kn,fakeid,5,i),ae.invoke("shareQQ",{img_url:t,img_width:"640",img_height:"640",link:fn(kn,23,i),desc:An,title:yn},(function(e){}))})),ae.on("menu:share:email",(function(e){let t=Oe(window.user_uin+"_"+Date.now());Cn(kn,fakeid,5,t),ae.invoke("sendEmail",{content:fn(kn,5,t),title:yn},(function(e){}))})),ae.on("sys:record",(function(e){ae.invoke("recordHistory",{link:kn,title:yn,source:nickname,img_url:vn},(function(e){}))}));const En=oe.isNewMpApp;const Rn=Ee({components:{[qi.name]:qi,[E.name]:E,[en.name]:en,[Re.name]:Re,[dn.name]:dn,[_n.name]:_n},data:()=>({isNewMpApp:En}),computed:{...m(["cgiData"]),...m({statStyle:e=>{var t;return 3===(null==(t=e.extRes.appmsgstat)?void 0:t.style)?1:0}}),reprintStyle(){return this.cgiData.reprint_style},showReward(){return 0===this.cgiData.is_pay_subscribe||1===this.cgiData.isPaid},isPaySubscribe(){return 1*this.cgiData.is_pay_subscribe==1},albumTags(){return this.cgiData.publicTagInfo},showBottomBar(){return 2===this.cgiData.show_version&&!Q.os.pc&&!oe.isNewMpApp}},methods:{onShare(){jn()}}},(function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"content_bottom_area"}},[e.reprintStyle?e._e():[t("mp-sponsor-ad"),e.showReward?t("mp-reward",{attrs:{"show-author":""}}):e._e(),e.isPaySubscribe?t("mp-pay-read"):e._e()],t("mp-album",{attrs:{albumTags:e.albumTags}}),t("mp-keep-read"),t("div",{staticClass:"rich_media_tool_area"},[t("mp-like-read-area",{attrs:{"stat-style":e.statStyle,"show-bottom-bar":e.showBottomBar},on:{share:e.onShare}})],1)],2)}),[],!1,null,null,null,null).exports;const Bn=_e.getInnerHeight(),Nn=100*Math.random()<1,Ln=Q.os.ipad||!oe.isIOS&&!oe.isAndroid;let Pn=0;oe.isIOS?Pn=1:oe.isAndroid&&(Pn=2);const Dn=[{name:"内容质量低",value:1},{name:"不看此公众号",value:2}],qn=(()=>{let e=!1;const t=[],i=n=>{e=!0,K({url:"/mp/relatedarticle?action=expose",type:"POST",dataType:"json",data:n,complete(){t.length?i(t.shift()):e=!1}})};return n=>{e?t.push(n):i(n)}})(),zn=window.matchMedia("(prefers-color-scheme: dark)"),On=(e="")=>{if(!e)return"";const t=parseInt("0x".concat(e.slice(1,3)),16),i=parseInt("0x".concat(e.slice(3,5)),16),n=parseInt("0x".concat(e.slice(5,7)),16),o=parseInt("0x".concat(e.slice(7,9)),16);return"rgba(".concat(i,", ").concat(n,", ").concat(o,", ").concat(t/255,")")};const Mn=Ee({name:"mp-related-article",data(){const e=this.$store.state.cgiData;return{list:[],reason:[],reportInfo:"",showRecReason:!1,showList:!oe.isMpapp&&1*e.item_show_type==0&&""!==e.item_show_type,unbindTransition:!1,listStyle:{overflow:"hidden",opacity:1,height:0,margin:0},feedbackIdx:-1,feedbackPos:"bottom",feedbackReasonTacitly:{},feedbackReasonKeyword:{},darkModeMatches:zn.matches}},computed:{...m(["extRes"]),...m("mp-related-article",["sources"]),...u("mp-like-and-share",["hasExtAppmsgStat"]),commonReportData(){const e=this.$store.state.cgiData;let t=parseInt(e.enterid,10)||0;return!oe.isWp&&-1==navigator.userAgent.indexOf("MicroMessenger")&&document.body.offsetWidth>=1024&&(t=1024,ee.setSum(223326,18,1)),{Bizuin_from:e.biz,Msgid_from:parseInt(e.mid,10)||0,Itemidx_from:parseInt(e.idx,10)||0,Scene:parseInt(e.source,10)||0,Subscene:e.related_article_scene||parseInt(e.source,10)||0,Sessionid:e.sessionid||"",Enterid:t,ItemShowType:parseInt(e.item_show_type,10)||0}},type(){return this.sources[0]},isPageInit(){return this.sources[1]},isFromPay(){return"pay"===this.type?1:0},loadType(){switch(this.type){case"default":default:return 0;case"favorite":return 1;case"share":return 2;case"praise":return 3;case"like":return 4;case"pay":return 5;case"reward":return 6;case"favorited":return 7;case"shared":return 8;case"praised":return 9;case"liked":return 10;case"paid":return 11;case"rewarded":return 12;case"recommend":return 13;case"force":return 14;case"subscribe":return 15}},hasFeedbackReason(){return!!(Object.keys(this.feedbackReasonTacitly).length+Object.keys(this.feedbackReasonKeyword).length)}},watch:{sources(){this.loadData()}},created(){this.hasReported29433=!1,this.exposeHeight=0,pe.on(window,"scroll",this.loadDataWhenScroll)},mounted(){if(this.itemHeight=parseFloat(window.getComputedStyle(this.$el).getPropertyValue("--RELATE-ITEM-HEIGHT")),this.itemHeightPx=0,Nn&&window.WX_BJ_REPORT){const e=this.$store.state.cgiData;window.WX_BJ_REPORT.BadJs.report("relatedArticleFlag","value:"+e.relatedArticleFlag,{mid:"mmbizwap:related_monitor",uin:e.user_uin})}zn.addListener((({matches:e})=>{this.darkModeMatches=!!e})),this.loadData()},beforeDestroy(){this.destroy()},methods:{loadDataWhenScroll(){this.__lock?pe.off(window,"scroll",this.loadDataWhenScroll):this.loadData()},loadData(){if(this.__lock||!this.showList||!this.type)return;const e=this.extRes.distance_to_get_related_article_data||-1;e>=0&&_e.getElementActualTop(this.$refs.jsRelatedArea)-_e.getScrollTop()-Bn>Bn*e||(this.__lock=!0,this.$nextTick((()=>{if(144===this.commonReportData.Scene)return;const e=this.$store.state.cgiData;this.isPageInit&&(this.listStyle.transition="none"),this.__placeholderTimer=setTimeout((()=>this.showCard(3)),500),pe.on(window,"scroll",this.exposeHandler),K({url:"/mp/relatedarticle?action=getlist&article_url=".concat(window.encodeURIComponent(location.href),"&__biz=").concat(e.biz,"&mid=").concat(e.mid,"&idx=").concat(e.idx,"&has_related_article_info=").concat(e.hasRelatedArticleInfo,"&is_pay=").concat(this.isFromPay,"&is_from_recommand=").concat(R?1:0,"&scene=").concat(this.commonReportData.Scene,"&subscene=").concat(parseInt(e.subscene,10)||0,"&is_open_comment=").concat(this.extRes.comment_enabled).concat("subscribe"===this.type?"&is_from_subscribe=1":""),type:"GET",dataType:"json",success:t=>{if(t&&t.base_resp&&1*t.base_resp.ret==0&&t.list&&t.list.length){const i=t.list.map((e=>(R&&(e.url=e.url.replace(/#wechat_redirect/,"&show_related_article=1&related_article_scene=".concat(this.commonReportData.Subscene,"$&"))),e.like_num_wording=e.old_like_num?se.formatReadNum(e.old_like_num):"",e.read_num_wording=e.read_num?se.formatReadNum(e.read_num):"",e.pay_cnt_wording=e.pay_cnt?se.formatReadNum(e.pay_cnt):"",e)));Nn&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs.report("list.length","list.length:"+i.length,{mid:"mmbizwap:related_monitor",_info:{relatedArticleFlag:e.relatedArticleFlag,isPc:Ln},uin:e.user_uin}),this.list=i,this.$emit("list-data-change",this.list),this.list.forEach((({url:e,ext_info:i})=>{ue.report(29139,Object.assign({Bizuin:Y.getQuery("__biz",e),Msgid:parseInt(Y.getQuery("mid",e),10)||0,Itemidx:parseInt(Y.getQuery("idx",e),10)||0,ExtInfo:i,RecInfo:t.report_info},this.commonReportData))})),this.reason=Dn,this.reportInfo=t.report_info||"",this.showRecReason=1===t.show_rec_reason,this.clearPlaceholderTimeout((e=>{e?this.showCard(t.list.length):this.setLines(t.list.length),this.listStyle.opacity=1,this.listStyle.overflow="visible",this.$nextTick((()=>{this.exposeHandler(),window.ipados13_font_scale&&v(this.$refs.jsRelatedArea,window.ipados13_font_scale/100),!this.isPageInit&&de.setCompRenderInfo({compEle:this.$refs.jsRelatedArea,compType:"mp-related-article",compIdx:1,wrapper:document.querySelector("#page_bottom_area")},this.$refs.jsRelatedArea.offsetHeight+parseInt(getComputedStyle(this.$refs.jsRelatedArea).marginTop,10))}))}))}else this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))},error:e=>{console.error(e),this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))}})})))},showCard(e){!this.isPageInit&&this.hasExtAppmsgStat?(parseFloat(window.getComputedStyle(this.$refs.jsRelatedMain).marginTop),this.$refs.jsRelatedArea.getBoundingClientRect().top,this.setLines(e)):this.setLines(e),delete this.__placeholderTimer},setLines(e){const t=this.$refs.jsRelatedTitle,i=t?t.getBoundingClientRect().height:34;let n=0;0===e?(this.listStyle.overflow="hidden",this.listStyle.margin="0",this.unbindTransition=!0):(window.is_like_profile_gray,this.listStyle.margin="8px 0 0",n="calc(".concat(e*this.itemHeight,"em + ").concat(i,"px)"));const o={compEle:this.$refs.jsRelatedArea,compType:"mp-related-article",compIdx:1,wrapper:document.querySelector("#page_bottom_area")};this.setLinesTimes=this.setLinesTimes?this.setLinesTimes+1:1,1!==this.setLinesTimes&&(o.subCompType="setLine-".concat(this.setLinesTimes)),this.isPageInit&&de.renderCompSilentlyPreHandler(o),this.listStyle.height=n,this.isPageInit&&this.$nextTick((()=>{de.renderCompSilently(o)})),this.isPageInit&&e&&this.transitionEndHandler({propertyName:"height"})},getHeight(e){return this.itemHeightPx||(this.$refs.relatedPlaceholder?this.itemHeightPx=this.$refs.relatedPlaceholder.getBoundingClientRect().height:this.itemHeightPx=se.qs(".js_related_item",this.$refs.jsRelatedList).getBoundingClientRect().height),e*this.itemHeightPx+se.qs(".js_related_title",this.$refs.jsRelatedMain).getBoundingClientRect().height},clearPlaceholderTimeout(e){this.__placeholderTimer?(clearTimeout(this.__placeholderTimer),delete this.__placeholderTimer,"function"==typeof e&&e(!0)):"function"==typeof e&&e(!1)},jumpArticle(e){const t=e.currentTarget.dataset,i=t.url;ee.setSum(110809,23,1),ue.report(18832,Object.assign({LoadType:this.loadType,Actiontype:2,Type:1,Bizuin:Y.getQuery("__biz",i),Msgid:parseInt(Y.getQuery("mid",i),10)||0,Itemidx:parseInt(Y.getQuery("idx",i),10)||0,Sendtimestamp:parseInt(t.time)||0,Pos:(1*t.index||0)+1,Recalltype:1*t.recalltype,Isreaded:1*t.isreaded,Mmversion:Pn,ExpType:t.exptype,ExtInfo:t.ext_info,RecInfo:t.report_info},this.commonReportData)),oe.isOnlyWechat&&!oe.isMpapp?ae.invoke("openWebViewUseFastLoad",{url:i,item_show_type:t.item_show_type,scene:132,subscene:this.commonReportData.Subscene,openType:0},(e=>{console.log("openWebViewUseFastLoad res: ",e),e&&e.err_msg&&-1===e.err_msg.indexOf("ok")&&fe(i)})):location.href=i},exposeHandler(){const e=this.$refs.jsRelatedArticleItem;if(!e)return;const{top:t,bottom:i}=this.$refs.jsRelatedArea.getBoundingClientRect();if(!(t>Bn||i<0)){let n=0;n=t<0?i:i>Bn?Bn-t:i-t,this.exposeHeight=Math.max(this.exposeHeight,n);const o=se.getScrollTop(),a=[];for(let t=0;t<e.length;t++){let i=e[t];1*i.dataset.hasreport!=1&&i.clientHeight+i.offsetTop>=o+i.clientHeight/2&&i.clientHeight+i.offsetTop<=o+i.clientHeight/2+Bn&&((e,t)=>{const i=e.dataset,n=i.url;i.hasreport=1,ee.setSum(110809,21,1),ue.report(18832,Object.assign({LoadType:this.loadType,Actiontype:1,Type:1,Bizuin:Y.getQuery("__biz",n),Msgid:parseInt(Y.getQuery("mid",n),10)||0,Itemidx:parseInt(Y.getQuery("idx",n),10)||0,Sendtimestamp:parseInt(i.time)||0,Pos:t+1,Recalltype:1*i.recalltype,Mmversion:Pn,Isreaded:1*i.isreaded,ExpType:i.exptype,ExtInfo:i.ext_info,RecInfo:i.report_info},this.commonReportData)),qn({bizuin:i.bizuin,mid:i.mid,idx:i.idx}),a.push({item_show_type:i.item_show_type,url:n})})(i,t)}a.length&&ae.invoke("downloadPageDataForFastLoad",{itemList:a},(e=>{console.log("downloadPageDataForFastLoad",e)})),this.report29433()}},transitionEndHandler(e){this.unbindTransition||"height"!==e.propertyName||(this.unbindTransition=!0)},destroy(){this.showList=!1,pe.off(window,"scroll",this.loadDataWhenScroll),pe.off(window,"scroll",this.exposeHandler)},showFeedback(e){const t=this.$refs.jsRelatedArticleItem[e];this.feedbackIdx=e,this.feedbackPos=Bn-t.getBoundingClientRect().bottom<268?"top":"bottom",this.$nextTick((()=>{this.$refs.feedbackBd[e].focus()})),i.show({alpha:.3,onClick:()=>{this.hideFeedback()}})},hideFeedback(){this.feedbackIdx=-1,this.feedbackPos="bottom",this.feedbackReasonTacitly={},this.feedbackReasonKeyword={},i.hide()},submitFeedback(e){if(this.hasFeedbackReason){const t={tacitly:Object.keys(this.feedbackReasonTacitly).map((e=>1*e)),keyword:Object.keys(this.feedbackReasonKeyword)},i=this.$store.state.cgiData,n={biz_from:i.biz,mid_from:i.mid,idx_from:i.idx,recommended_biz:Y.getQuery("__biz",e.url),mid:Y.getQuery("mid",e.url),idx:Y.getQuery("idx",e.url),reason:JSON.stringify(t)};K({type:"POST",url:"/mp/relatedarticle?action=dislike",dataType:"json",data:n,success:t=>{if(console.log(t),t&&t.base_resp&&0===t.base_resp.ret){this.hideFeedback();const t=this.list.indexOf(e);t>-1&&(this.list.splice(t,1),this.setLines(this.list.length))}else window.weui.alert("系统错误，请稍后再试")}})}},chooseFeedbackReason(e){const t=e.currentTarget,i=ne.hasClass(t,"js_reason")?this.feedbackReasonTacitly:this.feedbackReasonKeyword,n=t.dataset.value;i[n]?this.$delete(i,n):this.$set(i,n,1)},report29433(){if(this.hasReported29433)return;this.hasReported29433=!0;const e=this.$store.state.cgiData,t={bizuin_from1:e.biz,msgid_from1:parseInt(e.mid,10)||0,Itemidx_from:parseInt(e.idx,10)||0,ItemShowType:parseInt(e.item_show_type,10)||0};ue.report(29433,Object.assign({Type:0},t)),ue.leaveReport(29433,(()=>Object({Type:1,Pos_Height:Math.round(this.exposeHeight),Is_article_exposed:Array.prototype.some.call(this.$refs.jsRelatedArticleItem,(e=>1*e.dataset.hasreport==1))?1:0},t)))}},filters:{getRecTagStyle:(e,t)=>e?{color:On(t?e.dark_mode_text_color:e.text_color)}:{}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"related_container"},[e.showList&&e.type?t("div",{ref:"jsRelatedArea",staticClass:"relate_mod_transition function_mod js_related_area",style:e.listStyle,on:{transitionend:e.transitionEndHandler}},[t("div",{ref:"jsRelatedMain",staticClass:"function_mod_index js_related_main"},["share"===e.type||"shared"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v("分享此内容的人还喜欢")]):"favorite"===e.type||"favorited"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v("收藏此内容的人还喜欢")]):"subscribe"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v("关注此账号的人还喜欢")]):t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v("喜欢此内容的人还喜欢")]),t("div",{staticClass:"function_bd"},[e.list.length?t("div",{ref:"jsRelatedList",staticClass:"relate_article_index_list relate_article_list js_related_list",staticStyle:{height:"auto"}},e._l(e.list,(function(i,n){return t("div",{key:n,ref:"jsRelatedArticleItem",refInFor:!0,staticClass:"weui-media-box weui-media-box_appmsg js_related_item js_wx_tap_highlight wx_tap_cell",attrs:{"data-index":n,"data-url":i.url,"data-time":i.send_time,"data-recalltype":i.recall_type,"data-isreaded":i.is_readed,"data-bizuin":i.bizuin,"data-mid":i.mid,"data-idx":i.idx,"data-item_show_type":i.item_show_type,"data-exptype":i.exptype,"data-ext_info":i.ext_info,"data-report_info":e.reportInfo},on:{click:e.jumpArticle}},[t("div",{staticClass:"weui-media-box__bd"},[t("div",{class:["ellipsis_relate_title mask_ellipsis_wrp mask_ellipsis_auto_height",i.is_pay_subscribe?i.is_paid?"relate_article_paid":"relate_article_pay":"relate_article_default",e.showRecReason?"relate_article_tag_before":""],attrs:{role:"link",tabindex:"0","aria-labelledby":"relate_article_title_"+i.mid+"_"+i.idx+" js_a11y_comma relate_article_tag_"+i.mid+" js_a11y_comma relate_article_nickname_"+i.mid+"_"+i.idx+" js_a11y_comma relate_article_num_"+i.mid+"_"+i.idx}},[t("div",{staticClass:"mask_ellipsis_text",attrs:{"aria-hidden":"true"}},[e._v(" "+e._s(i.title)+" "),i.is_pay_subscribe&&i.is_paid?t("span",{staticClass:"pay__tag"},[e._v("已付费")]):i.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v("付费")]):e._e()]),t("div",{staticClass:"mask_ellipsis",attrs:{"aria-hidden":"true"}},[t("div",{staticClass:"mask_ellipsis_text",attrs:{id:"relate_article_title_"+i.mid+"_"+i.idx}},[e._v(" "+e._s(i.title)+" "),i.is_pay_subscribe&&i.is_paid?t("span",{staticClass:"pay__tag"},[e._v("已付费")]):i.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v("付费")]):e._e()]),t("div",{staticClass:"mask_ellipsis_placeholder"}),t("div",{staticClass:"mask_ellipsis_extra"},[e._v("   "),i.is_pay_subscribe&&i.is_paid?t("span",{staticClass:"pay__tag"},[e._v("已付费")]):i.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v("付费")]):e._e()])])]),t("div",{staticClass:"weui-media-box__info weui-flex"},[t("div",{staticClass:"weui-media-box__info__inner weui-flex weui-flex_align-center weui-flex__item"},[e.showRecReason&&i.rec_reason&&i.rec_reason.wording?t("div",{staticClass:"weui-media-box__info__meta relate_profile_tag",attrs:{"aria-hidden":"true",id:"relate_article_tag_"+i.mid+"_"+i.idx}},[t("span",{staticClass:"icon_appmsg_tag",style:e._f("getRecTagStyle")(i.rec_reason,e.darkModeMatches)},[e._v(e._s(i.rec_reason.wording))])]):e._e(),t("div",{staticClass:"js_profile relate_profile_nickname weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_nickname_"+i.mid+"_"+i.idx,"data-username":i.username}},[e._v(" "+e._s(i.nickname)+" ")]),e.showRecReason?e._e():t("div",{staticClass:"weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_num_"+i.mid+"_"+i.idx}},[i.old_like_num>=10?[e._v("赞 "+e._s(i.like_num_wording))]:i.is_pay_subscribe&&i.pay_cnt?[e._v("付费 "+e._s(i.pay_cnt_wording))]:i.read_num?[e._v("阅读 "+e._s(i.read_num_wording))]:e._e()],2)]),t("div",{staticClass:"relate_article_opr"},[t("button",{ref:"feedbackBtn",refInFor:!0,staticClass:"reset_btn dislike_btn js_feedback_btn weui-wa-hotarea",attrs:{type:"button"},on:{touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()},click:function(t){return t.stopPropagation(),e.showFeedback(n)}}},[e._v("不喜欢")])]),t("div",{ref:"feedbackBd",refInFor:!0,class:["feedback_dialog_wrp js_feedback_dialog",e.feedbackIdx===n?"feedback_dialog_show":""],attrs:{role:"dialog","aria-modal":"true",tabindex:"0","aria-hidden":e.feedbackIdx!==n?"true":"false"},on:{click:function(e){e.stopPropagation()},touchstart:function(e){e.stopPropagation()},touchmove:function(e){e.preventDefault()},touchend:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()}}},[t("div",{staticClass:"weui-mask js_mask",attrs:{role:"button","aria-label":"关闭"},on:{click:e.hideFeedback}}),t("div",{class:["feedback_dialog js_dialog_wrp","top"===e.feedbackPos?"feedback_dialog_pos_top":""]},[t("div",{staticClass:"feedback_dialog_hd weui-flex"},[t("div",{staticClass:"weui-flex__item feedback_dialog_title"},[e._v("不看的原因")]),t("button",{class:["weui-btn weui-btn_primary weui-btn_mini js_submit",e.hasFeedbackReason?"":"weui-btn_disabled"],attrs:{type:"button"},on:{click:function(t){return e.submitFeedback(i)}}},[e._v("确定")])]),t("div",{staticClass:"feedback_dialog_bd"},[t("ul",{staticClass:"feedback_tag_list"},[e._l(e.reason,(function(i){return t("li",{key:i.value,class:["feedback_tag_item js_reason js_tag_item",e.feedbackReasonTacitly[i.value]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.feedbackReasonTacitly[i.value],"data-value":i.value},on:{click:e.chooseFeedbackReason}},[e._v(e._s(i.name))])})),e._l(i.keyword,(function(i,n){return[n<2?t("li",{key:i,class:["feedback_tag_item js_keyword js_tag_item",e.feedbackReasonKeyword[i]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.feedbackReasonKeyword[i],"data-value":i},on:{click:e.chooseFeedbackReason}},[e._v("对"+e._s(i)+"不感兴趣")]):e._e()]}))],2)])])])])]),t("div",{staticClass:"weui-media-box__ft"},[t("img",{directives:[{name:"wxpic-src",rawName:"v-wxpic-src",value:i.cover,expression:"item.cover"}],staticClass:"relate_article_cover"})])])})),0):[e._m(0),t("div",{staticClass:"relate_article_list relate_article_placeholder"},[t("div",{ref:"relatedPlaceholder",staticClass:"weui-media-box weui-media-box_appmsg"},[t("div",{staticClass:"weui-media-box_placeholder"})])])]],2)])]):e._e()])}),[function(){var e=this._self._c;return e("div",{staticClass:"relate_list_loading"},[e("span",{staticClass:"weui-primary-loading",attrs:{role:"img","aria-label":"加载中"}},[e("span",{staticClass:"weui-primary-loading__dot"})])])}],!1,null,null,null,null).exports,Wn="&nbsp;&nbsp;";const Hn=Ee({name:"mp-profile-recommend",data(){return{profileRecList:[],profileRecommendLargeClass:this.computeProfileRecommendLargeClass(),loading:!1,showList:!1,modStyle:{},defaultHeadImgUrl:"http://mmbiz.qpic.cn/mmbiz/a5icZrUmbV8p5jb6RZ8aYfjfS2AVle8URwBt8QIu6XbGewB9wiaWYWkPwq4R7pfdsFibuLkic16UcxDSNYtB8HnC1Q/0"}},computed:{...m("mp-profile-recommend",["profileRecListTmp","moreRecProfilePageUrl","sessionId","bizUin","dataReady","loadData","isPageInit","subscribeStatus"])},watch:{loading(e){this.$emit("show-status-change",this.showList||e)},showList(e){this.$emit("show-status-change",e||this.loading)},profileRecListTmp(){this.$nextTick((()=>{this.profileRecList=this.profileRecListTmp,this.$nextTick((()=>{this.needLoading&&(this.modStyle={})}))}))},profileRecList(){if(this.profileRecList.length){if(1===this.profileRecList.length&&this.profileRecList[0].recommend_wording===Wn&&this.profileRecList[0].biz_info.headimgurl===Wn&&this.profileRecList[0].biz_info.nickname===Wn)return;const e={compEle:this.$refs.profileRecList,compType:"mp-profile-recommend",compIdx:1,wrapper:document.querySelector("#page_bottom_area")};this.isPageInit&&de.renderCompSilentlyPreHandler(e),this.$nextTick((()=>{this.isPageInit?de.renderCompSilently(e):de.setCompRenderInfo({compEle:this.$refs.profileRecList,compType:"mp-profile-recommend",compIdx:1,wrapper:document.querySelector("#page_bottom_area")},this.$refs.head.offsetHeight+this.$refs.bodyEle.offsetHeight+parseInt(getComputedStyle(this.$refs.profileRecList).marginTop,10)),this.handleExpose(),this.handleNicknameEllipsis()}))}},dataReady(){this.showList=this.profileRecListTmp&&this.profileRecListTmp.length,this.loading=!1},subscribeStatus(){let e;const t=!this.profileRecList.length;this.needLoading=t;const i=[{biz_info:{headimgurl:Wn,nickname:Wn},recommend_wording:Wn}];t&&(this.profileRecList=i,this.loading=!0),this.$nextTick((()=>{t&&this.profileRecList===i&&(this.profileRecList=[]),e=this.$refs.head.offsetHeight+this.$refs.bodyEle.offsetHeight,requestAnimationFrame((()=>{this.modStyle={height:"".concat(e,"px"),marginTop:"8px"},!t&&setTimeout((()=>{this.modStyle={}}),400)}))}))},loadData(){this.isPageInit?this.modStyle={transition:"none"}:this.modStyle={height:0,marginTop:0}}},mounted(){pe.on(window,"scroll","",se.throttle((e=>{this.handleExpose()}),50),!0),pe.on(window,"resize","",(()=>{setTimeout((()=>{this.profileRecommendLargeClass=this.computeProfileRecommendLargeClass()}),100)})),ae.on("menu:setfont",(()=>{this.handleNicknameEllipsis()}))},methods:{computeProfileRecommendLargeClass:()=>window.innerWidth>=704,goMoreProfileRecPage(){this.moreRecProfilePageUrl&&!this.loading&&fe(this.moreRecProfilePageUrl)},report25574(e,t){ue.report(25574,{BizUin:this.bizUin||0,EventType:t.eventType,Rec_BizUin:e.biz_info.bizuin||0,RecReason:e.recommend_wording||"",Pos:t.pos||0,RecInfo:e.rec_info||"",sessionid_:this.sessionId||"",style:2,subscene:3})},handleExpose(){if(this.$refs.profileRecList){const e=document.querySelectorAll(".js_profile_recommend_item");for(let t=0;t<e.length;t++){const i=e[t].getBoundingClientRect();if(!(i.top>-i.height&&i.top<window.innerHeight))break;i.left>=-i.width&&i.left<=window.innerWidth&&!this.profileRecList[t].exposed&&(this.report25574(this.profileRecList[t],{eventType:5,pos:t}),this.profileRecList[t].exposed=!0)}}},openProfile(e,t){se.goProfile({biz:e.biz_info.bizuin},{username:e.biz_info.username,scene:259}),this.report25574(e,{pos:t,eventType:2})},handleNicknameEllipsis(){this.$refs.bodyEle&&Array.from(this.$refs.bodyEle.querySelectorAll(".js_profile_recommend_nickname")).forEach((e=>{e.scrollWidth>e.offsetWidth?e.parentNode.classList.add("profile_recommend_nickname_wrap"):e.parentNode.classList.remove("profile_recommend_nickname_wrap")}))}}},(function(){var e=this,t=e._self._c;return e.showList||e.loading?t("div",{ref:"profileRecList",staticClass:"function_profile_recommend",class:{function_mod:e.profileRecList&&e.profileRecList.length||e.loading},style:e.modStyle},[e.profileRecList&&e.profileRecList.length||e.loading?t("div",{ref:"head",staticClass:"function_hd weui-flex"},[t("strong",{staticClass:"weui-flex__item function_title"},[e._v("其他关注的人还喜欢")]),t("span",{staticClass:"function_hd_extra"},[t("a",{staticClass:"js_wx_tap_highlight wx_tap_link profile_recommend_more",style:{visibility:e.loading?"hidden":"visible"},attrs:{href:"javascript:;"},on:{click:e.goMoreProfileRecPage}},[e._v("更多")])])]):e._e(),t("div",{staticClass:"function_bd"},[e.profileRecList&&e.profileRecList.length?t("div",{ref:"bodyEle",staticClass:"profile_recommend_list",class:{profile_recommend_large:e.profileRecommendLargeClass}},e._l(e.profileRecList,(function(i,n){return t("div",{key:i.biz_info.bizuin,staticClass:"profile_recommend_item js_wx_tap_highlight js_profile_recommend_item",attrs:{role:"link",tabindex:"0"},on:{click:function(t){return e.openProfile(i,n)}}},[t("div",{staticClass:"profile_recommend_inner",attrs:{role:"option"}},[t("div",{staticClass:"wx_border_avatar profile_recommend_avatar",style:{"background-image":"url(".concat(i.biz_info.headimgurl||e.defaultHeadImgUrl,")")}}),t("div",{staticClass:"profile_recommend_nickname_wrp"},[t("div",{staticClass:"profile_recommend_nickname js_profile_recommend_nickname"},[e._v(e._s(i.biz_info.nickname))]),t("span",{staticClass:"weui-hidden_abs"},[e._v(",")]),1===i.biz_info.verify_type?t("i",{staticClass:"weui-icon-certification",attrs:{role:"img","aria-label":"企业认证"}}):2===i.biz_info.verify_type?t("i",{staticClass:"weui-icon-certification personal",attrs:{role:"img","aria-label":"个人认证"}}):e._e(),t("span",{staticClass:"weui-hidden_abs"},[e._v(",")])]),t("div",{staticClass:"profile_recommend_tips"},[e._v(e._s(i.recommend_wording))])])])})),0):e.loading?t("div",{staticClass:"profile_recommend_loading_wrp"},[t("i",{staticClass:"weui-loading",attrs:{role:"alert","aria-label":"加载中"}})]):e._e()])]):e._e()}),[],!1,null,null,null,null).exports,Un="--appmsgExtra-BG",Fn=oe.isNewMpApp;const Jn=Ee({components:{[Hn.name]:Hn,[Mn.name]:Mn,[$e.name]:$e,[B.name]:B,[N.name]:N},data:()=>({onlyComment:"1"===Y.getQuery("only_comment"),isNewMpApp:Fn,relatedArticlePos:"",bottomBounceColor:Un,hasExtLoadDone:!1,hasProfileRecommend:!1,hasBottomAd:!1,hasRelatedArticle:!1,fetchBeforeExtResp:!window.__immersiveListMode,commentStatus:{isShowComment:!1,isLoading:!1,isInitial:!1,isEmpty:!0},adObserver:null}),computed:{...m(["extRes"]),...m("mp-related-article",["sources"])},watch:{sources(e){this.relatedArticlePos||(e[1]?this.relatedArticlePos=1===this.extRes.related_article_under_ad?"down":"up":e[0]&&(this.relatedArticlePos="up"))},bottomBounceColor(e){this.setBottomBounceColor(e)}},created(){this.setBottomBounceColor(this.bottomBounceColor),le.on("ext-complete-success",(()=>{this.hasExtLoadDone=!0,this.updateBgColor()}))},beforeDestroy(){this.adObserver&&this.adObserver.disconnect()},methods:{loadBottomAd(){const e=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const i=t.target;"js_bottom_opr_right"===i.id?(ee.setSum(364569,0,1),e.unobserve(i)):i.classList.contains("mpda_bottom_container")&&(ee.setSum(364569,1,1),e.unobserve(i))}}))}),{root:null,rootMargin:"0px",threshold:.05}),t=document.getElementById("js_bottom_opr_right"),i=document.querySelector(".mpda_bottom_container");t&&e.observe(t),i&&e.observe(i),this.adObserver=e},onProfileRecommendShowStatusChange(e){this.hasProfileRecommend=e,this.updateBgColor()},onAdDataChange(e){this.hasBottomAd=null!==e,this.updateBgColor()},onRelatedArticleListDataChange(e){this.hasRelatedArticle=e.length>0,this.updateBgColor()},commentStatusChange(e,t){this.commentStatus[e]=t,this.updateBgColor()},updateBgColor(){this.hasExtLoadDone?this.commentStatus.isShowComment&&!this.commentStatus.isEmpty?this.bottomBounceColor="":this.hasProfileRecommend||this.hasBottomAd||this.hasRelatedArticle||this.commentStatus.isShowComment&&(!this.commentStatus.isShowComment||!this.commentStatus.isEmpty||this.commentStatus.isLoading||this.commentStatus.isInitial)?this.bottomBounceColor=Un:this.bottomBounceColor="":this.bottomBounceColor=Un},setBottomBounceColor(e){Ge.set(e?{bottom:Ke.get(e)}:void 0),document.body.classList[e?"remove":"add"]("wx_wap_page_primary")},scrollToComment(){const e=this.$refs.comment.$el.getBoundingClientRect();x.start({y:e.y+window.scrollY})},submitComment(e){this.__submitingComment||(this.__submitingComment=!0,this.$refs.comment.sendComment({content:e,successEnd:this.scrollToComment,complete:()=>{this.__submitingComment=!1}}))},showAccessComment(e){this.$refs.comment.showCmtInput(e)}}},(function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"page_bottom_area"}},[t("div",{staticStyle:{"font-size":"0",height:"0"},attrs:{"aria-hidden":"true"}},[e._v("​")]),e.onlyComment?e._e():[t("mp-profile-recommend",{on:{"show-status-change":e.onProfileRecommendShowStatusChange}}),"up"===e.relatedArticlePos?t("mp-related-article",{on:{"list-data-change":e.onRelatedArticleListDataChange}}):e._e(),t("mp-bottom-ad",{on:{"ad-load":e.loadBottomAd,"ad-data-change":e.onAdDataChange}}),"down"===e.relatedArticlePos?t("mp-related-article",{on:{"list-data-change":e.onRelatedArticleListDataChange}}):e._e()],t("mp-comment",{ref:"comment",attrs:{"fetch-before-ext-resp":e.fetchBeforeExtResp},on:{"show-comment-change":t=>e.commentStatusChange("isShowComment",t),"loading-change":t=>e.commentStatusChange("isLoading",t),"initial-change":t=>e.commentStatusChange("isInitial",t),"empty-change":t=>e.commentStatusChange("isEmpty",t)}}),e.isNewMpApp?t("mp-interaction-bar",{on:{"submit-comment":e.submitComment,"scroll-to-comment":e.scrollToComment,"show-access-comment":e.showAccessComment}}):e._e()],2)}),[],!1,null,null,null,null).exports;const Vn=window.user_uin||0,Xn=Math.floor(Vn/100)%1e3,$n=0!==Vn&&Xn<1001;function Gn(e,t){window.logs.img={download:{},read:{},load:{}};const i=document.getElementById("js_cover");if(i){let e=i.getAttribute("data-src");e&&(e.isCDN()&&(e=e.imgChange640(),t&&(e=He(e)),e=te(e,"wxfrom","5",!0),is_https_res||$n?e=e.http2https():"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(e=e.https2http())),setTimeout((function(){i.onload=function(){Ye.setProperty(i,"height","auto","important"),Ye.setProperty(i,"visibility","visible","important")},i.setAttribute("src",e)}),0),window.logs.img.read[e]=!0,window.logs.img.load[e]=!0,i.removeAttribute("data-src"))}function n(e){return parseInt(e,10)||0}window.logs.outer_pic=0;const o=document.getElementsByTagName("img");for(let a=0,d=o.length;a<d;a++){const e=o[a].getAttribute("data-src");e&&e.isGif()&&o[a].classList.add("__bg_gif")}const s=document.getElementsByClassName("__bg_gif");for(let a=0,d=s.length;a<d;++a)s[a].setAttribute("data-order",a);const r=function(e){try{let t=e.childNodes,i=getComputedStyle(e);(i.backgroundImage.match(/https\:\/\/mmbiz\.qpic\.cn/)||i.backgroundImage.match(/http\:\/\/mmbiz\.qpic\.cn/))&&window.__addIdKeyReport("111535",2);for(let e=0;e<t.length;e++)"a"!=t[e].tagName.toLowerCase()&&r(t[e])}catch(ps){}};try{const e=document.getElementsByTagName("a");for(let t=0;t<e.length;t++){const i=e.item(t);null!=(i.getAttribute("href")||"").match(/^http/)&&r(i)}}catch(ps){}let c=!1;window.isCartoonCopyright||window.is_care_mode||new Be({attrKey:"data-src",imgOccupied:!0,crossOrigin:!0,inImgRead(e){e&&(window.logs.img.read[e]=!0)},changeSrc(i,n,o,a){if(!i)return"";if(window.__offlineCacheScheme)return i.offline();if("bg"===a)return i;let s=i;if(i.isCDN())s=s.imgChange640(),e&&s.canHevc()?(s=Ue(s,!1),window.__addIdKeyReport("28307",91)):t&&(s=He(s),window.__addIdKeyReport("28307",84)),s=te(s,"wxfrom","img"===a?"5":"15",!0),is_https_res||$n?(s=s.http2https(),window.__addIdKeyReport("28307",77)):"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(s=s.https2http(),window.__addIdKeyReport("28307",70));else try{new RegExp("^http(s)?://((mmbiz.qpic.cn/.*)|(m.qpic.cn/.*)|(mmsns.qpic.cn/.*)|(shp.qpic.cn/.*)|(puui.qpic.cn/.*)|(wx.qlogo.cn/.*)|(mmbiz.qlogo.cn/.*)|((a|b)[0-9]*.photo.store.qq.com/.*)|(mp.weixin.qq.com/.*)|(res.wx.qq.com/.*))").test(i)||(window.__addIdKeyReport("28307",9),window.logs.outer_pic++)}catch(ps){}return s=s.replace(/^http\:\/\/(a|b)(\d)+\.photo\.store\.qq\.com/g,"http://m.qpic.cn"),/^http(s)?:\/\/m\.qpic\.cn([\/?].*)*$/i.test(s)&&!t&&(s=te(s,"t","",!0)),s=te(s,"wx_lazy","1",!0),"anonymous"==n.crossOrigin&&(s=te(s,"wx_co","1",!0)),console.log(s,a,s.isJpg(),i),!Fe()||"img"!==a&&!s.isJpg()||s.isGif()||(s=Je(s)),Ve(s)&&window.__addIdKeyReport("28307",106),window.logs.img.load[s]=!0,Z.log("[Appmsg] image_load_event_change_src. originsrc:"+i+"  ^^^ newsrc : "+s),n.start_load_time=+new Date,s},onerror(e,t,i,o){let a,s=t&&t.__retryload||0;if("img"===o&&s>=2&&function(e,t,i){const o=i;!o||(o.width<40||o.height<40)&&(n(o.style.width)<40||n(o.style.height)<40)||o.classList.contains("wx_img_placeholder_err")||(o.classList.add("wx_img_placeholder_err"),o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==",window.__addIdKeyReport("28307",51),o.bindRetry||(o.bindRetry=!0,pe.on(o,"click",(()=>(window.__addIdKeyReport("28307",66),o.classList.remove("wx_img_placeholder_err"),e=e.https2http(),t.__retryload++,t.src=te(e,"retryload",t.__retryload,!0),!1)))))}(e,t,i),!e||s>2)return;if(!e.isCDN()){if(!Fe())return;if(!Ve(e))return}const r=0==e.indexOf("https://")?7:0;window.__addIdKeyReport("28307",72+r),s<=1&&window.__addIdKeyReport("28307",75+1*s+r),e.isWxpic()?(window.__addIdKeyReport("28307",93),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:hevc",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),s<=1&&window.__addIdKeyReport("28307",96+1*s)):e.isWebp()?(window.__addIdKeyReport("28307",86),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:webp",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),s<=1&&window.__addIdKeyReport("28307",89+1*s)):window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),Ve(e)&&window.__addIdKeyReport("28307",108),"img"===o&&s<2&&(s++,t.__retryload=s,1==s&&e.indexOf("http://")>-1?(e=e.http2https(),window.__addIdKeyReport("28307",60),window.__addIdKeyReport("28307",77)):1==s&&e.indexOf("https://")>-1?(window.__addIdKeyReport("28307",61),window.__addIdKeyReport("28307",77)):2==s&&e.indexOf("mmbiz.qpic.cn")>-1&&(e=e.replace("mmbiz.qpic.cn","mmbiz.qlogo.cn")).indexOf(!1)&&(e=e.http2https()),Ve(e)&&(e=Xe(e)),t.start_load_time=+new Date,a=e=te(e,"retryload",s,!0)),window.__has_imgfailed||(window.__has_imgfailed=!0,window.__addIdKeyReport("28307",65)),Z.log("[Appmsg] image_load_event_on_error. src:"+e),t.setAttribute("data-fail",1);try{if("[object Array]"==Object.prototype.toString.call(t.lazyLoadOnerror))for(let e=0,i=t.lazyLoadOnerror.length;e<i;e++)"function"==typeof t.lazyLoadOnerror[e]&&t.lazyLoadOnerror[e].call(t)}catch(ps){}let c=10;return/tp\=webp/.test(e)&&(c=11),(new Image).src="http://mp.weixin.qq.com/mp/jsreport?key="+c+"&content="+encodeURIComponent(e)+"["+uin+"]&r="+Math.random(),a},onload(e,t,i){var n;if(!window.__second_open__&&!c){const e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||!e.timing)return;const t=window.location.protocol;a.saveSpeeds({uin:uin,pid:"https:"==t?462:417,speeds:{sid:35,time:Date.now()-e.timing.navigationStart}}),a.send(),c=!0}"img"===i&&(null==(n=null==t?void 0:t.classList)||n.remove("wx_img_placeholder_err"),t.gray&&!t.loadGif&&((t.width||t.naturalWidth)<120||(t.height||t.naturalHeight)<120?t.autoTap&&t.autoTap():t.span&&t.span.children&&t.span.children.item(0)&&(t.span.children.item(0).style.display="")));let o=t&&t.__retryload||0;if(o>2)return;Z.log("[Appmsg] image_load_event_onload_image. src:"+e+"  ^^^  retryloadtimes: "+o),t.setAttribute("data-fail",0),"img"===i&&function(e){try{const t=e.getAttribute("data-src");if(!/^https?\:\/\/mmbiz\.qpic\.cn/.test(t))return;let i=e.parentNode,n=!1;ne.hasClass(i,"js_jump_icon")&&(n=!0);let o=!1;for(;i.tagName&&"body"!=i.tagName.toLowerCase();){if("a"==i.tagName.toLowerCase()){null!=(i.getAttribute("href")||"").match(/^http/)&&(o=!0);break}i=i.parentNode}if(n&&!o){let t=e.parentNode,i=t.parentNode;if(i){let e=document.createDocumentFragment();for(;t.firstChild;)e.appendChild(t.firstChild);i.insertBefore(e,t),i.removeChild(t)}}else if(!n&&o){let t=document.createElement("span"),i=getComputedStyle(e);"static"!=i.positon&&(t.style.position=i.positon),t.style.left=i.left,t.style.top=i.top,t.style.right=i.right,t.style.bottom=i.bottom,t.style.margin=i.margin,ne.addClass(t,"js_jump_icon"),ne.addClass(t,"h5_image_link"),e.style.position="static",e.style.margin="0px",e.parentNode.insertBefore(t,e),t.appendChild(e),window.__addIdKeyReport("111535",0)}}catch(ps){}}(t);try{if("[object Array]"==Object.prototype.toString.call(t.lazyLoadOnload))for(let e=0,i=t.lazyLoadOnload.length;e<i;e++)"function"==typeof t.lazyLoadOnload[e]&&t.lazyLoadOnload[e].call(t)}catch(ps){}const s=0==e.indexOf("https://")?7:0;window.__addIdKeyReport("28307",71+s),o<=1&&window.__addIdKeyReport("28307",73+1*o+s),e.isWxpic()?(window.__addIdKeyReport("28307",92),o<=1&&window.__addIdKeyReport("28307",94+1*o)):e.isWebp()&&(window.__addIdKeyReport("28307",85),o<=1&&window.__addIdKeyReport("28307",87+1*o)),Ve(e)&&window.__addIdKeyReport("28307",107),window.__has_imgsucceed||(window.__has_imgsucceed=!0,window.__addIdKeyReport("28307",64)),1==o&&e.indexOf("http://")>-1&&window.__addIdKeyReport("28307",50),1==o&&e.indexOf("https://")>-1&&window.__addIdKeyReport("28307",52);const r=Math.random(),d=+new Date-t.start_load_time;d&&0==e.indexOf("https://")&&r<.5?(window.__addIdKeyReport("27822",121,d),window.__addIdKeyReport("27822",122)):d&&r<5e-4&&(window.__addIdKeyReport("27822",124,d),window.__addIdKeyReport("27822",125)),"img"!==i||""===t.style.filter||"none"===t.style.filter||/translate(Z|3d)\(/.test(t.style.transform)||(t.style.transform+=" translateZ(0)",t.style.webkitTransform+=" translateZ(0)")},detect(e){if(!e||!e.time||!e.loadList)return;const t=e.time,i=e.loadList;window.logs&&window.logs.img&&window.logs.img.download&&(window.logs.img.download[t]=i)},container:document.getElementById("page-content")})}function Kn(){const e=document.getElementById("js_read_container"),t={player:null,srcId:"__wxtag__".concat(window.biz,"-").concat(window.mid,"-").concat(window.idx),mediaId:"",tag:"===mediaId-sep===",playDuration:0,playTime:0,maxNum:5,curNum:0,format:"",type:6,speed:100,voiceInfo:{title:"",nickname:"",appmsgUrl:"",duration:0},voiceOpt:null,lock:!1,status:"stop",currentTime:0,beginTime:0,leaveNeedReport:!1,pause2PlayNeedReport:!1,isSeek:!1,loadingTimer:null},i=e=>"".concat(e,"&uin=").concat(window.uin,"&key=").concat(window.key,"&pass_ticket=").concat(encodeURIComponent(window.pass_ticket)),n=()=>{if(t.curNum>10)return(e=>{if(!e&&null!==t.loadingTimer)return clearTimeout(t.loadingTimer),void(t.loadingTimer=null);ae.invoke("handleMPPageAction",{action:"showToast",status:e?"loading":"dismissloading"})})(!1),t.lock=!1,void weui.alert("系统繁忙，请稍后再试");t.curNum++;const e=t.curNum>t.maxNum?5e3:1e3;K({url:"/mp/msgvoice?action=getvoiceinfo&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"&speed=").concat(t.speed),type:"GET",dataType:"json",async:!0,success:a=>{if(a&&a.base_resp&&0===a.base_resp.ret)if(a.mediaid){t.mediaId=a.mediaid;const e=encodeURIComponent("__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx)),n=t.voiceInfo;t.voiceOpt={protocol:2===a.format?"hls":"",src:i("https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=".concat(a.mediaid,"&devicetype=").concat(window.devicetype,"&_type=").concat(t.type,"&speed=").concat(t.speed,"&encodeurl=").concat(e)),lowbandUrl:i("https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=".concat(a.mediaid,"&devicetype=").concat(window.devicetype,"&_type=").concat(t.type,"&speed=").concat(t.speed,"&encodeurl=").concat(e)),title:n.title,epname:"来自文章",singer:n.nickname?"".concat(n.nickname,"的语音"):"公众号语音",srcId:t.srcId+t.tag+t.mediaId,coverImgUrl:"",webUrl:n.appmsgUrl,musicbar_url:"https://mp.weixin.qq.com/mp/msgvoice?action=ttspage&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"#wechat_redirect"),needStartMusicUI:0},o()}else setTimeout(n,1e3);else console.log("getvoiceinfo err",a),setTimeout(n,e)},error:t=>{console.log("getvoiceinfo err",t),setTimeout(n,e)}})},o=()=>{t.player=De.init({protocal:"hls",wxIndex:t.voiceOpt.srcId,type:7,comment_id:"",src:t.voiceOpt.src,jsapi2Src:t.voiceOpt.src+"&voice_type=1",allowPause:!0,duration:t.voiceInfo.duration,title:t.voiceOpt.title,singer:t.voiceOpt.singer,epname:t.voiceOpt.epname,coverImgUrl:t.voiceOpt.coverImgUrl,playingCss:"share_audio_playing",playCssDom:e.getElementsByClassName("js_read_main")[0],playArea:e.getElementsByClassName("js_read_play")[0],progress:e.getElementsByClassName("js_read_progress")[0],fileSize:0,playtimeDom:e.getElementsByClassName("js_read_playtime")[0],bufferDom:e.getElementsByClassName("js_read_buffer")[0],playdotDom:e.getElementsByClassName("js_read_playdot")[0],seekRange:e.getElementsByClassName("js_read_seekRange")[0],seekContainer:e.getElementsByClassName("js_read_main")[0],loadingDom:e.getElementsByClassName("js_read_loading")[0],detailArea:"",detailUrl:t.voiceOpt.musicbar_url,webUrl:t.voiceOpt.musicbar_url})};K({url:"/mp/msgvoice?action=ttspage&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"&f=json"),type:"GET",dataType:"json",async:!0,success:i=>{i&&i.base_resp&&0===i.base_resp.ret?(t.voiceInfo={title:i.title,nickname:i.nickname,appmsgUrl:i.appmsg_url,duration:1*i.voice_info.duration},n(),e.getElementsByClassName("js_read_duration")[0].innerHTML=(e=>{const t=e=>e>=10?e:"0".concat(e);return"".concat(t(Math.floor(e/60)),":").concat(t(e%60))})(1*i.voice_info.duration)):weui.alert("系统繁忙，请稍后再试")},error:e=>{console.log("ttspage err: ",e),weui.alert("网络不可用，请检查网络设置")}})}const Qn=!oe.isWechat||oe.isWindowsWechat||oe.isMacWechat||oe.isNewMpApp,Yn=oe.isAndroid&&window.clientversion<"28002A00"||oe.isIOS&&window.clientversion<"18002824",Zn=oe.isAndroid&&window.clientversion<"28002800"||oe.isIOS&&window.clientversion<"18002831",eo=e=>e?De.encodeStr(e).replace(/^\s/,"").replace(/\s$/,""):"";class to{constructor(){this.validTagLen=0,this.adapter={1:qe,2:ze},this.tagMap={qqmusic:{eles:[],isClMusic:!1,watchAttrs:[],renderTag:"mp-common-qqmusic"},"mp-common-qqmusic":{eles:[],isClMusic:!1,watchAttrs:["musicid"],renderTag:"mp-common-qqmusic"},"mp-common-clmusic":{eles:[],isClMusic:!0,type2Wording:{1:"音乐",2:"专辑",3:"歌单"},renderTag:"mp-common-clmusic",watchAttrs:["listenid","categoryid"]}},this.tagNameList=Object.keys(this.tagMap),this.validateEnv()&&(this.renderTag(),console.log("➜ music tag",this.tagMap),this.renderCard())}validateEnv(){try{const e=document.querySelector("#js_content");return this.tagNameList.forEach((t=>{this.tagMap[t].eles=Array.from(e.querySelectorAll(t))})),this.validTagLen=this.tagNameList.reduce(((e,t)=>e+this.tagMap[t].eles.length),0),!!this.validTagLen}catch(e){return console.error("validateEnv err",e),!1}}renderTag(){this.tagNameList.forEach((e=>{const t=this.tagMap[e],{renderTag:i,eles:n}=t;n.forEach(((t,o)=>{if(i!==e){const e=((e,t)=>{const i=document.createElement(t);for(let n of e.attributes)i.setAttribute(n.name,n.value);return i.innerHTML=e.innerHTML,e.parentNode.replaceChild(i,e),i})(t,i);this.tagMap[i].eles.push(e),n.splice(o,1,null)}})),t.eles=n.filter((e=>e))}))}renderCard(){this.batchGetClMusicInfo().then((()=>{this.tagNameList.forEach((e=>{const t=this.tagMap[e],{eles:i,watchAttrs:n,isClMusic:o}=t;i.forEach(((e,t)=>{ne.addClass(e,"js_wx_tap_highlight");let i={isClMusic:o,posIndex:t,media_id:eo(e.getAttribute("mid"))||"",singer:eo(e.getAttribute("singer"))||"",albumid:eo(e.getAttribute("albumid"))||"",otherid:eo(e.getAttribute("otherid"))||"",musicid:eo(e.getAttribute("musicid"))||"",albumurl:eo(e.getAttribute("albumurl"))||"",audiourl:eo(e.getAttribute("audiourl"))||"",listenId:eo(e.getAttribute("listenid"))||"",clMusicType:parseInt(e.getAttribute("type"))||"",musictype:parseInt(e.getAttribute("musictype"))||1,music_name:eo(e.getAttribute("music_name"))||"",jumpurlkey:eo(e.getAttribute("jumpurlkey"))||"",categoryId:eo(e.getAttribute("categoryid"))||"",duration:parseInt(e.getAttribute(o?"duration":"play_length")||0,10)};if(i.musictype>2&&(i.musictype=2),!i.singer){const t=e.getAttribute("src")||"",n=decodeURIComponent(Y.getQuery("singer",t)||"");i.singer=eo(n)||""}o?(i.type=11,i.pauseCss="",i.allowPause=!1):this.adapter[i.musictype]&&"function"==typeof this.adapter[i.musictype].initData&&(i=this.adapter[i.musictype].initData(i,{scene:0}),e.setAttribute("albumurl",i.albumurl)),e.setAttribute("posindex",t),this.reRenderCard(e,n),o&&!e.isErrStatus?1!==i.clMusicType||Yn||Qn?this.bindEvent(e,i):this.renderPlayer(e,i):o||this.renderPlayer(e,i)}))}))}))}reRenderCard(e,t=[]){e&&t.forEach((t=>{const i=e.getAttribute(t);i&&(e.removeAttribute(t),e.setAttribute(t,i))}))}renderPlayer(e,t){setTimeout((()=>{Z.log("[Music] init "+t.detailUrl);const i="".concat(t.musicid||t.listenId,"_").concat(t.posIndex);var n;t.player=De.init({epname:"音乐",mid:t.media_id,singer:t.singer,songId:t.musicid,type:t.type||0,otherid:t.otherid,albumid:t.albumid,wxIndex:t.posIndex,duration:t.duration,listenId:t.listenId,webUrl:t.webUrl||"",isClMusic:t.isClMusic,coverImgUrl:t.albumurl,jumpurlkey:t.jumpurlkey,playingCss:"share_audio_playing",pauseCss:t.pauseCss||"",allowPause:!!t.allowPause,title:(n=t.music_name,n?De.decodeStr(n):""),detailUrl:t.detailUrl||"",playArea:e.shadowRoot.querySelector("#music_play_".concat(i)),playCssDom:e.shadowRoot.querySelector("#music_main_".concat(i)),detailArea:e.shadowRoot.querySelector("#music_home_".concat(i))})}),0)}bindEvent(e,t){setTimeout((()=>{const i=t.clMusicType,n="".concat(t.listenId||t.categoryId,"_").concat(t.posIndex),o=e.shadowRoot.querySelector("#music_main_".concat(n)),a=e.shadowRoot.querySelector("#music_play_".concat(n));o&&pe.on(o,"click",(()=>{if(Qn)(window.weui||window).alert("请在手机微信内操作");else if(1===i&&Yn||(2===i||3===i)&&Zn)ae.invoke("confirmDialog",{title:"当前版本暂不支持，请更新至微信最新版本",confirmText:"去更新",cancelText:"取消"},(e=>{-1!==e.err_msg.indexOf(":ok")?location.href=oe.isIOS?"https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1":"https://support.weixin.qq.com/update/":-1!==e.err_msg.indexOf("system:")&&(window.weui||window).alert("当前版本暂不支持，请更新至微信最新版本")}));else{const t=eo(e.getAttribute("categoryid"))||"";ae.invoke("openTingView",{action:"openCategory",category_id:t,sync_get:!0},(e=>{console.log("["+t+"], res: "+JSON.stringify(e))}))}})),a&&(pe.on(a,"mousedown",(e=>e.stopPropagation())),pe.on(a,"touchstart",(e=>e.stopPropagation())))}),0)}batchGetClMusicInfo(){return new Promise(((e,t)=>{const i=this.tagMap["mp-common-clmusic"],n=i.eles;if(!n.length)return void e();const o=this,a={count:n.length};n.forEach(((e,t)=>{const i=1*e.getAttribute("type");a["type".concat(t)]=i,a["source".concat(t)]=1*e.getAttribute("music_source"),a["username".concat(t)]=e.getAttribute("username")||"",a["id".concat(t)]=e.getAttribute(1===i?"listenid":"categoryid")||""})),K({url:"/mp/finder_music_appmsg?action=get",type:"POST",async:!0,dataType:"json",data:a,success(t){var a;if(0===(null==(a=null==t?void 0:t.base_resp)?void 0:a.ret)){const e=t.music_info_list||[];n.forEach((t=>{const n=1*t.getAttribute("type"),a=t.getAttribute(1===n?"listenid":"categoryid")||"",s=e.find((e=>e.id===a));if(s){const{flag:e}=s;switch(1*e!=0&&(t.isErrStatus=!0),1*e){case 0:o.updateClMusicCardInfo(t,s),t.setAttribute("verify_err","");break;case 1:t.setAttribute("verify_err","".concat(i.type2Wording[n],"暂时无法播放"));break;case 2:t.setAttribute("verify_err","".concat(i.type2Wording[n],"已被作者删除"));break;case 3:t.setAttribute("verify_err","".concat(i.type2Wording[n],"已被设置为私密"));break;case 4:t.setAttribute("verify_err","因作者隐私设置，暂时无法查看该内容")}}}))}e()},error:e})}))}updateClMusicCardInfo(e,t){const{type:i}=t,n=t.user_info||{};let o={};switch(1*i){case 1:o=t.music;break;case 2:o=t.album;break;case 3:o=t.playlist}e.setAttribute("count",o.item_num||0);try{const t=new URL(e.getAttribute("albumurl")||""),i=new URLSearchParams(t.search);i.delete("picformat");const n=new URL(o.cover||"");"".concat(t.origin).concat(t.pathname,"?").concat(i.toString())!=="".concat(n.origin).concat(n.pathname).concat(n.search)&&e.setAttribute("albumurl",o.cover||"")}catch(a){console.error(a)}e.setAttribute("singer",n.nickname||o.author||""),e.setAttribute("duration",o.duration||""),e.setAttribute("avatar",n.headimg_url||""),e.setAttribute("music_name",o.name||o.title||"")}}const io=oe.isWechat&&!oe.isWindowsWechat&&!oe.isMacWechat&&!oe.isNewMpApp,no={getTingIsOpenPromise:null,getListenLaterIsOpenPromise:null,musicLen:0,musicList:{},isTingOpen:-1,isSupportListenLater:io?1:0,srcRoot:"".concat(location.protocol,"//res.wx.qq.com/voice/getvoice?mediaid=#meidaid#"),inWechat:io,channelsInfo:[]};function oo(e){return document.getElementById(e)}function ao(e){for(var t=0,i=0;i<no.musicLen;i++){var n=no._oElements[i],o={},a=n.getAttribute("voice_encode_fileid")||"";try{a=decodeURIComponent(a)}catch(ps){}if(o.voiceid=De.encodeStr(a)||n.getAttribute("listen_id"),o.voiceid=o.voiceid.replace(/&#61;/g,"=").replace(/^\s/,"").replace(/\s$/,""),o.isaac=1*n.getAttribute("isaac2")||0,o.src=no.srcRoot.replace("#meidaid#",o.voiceid),1===o.isaac&&(o.jsapi2Src=o.src+"&voice_type=1"),o.voiceid&&"undefined"!=o.voiceid){if(o.albumLink="",e&&e.length>0&&e.forEach((e=>{if(e.voice_id===a)return e.appmsgalbuminfo&&(o.albumTitle=e.appmsgalbuminfo.title||"",o.albumLink=e.appmsgalbuminfo.link.html(!1).replace("#wechat_redirect","")+"#wechat_redirect",o.albumNum=e.appmsgalbuminfo.tag_content_num||0,o.albumid=e.appmsgalbuminfo.album_id||0),!1})),so(n,o,t),"undefined"!=typeof voiceid&&a&&voiceid&&a===voiceid){let e=n.offsetTop+122-40;setTimeout((()=>{window.scrollTo(0,e)}),0)}t++}}(function(){const e=[...oo("js_content").getElementsByTagName("mp-common-claudio")];return new Promise((t=>{if(!e.length)return void t(e);const i={video_snap_num:e.length};e.forEach(((e,t)=>{i["exportid_".concat(t)]=e.dataset.id,i["username_".concat(t)]=e.dataset.username})),K({url:"/mp/appmsg_video_snap?action=batch_get_video_snap",type:"POST",dataType:"json",async:!0,data:i,success:function(i){i&&i.base_resp&&0===i.base_resp.ret&&(no.channelsInfo=i.video_snap_info),t(e)},error:function(){t(e)}})}))})().then((e=>{no.channelsInfo.length&&e.forEach((e=>{const{flag:t}=no.channelsInfo.find((t=>t.export_id===e.dataset.id));switch(t){case 1:e.setAttribute("err_tips","当前音频已被作者删除");break;case 2:case 4:e.setAttribute("err_tips","当前音频暂时无法播放");break;case 3:e.setAttribute("err_tips","当前音频已被设置私密")}}))}))}function so(e,t,i){t.duration=parseInt((1*e.getAttribute("play_length")||0)/1e3,10),t.posIndex=i;var n,o=e.getAttribute("name")||"";try{o=decodeURIComponent(o)}catch(ps){}if(t.title=De.encodeStr(o).replace(/^\s/,"").replace(/\s$/,""),t.fileSize=1*e.getAttribute("high_size")||0,t.nickname=window.nickname,t.voiceTag="v",ne.addClass(e,"js_wx_tap_highlight"),no.getTingIsOpenPromise.then((()=>{!function(e,t){if(t.isShowListenLater=1===no.isSupportListenLater&&!window.is_pay_subscribe&&!window.tts_is_ban,e.setAttribute("show-listen-later",t.isShowListenLater?1:0),t.playArea=e.shadowRoot.querySelector(".js_voice_play"),t.progress=e.shadowRoot.querySelector(".js_audio_card_progress_inner"),t.bufferDom=e.shadowRoot.querySelector(".js_audio_card_progress_buffer"),t.loadingDom=e.shadowRoot.querySelector(".js_audio_card_progress_loading"),t.playdotDom=e.shadowRoot.querySelector(".js_audio_card_progress_handle"),t.seekRange=e.shadowRoot.querySelector(".js_audio_card_progress_wrp"),t.audioProgressBarDom=e.shadowRoot.querySelector(".js_audio_progress_bar"),t.playpercent=e.shadowRoot.querySelector(".js_voice_percent"),t.playpercentDesc=e.shadowRoot.querySelector(".js_voice_percent_desc"),t.listenLaterDom=e.shadowRoot.querySelector(".js_audio_listen_later"),t.albumDom=e.shadowRoot.querySelector(".js_voice_album"),t.playtimeDom=e.shadowRoot.querySelector(".js_duration"),"MP-COMMON-CLAUDIO"===e.tagName&&!function(e){const t=e=>e.stopPropagation();if(!oe.isWechat||oe.isWindowsWechat||oe.isMacWechat||oe.isNewMpApp)return pe.on(e.detailArea,"click",(()=>{(window.weui||window).alert("请在手机微信内操作")})),e.listenLaterDom&&pe.on(e.listenLaterDom,"touchstart",t),e.listenLaterDom&&pe.on(e.listenLaterDom,"mousedown",t),pe.on(e.playArea,"touchstart",t),pe.on(e.playArea,"mousedown",t),!1;if(oe.isAndroid&&window.clientversion<"28002655"||oe.isIOS&&window.clientversion<"18002725"){const i=()=>{ae.invoke("confirmDialog",{title:"当前版本暂不支持，请更新至微信最新版本",confirmText:"去更新",cancelText:"取消"},(e=>{-1!==e.err_msg.indexOf(":ok")?location.href=oe.isIOS?"https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1":"https://support.weixin.qq.com/update/":-1!==e.err_msg.indexOf("system:")&&(window.weui||window).alert("当前版本暂不支持，请更新至微信最新版本")}))};return pe.on(e.detailArea,"click",i),e.listenLaterDom&&pe.on(e.listenLaterDom,"touchstart",t),e.listenLaterDom&&pe.on(e.listenLaterDom,"mousedown",t),pe.on(e.playArea,"touchstart",t),pe.on(e.playArea,"mousedown",t),!1}return!0}(t))return void(e.style.opacity=1);(function(e){var t=e.voiceid+"_"+e.posIndex,i="";if(window.voice_in_appmsg&&window.voice_in_appmsg[e.voiceid]){var n=window.voice_in_appmsg[e.voiceid],o=window.biz||"",a=window.mid||"",s=window.idx||"";n.bizuin&&n.appmsgid&&n.idx&&(o=n.bizuin,a=n.appmsgid,s=n.idx),i=(window.location.protocol||"https:")+"//mp.weixin.qq.com/mp/audio?_wxindex_=#_wxindex_#&scene=104&__biz=#biz#&mid=#mid#&idx=#idx#&voice_id=#voice_id#&sn=#sn##wechat_redirect".replace("#_wxindex_#",e.posIndex).replace("#biz#",o).replace("#mid#",a).replace("#idx#",s).replace("#voice_id#",e.voiceid).replace("#sn#",n.sn||"")}Z.log("[Voice] init"+i);var r=De.decodeStr(e.title);e.player=De.init({wxIndex:e.posIndex,type:2,songId:e.voiceid,comment_id:"",src:e.src,jsapi2Src:e.jsapi2Src,allowPause:!0,duration:e.duration,title:r,singer:window.nickname?window.nickname+"的语音":"公众号语音",epname:"来自文章",coverImgUrl:window.__appmsgCgiData.hd_head_img,playingCss:"share_audio_playing",pauseCss:"share_audio_pause",playCssDom:e.detailArea||oo("voice_main_"+t),playArea:e.playArea||oo("voice_play_"+t),progress:e.progress||oo("voice_progress_"+t),fileSize:e.fileSize,playtimeDom:e.playtimeDom||oo("voice_playtime_"+t),bufferDom:e.bufferDom||oo("voice_buffer_"+t),playdotDom:e.playdotDom||oo("voice_playdot_"+t),playpercent:e.playpercent||oo("voice_percent_"+t),playpercentDesc:e.playpercentDesc||oo("voice_percent_desc_"+t),seekRange:e.seekRange||oo("voice_seekRange_"+t),seekContainer:e.detailArea||oo("voice_main_"+t),loadingDom:e.loadingDom||oo("voice_loading_"+t),detailArea:e.detailArea||oo("voice_main_"+t)||"",albumDom:e.albumDom||oo("voice_album_"+t),detailUrl:i,webUrl:window.msg_link,speedList:[.75,1,1.25,1.5,2],audioCardBody:oo("audio_card_bd_".concat(t)),ctrlArea:oo("audio_card_control_".concat(t)),fastBackBtn:oo("audio_fast_back_".concat(t)),fastForwardBtn:oo("audio_fast_forward_".concat(t)),doubleSpeedBtn:oo("audio_double_speed_".concat(t)),isAudio:!0,userName:window.user_name||"",articleCoverCdnUrl1_1:window.cdn_url_1_1,tingExtInfo:{bizuin:1*window.atob(window.biz)||0,appmsgid:1*window.mid||0,idx:1*window.idx||0,audio_id:e.voiceid||"",is_album_page:!1},albumInfo:{albumId:e.albumid||"",albumName:e.albumTitle||"",albumUrl:e.albumLink||""},finderInfo:e.finderInfo||{},cover:e.cover||"",author:e.author||"",listenId:e.listenId||"",isTingOpen:no.isTingOpen,isSupportListenLater:no.isSupportListenLater,audioDurationDom:oo("audio_duration_".concat(t)),listenLaterDom:e.listenLaterDom||oo("audio_listen_later_".concat(t)),audioRealTimeDom:oo("audio_real_playtime_".concat(t)),audioProgressBarDom:e.audioProgressBarDom||oo("audio_progress_bar_".concat(t))})})(t),e.style.opacity=1}(e,t)})),no.getListenLaterIsOpenPromise.then((()=>{const t=1===no.isSupportListenLater&&!window.is_pay_subscribe&&!window.tts_is_ban;e.setAttribute("show-listen-later",t?1:0)})),"MP-COMMON-CLAUDIO"===e.tagName)return(t={posIndex:i,voiceTag:"v"}).type=4,t.listenId=e.getAttribute("listen_id"),t.duration=1*e.getAttribute("duration"),t.cover=e.getAttribute("cover").html(!1),t.title=e.getAttribute("name"),t.author=e.getAttribute("author"),t.finderInfo={nonceId:e.getAttribute("data-nonceid"),tid:e.getAttribute("data-tid")},e.setAttribute("cover",t.cover),t.detailArea=e.shadowRoot.querySelector(".js_wx_claudio_card"),no.musicList[t.listenId+"_"+t.posIndex]=t,void ne.addClass(e,"mp_common_channel");if(1===window.is_temp_url&&window.voice_in_appmsg[t.voiceid]){const{transState:i,voiceVerifyState:n}=window.voice_in_appmsg[t.voiceid];e.setAttribute("data-verify_state",n||3),e.setAttribute("data-trans_state",i||1)}else(n=t.voiceid,new Promise((e=>{K({url:"/voice/getvoicestatus?mediaid=".concat(n),dataType:"json",timeout:3e3,success(t){t&&t.base_resp&&0===t.base_resp.ret?e(t):e()},error(){e()}})}))).then((t=>{t&&(e.setAttribute("data-verify_state",t.voice_verify_state||3),e.setAttribute("data-trans_state",t.voice_trans_state||1))}));t.detailArea=e.shadowRoot.querySelector(".js_wx_mpaudio_card"),no.musicList[t.voiceid+"_"+t.posIndex]=t,ne.addClass(e,"mp_common_audio")}function ro(e){var t;if((t=oo("js_content"))&&(no._oElements=[...t.getElementsByTagName("mp-common-mpaudio"),...t.getElementsByTagName("mp-common-claudio")],!(no._oElements.length<=0)))try{no.getTingIsOpenPromise=new Promise((e=>{no.inWechat?ae.invoke("getTingAudioState",{},(t=>{/:ok$/.test(t.err_msg)?no.isTingOpen=1:-9999!==t.err_code&&-1===t.err_msg.indexOf("function_not_exist")||(no.isTingOpen=0),e()})):e()})),no.getListenLaterIsOpenPromise=new Promise((e=>{let t=null;t=setTimeout((()=>{no.isSupportListenLater=0,e()}),3e3),no.inWechat?ae.invoke("handleMPPageAction",{action:"isSupportAddToTingPlayList"},(i=>{t&&clearTimeout(t),/:ok$/.test(i.err_msg)?no.isSupportListenLater=1:no.isSupportListenLater=0,e()})):e()})),no.musicLen=no._oElements.length,ao(e)}catch(i){console.error(i)}}const co='\x3c!-- 发表留言 --\x3e\n<#if(window.new_appmsg){#>\n  <div id="js_cmt_mine" class="discuss_container_wrp" style="display:none;">\n    <div class="discuss_container editing access">\n        <div class="discuss_container_inner">\n          <div class="discuss_container_hd">\n            <h2 class="rich_media_title">\n                <#if(window.item_show_type == 10){#>\n                    <#=textPageTitle#>\n                <#}else{#>\n                    <#=window.msg_title.html(1)#>\n                <#}#>\n            </h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言对朋友可见，被公众号筛选后，将对所有人可见。"></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                            <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n                            <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n                        </span>\n                    </div>\n                </span>\n            </div>\n            <div class="emotion_panel" id="js_emotion_panel">\n                <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                    <i class="emotion_panel_arrow arrow_out"></i>\n                    <i class="emotion_panel_arrow arrow_in"></i>\n                </span>\n                <div class="emotion_list_wrp" id="js_slide_wrapper">\n                    \x3c!--<ul class="emotion_list"></ul>--\x3e\n                    \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                </div>\n                <ul class="emotion_navs" id="js_navbar">\n                    \x3c!--<li class="emotion_nav"></li>--\x3e\n                </ul>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">留言</a></div>\n          </div>\n          <div class="discuss_container_bd">\n            <div class="" style="display:none">\n                <div class="mod_title_context">\n                    <strong class="mod_title">我的留言</strong>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="weui-loadmore" id="js_mycmt_loading">\n                <i class="weui-loading"></i>\n                <span class="weui-loadmore__tips">正在加载</span>\n            </div>\n            <div id="js_cmt_toast" style="display: none;">\n                <div class="weui-mask_transparent"></div>\n                <div class="weui-toast">\n                    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n                    <p class="weui-toast__content">已留言</p>\n                </div>\n            </div>\n            <div class="weui-dialog__wrp weui-transition_opacity-hide" id="js_delete_panel_mobile">\n                <div class="weui-mask"></div>\n                <div class="weui-dialog">\n                    <div class="weui-dialog__bd">确定删除留言吗？</div>\n                    <div class="weui-dialog__ft">\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_delete_cancel_mobile">取消</a>\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_delete_confirm_mobile">删除</a>\n                    </div>\n                </div>\n            </div>\n          </div>\n        </div>\n    </div>\n  </div>\n<#}else{#>\n    <div id="js_cmt_mine" class="discuss_container editing access" style="display:none;">\n        <div class="discuss_container_inner">\n            <h2 class="rich_media_title"><#=window.msg_title.html(1)#></h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言对朋友可见，被公众号筛选后，将对所有人可见。"></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                        </span>\n                        <div class="emotion_panel" id="js_emotion_panel">\n                            <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                                <i class="emotion_panel_arrow arrow_out"></i>\n                                <i class="emotion_panel_arrow arrow_in"></i>\n                            </span>\n                            <div class="emotion_list_wrp" id="js_slide_wrapper">\n                                \x3c!--<ul class="emotion_list"></ul>--\x3e\n                                \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                            </div>\n                            <ul class="emotion_navs" id="js_navbar">\n                                \x3c!--<li class="emotion_nav"></li>--\x3e\n                            </ul>\n                        </div>\n                    </div>\n                </span>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">留言</a></div>\n            <div class="discuss_list_wrp" style="display:none">\n                <div class="rich_tips with_line title_tips discuss_title_line">\n                    <span class="tips">我的留言</span>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="rich_tips tips_global loading_tips" id="js_mycmt_loading">\n                <img src="<#=window.icon_loading_white#>" class="rich_icon icon_loading_white" alt="">\n                <span class="tips">加载中</span>\n            </div>\n            <div class="wx_poptips" id="js_cmt_toast" style="display:none;">\n                <img alt="" class="icon_toast" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABqCAYAAABUIcSXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyMTUxMzkxZS1jYWVhLTRmZTMtYTY2NS0xNTRkNDJiOGQyMWIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTA3QzM2RTg3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTA3QzM2RTc3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NWMyOGVjZTMtNzllZS00ODlhLWIxZTYtYzNmM2RjNzg2YjI2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjIxNTEzOTFlLWNhZWEtNGZlMy1hNjY1LTE1NGQ0MmI4ZDIxYiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pmvxj1gAAAVrSURBVHja7J15rF1TFMbXk74q1ZKHGlMkJVIhIgg1FH+YEpEQJCKmGBpThRoSs5jVVNrSQUvEEENIhGiiNf9BiERICCFIRbUiDa2qvudbOetF3Tzv7XWGffa55/uS7593977n3vO7e5+199p7v56BgQGh0tcmvAUERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERVAUQVEERVAUQbVYk+HdvZVG8b5F0xj4RvhouB+eCy8KrdzDJc1RtAX8ILxvx98V1GyCSkN98Cx4z/95/Wn4fj6j6tUEeN4wkFSnw1MJqj5NhBfAuwaUHREUg4lqNMmePVsHll/HFhVfe1t3FwpJI8DXCCquDrCWNN4B6Tb4M3Z98aTPmTvh0YHl18PXw29yZiKejoPvcUD6E74yFBJbVDk6Bb7K8aP/Hb4c/tRzEYIqprPhSxzlf4Uvhb/0Xoig8qnHAJ3lqPMzfDH8XZ4LEpRf2sVdA5/sqPO9Qfop70UJyn+/boaPddT5yrq7VUUvTIVJI7q74MMddXR8NB1eXcYvhBpZm0s2w72/o86HFoKvLau/pYaXzjLMdUJ6y0LwtWV9CIIaXtvA8+G9HHV03u5q+K+yH47U0NoRngPv7KjzHDwTLj0bS1BDazfJJlcnOOostC6ysnCT+q80G/sIvFVgeW09D8FPVT0uoP7VfvAD8NjA8pqmuAN+OcYAjso0RbIZ8DGB5TVNcRO8JMaHY9SXSdfa3eeANJimWBLrA7JFiZwIXye+NMUV8CcxP2SRFjXefok7NRjSGZJlWUPvw2/wtNiQirSoXWyMsR28wR7AzzYM0oXw+Y7yK+CLJGeaoqjyrJSdZJD6Ov4+z5y6NJc0Az7NUecHydIUy+v60KNyQHoM3nKI1y7YCFiq0i7uBvgER52vDdKqWn9djhY1Dn4G3n6Ecqm2rF74dvgoR53S0hQxW9RJAZAGW5bSn58QJA27dQ7uIEedjywEX5NKVxCqsY6y+qA+LxFI4+yZ6oH0trWkNan80jygtIUsc5SflgAsDXgehfdx1KkkTRE76tN+Xue2jnTU0Ru1oIbvpt30bBtKhOp5yaaRkts0lic8V1i6dPcIRx2d/l8Y8XtNNEg7OOo8bl1kmmOKnDsO88CaYzejau0hWZqiL7C83oCH4SeTHvwV2BqqsHRVztSEYOmWF80NeXZT6Hd4KflResE9vCnBOlCyGfDNAstHTVPUDWoQ1t3iW+9WNizvlhfd4aerXd+ThqiMfNR6+9LvOOro5OY5JX2H4+F7HZD+kGzlamMgldWiirQsjcwWFbjmqZJteekJLK9pisvgL6RhKvuciZiwzrWWGapfrPy30kBVcSBIrw0aD3PU0XB6cehntq7rTMf7/2iQlktDVdXJLXlg6VjmiYBn6rWSTRCH6hvJ0hQrpcGq8oidsmHpTP8t8DGO9/vcWt9qabiqPgup1yKyQwvC2tSefZ73SSpNkUJ4PlLorlHZ+446nc8f3fIyywlJhwrTuwVSjBa1ccvSxN0hjjoK5xVrYZMd9V6XbFfgBukixTwGLg8sDam3dZR/wZ6L/dJlin1en8LS+bgpFbz3Ygvzu1J1HKxYNqxGpCmaCEo12rrBorD6LRp8UbpcdR5VWhTW35KlKd6QFqjuM2XzwlpnMxTvSkuUwuG/Xlg6NtPjbT6WFimF/VG6LEvXgn8QGDjMbBukVECFwhpoS+CQatfX2Q1q6H7wENHdrfCr0lKleEB9JyxNneus+VJpsVL9TwI6W65LovWIGl3KtVJaLv7LBwYTFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFFWq/hFgADUMN4RzT6/OAAAAAElFTkSuQmCC">\n                <p class="toast_content">已留言</p>\n            </div>\n        </div>\n    </div>\n<#}#>\n<div class="weui-webview-nav" style="display:none;" id="js_fake_bar">\n    <button class="weui-webview-nav__btn_goback" id="js_cmt_goback">goback</button>\n    <button class="weui-webview-nav__btn_forward weui-webview-nav__btn_disabled" disabled="disabled">forward</button>\n</div>';const lo={tagName:"mp-common-poi",oldTagName:"mppoi",isWechat:(oe.isAndroid||oe.isIOS)&&(oe.isWechat||oe.isWxWork)&&!oe.isNewMpApp,screen_height:_e.getInnerHeight(),commonReportData:{bizuin:1*we(window.biz),msgid:1*window.mid,itemidx:1*window.idx,sessionidnew:window.sessionid,enterid:1*window.enterid},poiDom:[]},po=e=>{lo.isWechat?oe.isWxWork?ce():ae.invoke("openLocation",{latitude:1*e.latitude,longitude:1*e.longitude,name:e.name,address:e.address,poiCardExpand:!0,infoUrl:""},(function(e){-1!==e.err_msg.indexOf("ok")?ee.setSum(110809,53,1):ee.setSum(110809,54,1)})):oe.isNewMpApp?window.open("https://apis.map.qq.com/uri/v1/marker?marker=coord:".concat(e.latitude,",").concat(e.longitude,";title:").concat(encodeURIComponent(e.name),";addr:").concat(encodeURIComponent(e.address))):new I({msg:"请使用移动端微信打开。"})},mo=(e={})=>{const t=e.dom,i=e.poiInfo;pe.on(t,"click",(function(e){e.stopPropagation(),e.preventDefault(),ue.report(19937,Object.assign({},lo.commonReportData,{type:2,actiontype:2})),ee.setSum(110809,55,1),po(i)}),!0)},_o=()=>{for(let e=0;e<lo.poiDom.length;e++){const t=lo.poiDom[e];if(1*t.getAttribute("data-hasreport")!=1){t.setAttribute("data-hasreport",1);const e=document.documentElement.scrollTop||document.body.scrollTop;t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+lo.screen_height&&("A"===t.tagName?(ue.report(19937,Object.assign({},lo.commonReportData,{type:1,actiontype:1})),ee.setSum(110809,58,1)):(ue.report(19937,Object.assign({},lo.commonReportData,{type:2,actiontype:1})),ee.setSum(110809,56,1)))}}},uo={oldTagName:"mpsearch",tagName:"mp-common-search",isWechat:(oe.isAndroid||oe.isIOS)&&(oe.isWechat||oe.isWxWork)&&!oe.isNewMpApp,keywords:[],screen_height:_e.getInnerHeight(),exposeHasReport:0,commonReportData:{BizUin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,SearchKeyWord:"",SessionId:window.sessionid,EnterId:1*window.enterid,Scene:1*window.source,SubScene:1*window.subscene}},wo=(e={})=>{pe.on(e.dom,"click",(function(){let e=uo.keywords.map((e=>e.label)).join(";");if(ue.report(19453,Object.assign({},uo.commonReportData,{SearchKeyWord:e,EventType:2})),ee.setSum(110809,47,1),uo.isWechat){if(oe.isWxWork)ce();else if((oe.isIOS&&oe.ltVersion("7.0.12")||oe.isAndroid&&oe.ltVersion("7.0.12"))&&!oe.isWxWork)return void new I({msg:"当前微信版本不支持展示该内容，请升级至最新版本。"});const e=[];for(let t=0;t<uo.keywords.length;t++)e.push({hotword:uo.keywords[t].label,id:t,optype:1});ae.invoke("openWXSearchPage",{query:"",thirdExtParam:JSON.stringify({data:[{items:e,title:window.nickname+"推荐搜索",type:4}],from:"mpWidget",bizUserName:window.user_name,bizNickName:window.nickname,id:"mpWidget_".concat(uo.commonReportData.BizUin,":").concat(uo.commonReportData.MsgId,":").concat(uo.commonReportData.ItemIdx)})},(function(e){-1!==e.err_msg.indexOf("ok")?ee.setSum(110809,48,1):ee.setSum(110809,49,1)}))}else new I({msg:"请使用移动端微信打开。"})}));const t=()=>{if(!uo.exposeHasReport){uo.exposeHasReport=1;const t=document.documentElement.scrollTop||document.body.scrollTop;if(e.dom.clientHeight+e.dom.offsetTop>=t+e.dom.clientHeight/2&&e.dom.clientHeight+e.dom.offsetTop<=t+e.dom.clientHeight/2+uo.screen_height){let e=uo.keywords.map((e=>e.label)).join(";");ue.report(19453,Object.assign({},uo.commonReportData,{SearchKeyWord:e,EventType:1})),ee.setSum(110809,46,1)}}};pe.on(window,"scroll",t),t()},ho=e=>{const t=e+"";return t.length>=2?t:"0"+t},go=e=>{const t=new Date(1e3*e);return t.getFullYear()<=(new Date).getFullYear()?"".concat(ho(t.getMonth()+1),"月").concat(ho(t.getDate()),"日 ").concat(ho(t.getHours()),":").concat(ho(t.getMinutes())):"".concat(t.getFullYear(),"年").concat(ho(t.getMonth()+1),"月").concat(ho(t.getDate()),"日 ").concat(ho(t.getHours()),":").concat(ho(t.getMinutes()))},fo={getFullTime:go,getStatusWording:(e,t)=>{let i;switch(e=parseInt(e,10),t=parseInt(t,10),e){case 0:i=0===t?"预约":"已预约";break;case 1:i="已失效";break;case 2:i="观看直播";break;case 3:case 4:i="已结束";break;case 5:i="观看回放";break;default:i="预约"}return i},getStatusDesc:(e,t)=>{let i;switch(t=parseInt(t,10)){case 0:i="将在".concat(go(e)," 直播");break;case 1:case 3:i="".concat(go(e)," 直播");break;case 2:default:i="正在直播";break;case 4:i="已结束直播，正在生成回放";break;case 5:i="已结束直播，可观看回放"}return i}},yo={report:(e,t,i,n)=>{let o=0;try{o=1*window.atob(window.biz)}catch(ps){}ue.report(22035,{BizUin:o,AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Scene:window.parseInt(window.scene,10)||0,Enterid:window.parseInt(window.enterid,10)||0,Action:e,Status:n||"",ActionTS:Math.ceil(Date.now()/1e3),Noticeid:t||"",Username:i||""})}},bo={report:(e,t)=>{let i=0;try{i=1*window.atob(window.biz)}catch(ps){}ue.report(24980,{BizUin:i,AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Scene:window.parseInt(window.scene,10)||0,Enterid:window.parseInt(window.enterid,10)||0,Action:e,ActionTS:Math.ceil(Date.now()/1e3),EventId:t+""||""})}};let vo=[],xo=[],ko=[],Ao=[],Co=[],To=[],Io=[],So=1,jo=0;const Eo={maxWidth:document.getElementById("img-content").getBoundingClientRect().width};try{jo=1*window.atob(window.biz)}catch(ps){}function Ro(){return!!Q.os.pc&&(!(!oe.isMac||!oe.cpVersion("3.1.0",1,!0,"mac"))||!!(oe.isWindows&&oe.getWindows()>="63030000"))}function Bo(e,t,i){ue.report(21146,{BizUin:jo,AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,ExportId:t||"",Action:e,Username:i||"",Scene:window.parseInt(window.scene,10)||0,Subscene:window.parseInt(window.subscene,10)||0,EnterId:window.parseInt(window.enterid,10)||0})}function No(e){oe.isNewMpApp?(window.weui||window).alert("请使用微信手机客户端打开"):"live"!==e&&"topic"!==e?("1"!==e&&0!==e||oe.isInMiniProgram&&window.weui.alert("暂不支持从小程序进入视频号"),oe.isAndroid&&window.clientversion>"2700135F"&&window.clientversion<"27001400"?window.weui.alert("当前版本暂不支持查看"):(oe.isWechat&&Q.os.pc?window.weui.alert("当前版本暂不支持查看，请在手机上查看"):oe.isWechat||alert("请使用微信手机客户端打开"),!oe.isWechat||Q.os.pc||oe.isWxWork||se.jumpUrl("https://support.weixin.qq.com/update/",!0))):oe.isAndroid&&window.clientversion<"2700143c"||oe.isIOS&&window.clientversion<"17001228"?window.weui.alert("请升级微信客户端版本后查看"):oe.isWechat&&Q.os.pc?window.weui.alert("当前版本暂不支持查看，请在手机上查看"):oe.isInMiniProgram?window.weui.alert("暂不支持从小程序进入直播间"):oe.isWechat||alert("请使用微信手机客户端打开")}function Lo(e){if(!oe.isWechat||Q.os.pc||oe.isWxWork||oe.isNewMpApp||oe.isAndroid&&window.clientversion<"2700143c"||oe.isIOS&&window.clientversion<"17001228")No("profile");else{let t={action:"openFinderProfile",finderUserName:e,commentScene:5,reportExtraInfo:JSON.stringify({scenenote:{bizUin:jo,msgid:window.parseInt(window.mid,10)||0,idx:window.parseInt(window.idx,10)||0,scene:window.parseInt(window.scene,10)||0,enterid:window.parseInt(window.enterid,10)||0,action:5,status:So,actionTS:Math.ceil(Date.now()/1e3),url:window.msg_link},biz_enter_id:window.finder_biz_enter_id})};ae.invoke("openFinderView",{extInfo:t},(e=>{console.log("openFinderView",e)}))}}function Po(e,t){let i;if(t){let e=window.location.protocol||"https:";t=encodeURIComponent(t),i=e+"//channels.weixin.qq.com/web/pages/live?eid=".concat(t)}!oe.isNewMpApp&&(oe.isWxWork&&oe.cpVersion("4.1.6",1,!0,"wxwork")||!(!oe.isWechat||Q.os.pc||oe.isAndroid&&window.clientversion<"2700143c"||oe.isIOS&&window.clientversion<"17001228"||window.is_teenager&&(window.weui.alert("青少年模式下，不支持观看直播"),1)))?ae.invoke("openFinderView",{extInfo:{action:"autoOpenFinderLive",finderUserName:e,commentScene:5,wxworkUrl:i,reportExtraInfo:JSON.stringify({scenenote:{bizUin:jo,msgid:window.parseInt(window.mid,10)||0,idx:window.parseInt(window.idx,10)||0,scene:window.parseInt(window.scene,10)||0,enterid:window.parseInt(window.enterid,10)||0,action:4,status:So,actionTS:Math.ceil(Date.now()/1e3),url:window.msg_link},biz_enter_id:window.finder_biz_enter_id})}},(e=>{console.log("openFinderLive",e)})):Ro()?t?ae.invoke("openUrlWithExtraWebview",{url:i,openType:1},(e=>{console.log("openUrlWithExtraWebview",e)})):No():No("live")}function Do(e,t,i){!oe.isWechat||Q.os.pc||oe.isWxWork||oe.isNewMpApp||oe.isAndroid&&window.clientversion<"2700143c"||oe.isIOS&&window.clientversion<"17001228"||ae.invoke("openFinderView",{extInfo:{action:"autoOpenFinderLive",finderUserName:e,commentScene:5,feedID:t,nonceID:i,exportId:t,enableReplay:!0,reportExtraInfo:JSON.stringify({biz_enter_id:window.finder_biz_enter_id})}})}function qo(e,t,i,n,o){Bo(2,e,i);let a="";if(o){let e=window.location.protocol||"https:";o=encodeURIComponent(o),a=e+"//channels.weixin.qq.com/web/pages/feed?eid=".concat(o)}if(oe.isNewMpApp||!(oe.isWxWork&&oe.cpVersion("4.1.6",1,!0,"wxwork")||oe.isDonutAPP)&&(!oe.isWechat||Q.os.pc||oe.isIOS&&oe.ltVersion("7.0.15",!1)||oe.isAndroid&&window.clientversion<="27001337"||oe.isAndroid&&window.clientversion>"2700135F"&&window.clientversion<"27001400"))Ro()?o?ae.invoke("openUrlWithExtraWebview",{url:a,openType:1},(e=>{console.log("openUrlWithExtraWebview",e)})):No(n):(Bo(3,e,i),No(n));else{let i={action:"openFinderFeed",feedID:e,nonceID:t,notGetReleatedList:9===n?"1":0,shareScene:11,requestScene:34,wxworkUrl:a,reportExtraInfo:JSON.stringify({mp:{scene:1},bizUin:jo,url:window.msg_link,biz_enter_id:window.finder_biz_enter_id})};ae.invoke("openFinderView",{extInfo:i},(e=>{console.log("openFinderDetailView",e)}))}}function zo(e,t){!oe.isWechat||Q.os.pc||oe.isWxWork||oe.isNewMpApp||oe.isAndroid&&window.clientversion<"28000130"||oe.isIOS&&window.clientversion<"18000622"||window.is_teenager&&(window.weui.alert("青少年模式下，不支持观看直播"),1)?No("topic"):ae.invoke("openFinderTopicView",{extInfo:{title:e,topicType:7,eventEncryptedTopicId:t,entryScene:5}},(e=>{console.log("openFinderTopicView",e)}))}function Oo(e){if(!e)return 0;const t=1e4;return e<t?e:e>1e5?"10万+":(e/t).toFixed(1)/1+"万"}function Mo(e){return xo.filter((t=>t.export_id===e))}function Wo(e){return ko.filter((t=>t.notice_id===e))}function Ho(e){return Co.filter((t=>t.event_id===e))}function Uo(e){let t=e;if(t){let e,i=t.getAttribute("data-id"),n=Mo(i);n&&n.length>0&&(e=n[0]);let o=e&&e.nonce_id?e.nonce_id:t.getAttribute("data-nonceid"),a=e&&e.flag||0,s=e&&e.username?e.username:t.getAttribute("data-username"),r=e&&e.media_type?e.media_type:t.getAttribute("data-mediatype"),c=e&&e.export_id;0===a&&qo(i,o,s,r,c)}}function Fo(e){if(e){let t=e.getAttribute("data-eventid")||"event/UzFfAgtgekIEAQAAAAAA8PsgAc-cEgAAAAstQy6ubaLX4KHWvLEZgBPE8KNsXHhHYfj-zNPgMI5VOd7tKLpk98zswwl8bF9v",i=Ho(t),n=i.length>0?i[0]:{event_info:{}};0===n.event_info.flag?(zo(n.event_info.name,t),bo.report(2,t)):bo.report(3,t)}}function Jo(e){let t=Wo(e);t&&t.length>0&&(t=t[0]);let i=t.status,n=t.reservation;return 0===i?0===n?1:2:1===i?5:2===i?3:3===i?4:1}function Vo(e,t,i){!oe.isWxWork&&oe.isWechat?window.is_teenager?window.weui.alert("青少年模式下，不支持预约直播"):K({url:"/mp/appmsg_video_snap?action=reserve_live",type:"POST",dataType:"json",async:!0,data:{username:e,notice_id:t,reserve_status:i},success:function(e){if(e&&e.base_resp&&0===e.base_resp.ret){let e=document.querySelectorAll('.js_wechannel_live_card[data-noticeid="'.concat(t,'"]'));for(let t=0;t<e.length;t++){let n=e[t];const o=1===i?1:0;n.setAttribute("data-reservation",o)}let n=Wo(t);n&&n.length>0&&n.forEach((e=>{e.reservation=1===i?1:0}))}else window.weui.alert("系统繁忙，请稍后再试")},error:function(){window.weui.alert("操作失败")}}):window.weui.alert("请在微信内操作")}function Xo(){if(Ao&&Ao.length&&To.length===Ao.length)pe.off(window,"scroll",Xo);else for(let e=0;e<Ao.length;e++){let t=Ao[e],i=t;if(i&&i.getBoundingClientRect().top>0&&i.getBoundingClientRect().top+i.getBoundingClientRect().height/2<=_e.getInnerHeight()){let e=t.getAttribute("data-id")||t.getAttribute("data-noticeid")||t.getAttribute("data-eventid"),i=t.getAttribute("data-username"),n=t.getAttribute("data-type");-1===To.indexOf(e)&&(To.push(e),"live"===n?yo.report(1,e,i,Jo(e)):"topic"===n?bo.report(1,e):Bo(1,e,i))}}}function $o(e,t,i,n){let o=document.querySelectorAll('.js_wechannel_live_card[data-noticeid="'.concat(e,'"]'));for(let a=0;a<o.length;a++){let e=o[a],s=fo.getStatusDesc(n,t);e.setAttribute("data-desc",s),e.setAttribute("data-reservation",i),e.setAttribute("data-status",t)}}function Go(){pe.bindVisibilityChangeEvt((e=>{e&&function(){let e={__biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",uin:window.uin||"",key:window.key||"",pass_ticket:window.pass_ticket||"",video_snap_num:ko.length};for(let i=0;i<ko.length;i++){let t=ko[i].notice_id,n=ko[i].username;e["notice_id_".concat(i)]=t,e["username_".concat(i)]=n}let t="/mp/appmsg_video_snap?action=batch_get_flag_info";for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t+="&"+i+"="+encodeURIComponent(e[i]));K({url:t,type:"GET",dataType:"json",async:!0,success:function(e){if(e&&e.base_resp&&0===e.base_resp.ret&&(console.log("batch_get_flag_info:",e),e.live_info&&e.live_info.length>0))for(let t=0;t<e.live_info.length;t++){let i=e.live_info[t],n=Wo(i.notice_id);if(n&&n.length>0){let e=n[0];i.status===e.status&&i.reservation===e.reservation||(e.reservation=i.reservation,e.status=i.status,$o(i.notice_id,i.status,i.reservation,e.start_time))}}},error:function(){}})}()}))}function Ko(){!function(){let e=document.getElementsByClassName("js_wechannel_img_card");for(let t=0;t<e.length;t++){let i=e[t];pe.on(i,"click",(()=>{Uo(i)}))}}(),function(){let e=document.getElementsByClassName("js_wechannel_video_card");for(let t=0;t<e.length;t++){let i=e[t];pe.on(i,"click",(()=>{Uo(i)}))}}(),setTimeout((()=>{let e=e=>{let t=e.currentTarget,i=t.getAttribute("data-noticeid"),n=t.getAttribute("data-username"),o="";return ko instanceof Array&&ko.forEach((e=>{e.notice_id===i&&(o=e.export_id)})),yo.report(4,i,n,Jo(i)),So=Jo(i),Po(n,o),!1},t=document.getElementsByClassName("js_wechannel_live_card");if(console.log(t),t.length>0)for(let i=0;i<t.length;i++){let n=t[i].shadow.childNodes[2].__vue__.$refs.reserveButton,o=parseInt(n.getAttribute("data-status"),10);if(2===o)pe.on(n,"click",e);else if(0===o)pe.on(n,"click",(()=>{if(window.is_temp_url)return window.weui.alert("预览状态下无法操作"),!1;if(oe.isNewMpApp)return window.weui.alert("请前往微信客户端操作"),!1;let e=n.getAttribute("data-noticeid"),t=n.getAttribute("data-reservation"),i=n.getAttribute("data-username");return"0"===t?yo.report(2,e,i,Jo(e)):yo.report(3,e,i,Jo(e)),Vo(i,e,"0"===t?1:2),!1}));else if(5===o){const e=n.getAttribute("data-noticeid"),t=n.getAttribute("data-username"),i=Wo(e)||[],o=i[0]&&i[0].export_id;pe.on(n,"click",(()=>{Do(t,o,e)}))}}}),0),function(){let e=document.getElementsByClassName("js_wechannel_live_card");const t=e=>{let t=e.currentTarget,i=t.getAttribute("data-username"),n=t.getAttribute("data-noticeid");yo.report(5,n,i,Jo(n)),So=Jo(n),Lo(i)};for(let i=0;i<e.length;i++){let n=e[i];pe.on(n,"click",t)}}(),function(){let e=document.getElementsByClassName("js_wechannel_topic_card");for(let t=0;t<e.length;t++){let i=e[t];pe.on(i,"click",(()=>{Fo(i)}))}}(),Go(),pe.on(window,"scroll",Xo)}function Qo(e,t){if(t){if(t.isSaveEnter)return e.replace(/\n/g,"<br>");if(t.isDecodeEnter)return e.replace(/&lt;br&gt;/g,"<br>")}return e}function Yo(){let e=document.getElementById("js_content");if(!e)return;vo=Array.from(e.getElementsByTagName("mpvideosnap"))||[];const t=Array.from(e.getElementsByTagName("mp-common-videosnap"))||[],i=vo.concat(t);console.log(i);let n=null;function o(e){if("MPVIDEOSNAP"===e.tagName){const t=document.createElement("mp-common-videosnap");return e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e),t}return e}for(let a=0;a<i.length;a++){let t=i[a];n=t.parentNode.getBoundingClientRect().width,n=Math.min(n,Eo.maxWidth);let s,r=t.getAttribute("data-id")||t.getAttribute("data-noticeid")||"",c=t.getAttribute("data-type")||"video";if("live"===c){let e=Wo(t.getAttribute("data-noticeid")||""),i=e.length>0?e[0]:{};s={snapType:"live",headImgUrl:i.head_url||t.getAttribute("data-headimgurl")||"",nickname:i.nickname||t.getAttribute("data-nickname")||"",desc:fo.getStatusDesc(i.start_time,i.status)||t.getAttribute("data-desc")||"",reservation:i.reservation||0,status:i.status||0,username:i.username||t.getAttribute("data-username")||"",noticeid:i.notice_id||t.getAttribute("data-noticeid")||"",flag:1===i.spam_flag||2===i.spam_flag?1:0,intro:Qo(i.introduction||"",{isSaveEnter:!0})},Io.push({noticeid:i.notice_id||t.getAttribute("data-noticeid")||"",status:i.status||0});const{snapType:n,headImgUrl:r,nickname:c,desc:d,reservation:l,status:p,username:m,noticeid:_,flag:u,intro:w}=s;t=o(t),t.setAttribute("data-index",a),t.setAttribute("data-headimgurl",r),t.setAttribute("data-username",m),t.setAttribute("data-nickname",c),t.setAttribute("data-desc",d),t.setAttribute("data-intro",w),t.setAttribute("data-type",n),t.setAttribute("data-status",p),t.setAttribute("data-flag",u),t.setAttribute("data-reservation",l),t.setAttribute("data-noticeid",_),t.classList.add("js_wechannel_live_card"),t.classList.add("js_wx_tap_highlight"),Ao.push(t)}else if("video"===c||"image"===c){let e=Mo(r),i=e.length>0?e[0]:{},d=Oo(1*i.feed_like_num),l=4===i.media_type||9===i.media_type?"video":"image",p=((1*t.getAttribute("data-ratio")||1)>1?i.feed_full_cover_url||i.feed_thumb_url:i.feed_cover_url||i.feed_thumb_url)||t.getAttribute("data-url")||"";"image"===c&&(p=i.feed_thumb_url||t.getAttribute("data-url")||""),s={snapType:i&&i.media_type?l:t.getAttribute("data-type"),url:p,headImgUrl:i.head_url||t.getAttribute("data-headimgurl")||"",authiconUrl:i.auth_info&&i.auth_info.auth_icon_url||"",nickname:i.nickname||t.getAttribute("data-nickname")||"",desc:i.feed_desc||t.getAttribute("data-desc")||"",flag:i.flag||0,likenum:d,feedFullCoverUrl:i.feed_full_cover_url,feedThumbUrl:i.feed_thumb_url,feedCoverUrl:i.feed_cover_url,id:t.getAttribute("data-id"),username:i.username||t.getAttribute("data-username"),nonceid:i.nonce_id||t.getAttribute("data-nonceid"),width:t.getAttribute("data-width"),height:t.getAttribute("data-height"),isNews:i.is_news},"image"===s.snapType&&(s=Object.assign(s,{imgCount:parseInt(i.media_num||"0",10)||parseInt(t.getAttribute("data-imgcount")||"0",10)||0}));const{url:m,headImgUrl:_,authiconUrl:u,nickname:w,desc:h,flag:g,likenum:f,id:y,username:b,nonceid:v,width:x,height:k,isNews:A,feedFullCoverUrl:C,feedThumbUrl:T,feedCoverUrl:I}=s;t=o(t),t.setAttribute("data-index",a),t.setAttribute("data-url",m),t.setAttribute("data-headimgurl",_),t.setAttribute("data-username",b),t.setAttribute("data-nickname",w),t.setAttribute("data-desc",h),t.setAttribute("data-flag",g),t.setAttribute("data-nonceid",v),t.setAttribute("data-type",s.snapType),t.setAttribute("data-authiconurl",u),t.setAttribute("data-feedfullcoverurl",C),t.setAttribute("data-feedthumburl",T),t.setAttribute("data-feedcoverurl",I),t.setAttribute("data-width",x),t.setAttribute("data-height",k),t.setAttribute("data-isnews",A?1:0),t.setAttribute("data-likenum",f),t.setAttribute("data-parentwidth",n),t.setAttribute("data-maxwidth",Eo.maxWidth),t.setAttribute("data-id",y),"video"===s.snapType?t.classList.add("js_wechannel_video_card"):(t.classList.add("js_wechannel_img_card"),t.classList.add("js_wechannel_img_context")),t.classList.add("js_wx_tap_highlight"),Ao.push(t)}else if("topic"===c){let e=Ho(t.getAttribute("data-eventid")||"event/UzFfAgtgekIEAQAAAAAA8PsgAc-cEgAAAAstQy6ubaLX4KHWvLEZgBPE8KNsXHhHYfj-zNPgMI5VOd7tKLpk98zswwl8bF9v"),i=e.length>0?e[0]:{event_info:{}},n=Ze.unix(i.event_info.end_time).format("YYYY年MM月DD日 HH:mm");s={snapType:"topic",headImgUrl:i.event_info.head_url,nickname:i.event_info.nickname,desc:i.event_info.desc,flag:i.event_info.flag,endTime:n,eventId:i.event_id,closeFlag:i.event_info.close_flag,title:i.event_info.name};const{snapType:r,headImgUrl:c,nickname:d,desc:l,flag:p,endTime:m,closeFlag:_,title:u,eventId:w}=s;t=o(t),t.setAttribute("data-index",a),t.setAttribute("data-headimgurl",c),t.setAttribute("data-nickname",d),t.setAttribute("data-desc",l),t.setAttribute("data-endtime",m),t.setAttribute("data-flag",p),t.setAttribute("data-name",u),t.setAttribute("data-closeflag",_),t.setAttribute("data-type",r),t.setAttribute("data-eventid",w),t.classList.add("js_wechannel_topic_card"),t.classList.add("js_wx_tap_highlight"),Ao.push(t)}et(t,r);const d=k({startElem:t,endElem:e},{rules:["CSS[Opacity<1]","CSS[Height=0]"]});if(d.length>0){ee.setSum(299174,4,1);const e="biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx);window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("videoSnapCoverDetect","".concat(e),{mid:"mmbizwap:appmsg_covertest",view:"wap_business",_info:{url:location.href,hitArr:d}})}}Xo(),Ko()}function Zo(){!function(){let e=[];try{e=JSON.parse(window.video_snap_json).list}catch(ps){console.log(ps)}let t={},i={__biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",uin:window.uin||"",key:window.key||"",pass_ticket:window.pass_ticket||""},n=0;for(let o=0;o<e.length;o++){let a=e[o].export_id||e[o].notice_id||e[o].event_id,s=e[o].username;t[a]?t[a].push(o):(t[a]=[o],e[o].export_id?i["exportid_".concat(n)]=a:e[o].notice_id?i["notice_id_".concat(n)]=a:e[o].event_id&&(i["export_event_id_".concat(n)]=a),i["username_".concat(n)]=s,n++)}i.video_snap_num=Object.keys(t).length,K({url:"/mp/appmsg_video_snap?action=batch_get_video_snap",type:"POST",dataType:"json",async:!0,data:i,success:function(e){e&&e.base_resp&&0===e.base_resp.ret&&(xo=e.video_snap_info||[],ko=e.live_info||[],Co=e.event_info||[]),Yo()},error:function(){Yo()}})}()}let ea={pvele:[],checkInScreenId:null,reportRandom:Math.random()};function ta(){if(console.log("weproduct init"),"function"!=typeof document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_container");e&&e.length>0&&(!function(e){try{for(let t=0,i=e.length;t<i;t++){let i=e[t];if(i.className.indexOf("js_list_container")>=0){let e=i.querySelector("img.js_cover");if(e){let t=e.parentNode.getBoundingClientRect();e.style.setProperty("width",t.width+"px","important"),e.style.setProperty("height",t.height+"px","important"),e.style.setProperty("background-size","unset","important"),"0"==e.getAttribute("data-fail")?ia.call(e):e.getAttribute("data-fail")||(e.lazyLoadOnload=e.lazyLoadOnload||[],e.lazyLoadOnload.push(ia))}}}}catch(ps){}}(e),S.getAppidInfo({onSuccess:function(t){ea.data=t.data,function(e){for(let i=0,n=e.length;i<n;i++)!function(e,t){pe.on(e,"tap",".js_product_loop_content",(function(e){let i=e.delegatedTarget,n=i.getAttribute("data-wxaappid"),o=i.getAttribute("data-wxapath"),a=i.getAttribute("data-pid"),s=i.getAttribute("data-appid"),r=i.querySelector(".cps_inner_info_title").innerHTML;return S.jumpUrl({privateExtraData:{cookies:"cps_package=123456; expires=1538286412; busid=mmbiz_ad_cps; domain=*"},sourceAppId:s,appid:n,path:o,scene:1091,sceneNote:[encodeURIComponent(location.href),user_name,msg_title,encodeURIComponent(a),r,o].join(":"),beforeNonWechatWarn:function(){},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){if("openWeApp:ok"===e.err_msg&&a){let e=2;2==i.getAttribute("data-pidtype")&&(e=4),oa([{wxa_appid:n,pid:a,type:e,absolute_order:t+1,appid:i.getAttribute("data-appid")||"",templateid:i.getAttribute("data-templateid")||"",relative_order:1*i.getAttribute("data-order"),packid:i.getAttribute("data-packid")||""}])}}}),!1}))}(e[i],i);let t=document.getElementsByClassName("js_product_loop_content");if(t&&t.length>0&&_e.getInnerHeight()){for(let e=0;e<t.length;e++)ea.pvele.push(t[e]);na(),pe.on(window,"scroll",na)}}(e)}})),setTimeout((function(){let e=document.getElementsByClassName("js_product_loop_content").length,t=document.getElementsByClassName("js_product_err_container").length;ee.setSum("64469","15",e+t),ee.setSum("64469","16",e),ee.setSum("64469","18",t)}),0)}function ia(){let e=this.parentNode;if(!e)return;let t=document.createElement("span");t.className=this.className,t.style.background='url("'+this.src+'") no-repeat center',e.insertBefore(t,this),e.removeChild(this)}function na(e){ea.checkInScreenId&&clearTimeout(ea.checkInScreenId),ea.checkInScreenId=setTimeout((function(){ea.checkInScreenId=null;let e=[];for(let t=0;t<ea.pvele.length;t++){let i=ea.pvele[t],n=i.getBoundingClientRect();if((n.height||n.bottom-n.top)>0&&n.top<_e.getInnerHeight()&&n.bottom>0){let n=i.getAttribute("data-pid");if(n){let o=1;2==i.getAttribute("data-pidtype")&&(o=3),e.push({wxa_appid:i.getAttribute("data-wxaappid"),pid:n,type:o,absolute_order:t+1,appid:i.getAttribute("data-appid")||"",templateid:i.getAttribute("data-templateid")||"",relative_order:1*i.getAttribute("data-order"),packid:i.getAttribute("data-packid")||""})}ea.pvele.splice(t--,1)}}oa(e),0==ea.pvele.length&&(pe.off(window,"scroll",na),na=null)}),100)}function oa(e){if(!e||0==e.length)return;let t={batch_no:Y.getQuery("batch_no")||"",bizuin:window.biz||"",biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",total:e.length};for(let i=0;i<e.length;i++){let n=e[i],o=i+1;for(let e in n)n.hasOwnProperty(e)&&(t[e+""+o]=n[e])}K({url:"/mp/productreport?",type:"POST",data:t,dataType:"json",async:!0})}const aa=window.location.protocol+"//support.weixin.qq.com/update/";let sa=[],ra=1,ca=Y.getQuery("fontScale");function da(e){ca=e.fontScale,setTimeout((()=>{let e=document.getElementsByTagName("wx-open-subscribe")||[];for(let t=0;t<e.length;t++)e[t].setAttribute("size",ra),e[t].setAttribute("scale",ca),ra++}),50)}function la(){if(!document.getElementById("js_content"))return;const e=document.querySelectorAll("mpsubscribe");for(let t=0;t<e.length;t++){let i=e[t];const n=document.createElement("mp-common-subscribe"),o=i.getAttribute("data-templateidlist");let a=i.getAttribute("data-index")||0;i.parentNode.appendChild(n),i.parentNode.removeChild(i),n.setAttribute("data-templateidlist",o),n.setAttribute("data-index",a)}sa=document.getElementsByTagName("mp-common-subscribe")||[];for(let t=0;t<sa.length;t++){let e=sa[t],i=e.getAttribute("data-templateidlist")||[],n=e.getAttribute("data-index")||0,o=window.__is_support_wxOpen?1:0;e.setAttribute("data-scene",window.is_temp_url?3:2),e.setAttribute("data-username",window.user_name),e.setAttribute("data-supportwxopen",o),e.setAttribute("data-scale",ca),e.setAttribute("data-index",n),e.setAttribute("data-tagContent","订阅通知"),e.setAttribute("data-templateidlist",i),o||e.classList.add("js_subsc_btn")}A(da),function(){let e=document.getElementsByClassName("js_subsc_btn")||[];for(let t=0;t<e.length;t++){let i=e[t];pe.on(i,"click",(()=>{window.uin&&window.key&&oe.isWechat&&!oe.isWindowsWechat&&!oe.isMacWechat?document.getElementById("js_update_dialog").style.display="block":window.weui.alert("请在手机微信内操作")}))}pe.on(document.getElementById("js_update_cancel"),"click",(()=>{document.getElementById("js_update_dialog").style.display="none"})),pe.on(document.getElementById("js_update_confirm"),"click",(()=>{se.jumpUrl(aa,!0)}))}()}function pa(){if(!networkType)return;let e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||void 0===e.getEntries)return;let t,i=document.getElementsByTagName("img"),n=i.length;function o(e){let t=[];for(let i in e)t.push(i+"="+encodeURIComponent(e[i]||""));return t.join("&")}let a,s=!1;a=RegExp.$1;for(let r=0,c=i.length;r<c;r++){if(t=parseInt(100*Math.random()),t>100)continue;let c=i[r].getAttribute("src");if(!c||c.indexOf("mp.weixin.qq.com")>=0)continue;let d,l=e.getEntries();for(let e=0;e<l.length;e++)if(d=l[e],d.name==c){let e=i[r].getAttribute("data-fail");K({type:"POST",url:"/mp/appmsgpicreport?__biz="+biz+"#wechat_redirect",data:o({rnd:Math.random(),uin:uin,version:version,client_version:a,device:navigator.userAgent,time_stamp:parseInt(+new Date/1e3),url:c,img_size:i[r].fileSize||0,user_agent:navigator.userAgent,net_type:networkType,appmsg_id:window.appmsgid||"",sample:n>100?100:n,delay_time:parseInt(d.duration),from:window.isSg?"sougou":"",fail:e})}),s=!0;break}if(s)break}}let ma={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};const _a='<div id="js_profile_ban" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-warn weui-icon_toast"></i>\n    <p class="weui-toast__content">该账号因违规无法跳转</p>\n  </div>\n</div>';let ua=[],wa=[];function ha(e){try{return 1*window.atob(e)}catch(ps){}return 0}function ga(e,t,i,n){ue.report(22316,{BizUin:ha(window.biz),AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Itemshowtype:0,SessionId:window.sessionid+"",EnterId:window.parseInt(window.enterid,10)||0,Scene:1*window.source,Subscene:1*window.subscene,ActionType:e,toBizuin:ha(t),isBizBan:1*i,isMassSend:1*window.appmsg_type,CardType:n})}function fa(){if(ua&&ua.length&&wa.length===ua.length)pe.off(window,"scroll",fa);else for(let e=0;e<ua.length;e++){let t=ua[e],i=t.querySelector(".js_wx_profile_card");if(i&&i.getBoundingClientRect().top>0&&i.getBoundingClientRect().top+i.getBoundingClientRect().height/2<=_e.getInnerHeight()){let e=i.getAttribute("data-id"),n=i.getAttribute("data-index");if(-1===wa.indexOf(n)){wa.push(n),ga(0,e,i.getAttribute("data-isban"),1*t.getAttribute("data-from"))}}}}function ya(e,t,i,n,o,a){e.addEventListener("click",(()=>{if(ga(1,i,n,a),n){let e=document.getElementById("js_profile_ban");"none"===e.style.display&&(e.style.display="block",setTimeout((()=>{e.style.display="none"}),2e3))}else he.goProfile({biz:i,scene:124},{username:t,scene:"200"},null,o)}))}function ba(e){return window.mp_profile.find((t=>t.fakeid===e))}function va(){!function(){let e=document.getElementById("js_content");if(!e)return;ua=Array.from(document.getElementsByTagName("mpprofile"))||[];const t=Array.from(document.getElementsByTagName("mp-common-profile"))||[],i=ua.concat(t);window.mp_profile.forEach((e=>{e.round_head_img&&(e.round_head_img=e.round_head_img.compressCDNImgSize(),e.round_head_img=Y.addParam(e.round_head_img,"wxfrom",19,!0))}));for(let o=0;o<i.length;o++){let t=i[o],n=t.getAttribute("data-id"),a=1*t.getAttribute("data-from"),s=ba(n)||{};const{alias:r="",fakeid:c,is_biz_ban:d,nickname:l="",original_num:p,round_head_img:m,signature:_="",username:u,biz_account_status:w}=s;let h=t.parentNode&&t.parentNode.querySelector('[data-preloadingid="'.concat(n,'"]'));if(h&&t.parentNode.removeChild(h),s){if("MPPROFILE"===t.tagName){const e=document.createElement("mp-common-profile");t.parentNode.appendChild(e),t.parentNode.removeChild(t),t=e}t.setAttribute("data-index",o),t.setAttribute("data-id",c),t.setAttribute("data-headimg",m),t.setAttribute("data-nickname",l.htmlDecode()),t.setAttribute("data-alias",r.htmlDecode()),t.setAttribute("data-signature",_.htmlDecode()),t.setAttribute("data-origin_num",1*p),t.setAttribute("data-is_biz_ban",1*d),t.setAttribute("data-isban",1*d),t.setAttribute("data-biz_account_status",1*w),t.classList.add("js_wx_tap_highlight"),ya(t,s.username,s.fakeid,s.is_biz_ban,s.biz_account_status,a)}else t.innerHTML="";const g=k({startElem:i[o],endElem:e},{rules:["CSS[Opacity<1]","CSS[Height=0]"]});if(g.length>0){ee.setSum(299174,3,1);const e="biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx);window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("profileCoverDetect","".concat(e),{mid:"mmbizwap:appmsg_covertest",view:"wap_business",_info:{url:location.href,hitArr:g}})}}fa();let n=document.createElement("div");n.innerHTML=me.tmpl(_a,{}),document.body.appendChild(n)}(),pe.on(window,"scroll",fa)}const xa=[],ka=document.getElementsByTagName("mp-common-sticker"),Aa=new Map,Ca=[],Ta=[];for(const ct of ka){Ca.push(ct.dataset.md5);const e=Aa.get(ct.dataset.md5);e?(e.push(ct),Aa.set(ct.dataset.md5,e)):(Aa.set(ct.dataset.md5,[ct]),ct.dataset.buf||Ta.push(ct.dataset.md5))}const Ia={EXPOSE:0,CLICK:1,LONGTAP:2};function Sa(e,t){const i=t.dataset.md5,n=Number(t.dataset.type),o=t.dataset.emoji_url,a=Number(t.dataset.is_ban),s=t.dataset.buf;ue.report(29377,{bizuin:Number(window.atob(window.biz))||0,msgid:window.parseInt(window.mid,10)||0,itemidx:window.parseInt(window.idx,10)||0,SessionId:window.sessionid+"",EnterId:window.parseInt(window.enterid,10)||0,scene:1*window.source,Subscene:1*window.subscene,action:e,md5:i,type:n,url:o,isBan:a,buf:s})}function ja(){var e;!function(){for(const e of ka)pe.longtap(e,(function(t){if(t.stopPropagation(),1===parseInt(e.dataset.is_ban,10))return;Sa(Ia.LONGTAP,e);Ea(e.dataset.emoji_url,e.dataset.md5,1,e.dataset.buf||"",!0)}),!0),pe.tap(e,(function(t){if(t.stopPropagation(),1===parseInt(e.dataset.is_ban,10))return;Sa(Ia.CLICK,e);Ea(e.dataset.emoji_url,e.dataset.md5,0,e.dataset.buf||"",!0)}))}(),e=Ca,K({type:"POST",url:"/mp/checkemoticon?action=checkmd5batch",data:{action:"checkmd5batch",md5ListJson:JSON.stringify({list:e})},dataType:"json",timeout:3e3,success:e=>{e&&e.base_resp&&-1!==e.base_resp.ret&&e.is_ban_list&&Array.isArray(e.is_ban_list)&&e.is_ban_list.forEach(((e,t)=>{ka[t].dataset.is_ban=e}))},complete:()=>{for(const e of ka){let t=e.getAttribute("data-id"),i=null;e.parentNode&&(i=e.parentNode.querySelector('[data-preloadingid="'.concat(t,'"]'))),i&&e.parentNode.removeChild(i),e.dataset.can_show=1}}}),function(e){if(0===e.length)return;K({type:"POST",url:"/mp/getemojibuf?action=getbuf",data:{action:"getbuf",md5ListJson:JSON.stringify({list:e})},dataType:"json",timeout:3e3,success:e=>{if(e&&e.base_resp&&-1!==e.base_resp.ret&&e.emoji_info&&Array.isArray(e.emoji_info)){e.emoji_info.forEach((e=>{if(e.md5){Aa.get(e.md5).forEach((t=>{t.dataset.buf=e.buf}))}}))}},complete:()=>{}})}(Ta),function(){let e=null;e=new IntersectionObserver((function(t,i){t.forEach((t=>{if(t.isIntersecting){const i=t.target;Sa(Ia.EXPOSE,i),e.unobserve(i)}}))}),{threshold:.5}),ka.forEach((t=>{e.observe(t)}))}()}function Ea(e,t,i,n,o){let a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(e){let s=new Uint8Array(a.response),r=s.length,c=new Array(r);for(;r--;)c[r]=String.fromCharCode(s[r]);let d=c.join(""),l=window.btoa(d);if(o)ae.invoke("emoticonAPICollection",{md5:t,opType:i,imageDataString:l,emojiInfoBuf:n},(function(e){}));else{if(!xa)return;xa.push({md5:t,emojiInfoBuf:n,opType:i,imgDataString:l})}return l},a.onerror=function(e){console.log("xmlHttp.onerror",e)},a.onabort=function(e){console.log("xmlHttp.onabort",e)},a.send()}const Ra={tagName:"mp-common-vote",loginCheckFailed:0};function Ba(e,t){const{vote_subject:i,super_vote_id:n}=t,o=e.shadowRoot.querySelectorAll(".js_wx_tap_highlight"),a=e.shadowRoot.querySelector(".js_tool_area"),s=e.shadowRoot.querySelector(".js_ban_area");let r=!1;o&&o.length&&o.forEach((e=>{pe.on(e,"touchstart",(e=>{const t=e.currentTarget;C.highlightEle(t),e.stopPropagation()}))})),a&&pe.on(a,"click",".js_submit_btn",(()=>{const t=function(e,t){let i=[];return e&&e.length&&e.forEach(((e,n)=>{const o=e.options||[],a=[];let s=!1;o.forEach(((e,i)=>{const o=t.shadowRoot.querySelector("#vote_".concat(n,"_").concat(i));o&&o.checked&&(s=!0,a.push(i))})),s&&i.push({vote_id:e.vote_id,item_idx_list:{item_idx:a}})})),i}(i,e);if(r||!t.length)return!1;if(window.is_temp_url)return window.weui.toast("预览状态下无法操作",{extClass:"weui-toast_text"}),!1;r=!0;const o={action:"vote",__biz:window.biz,uin:window.uin,key:window.key,pass_ticket:window.pass_ticket,appmsg_token:window.appmsg_token,f:"json",json:JSON.stringify({super_vote_item:t,super_vote_id:n})},{idx:a,mid:s,wxtoken:c,reprint_ticket:d,source_mid:l,source_idx:p}=window;a&&(o.idx=window.idx),s&&(o.mid=s),c&&(o.wxtoken=c),d&&(o.reprint_ticket=d),l&&(o.source_mid=l),p&&(o.source_idx=p),o.appmsg_token?(new Image).src=location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?idkey=68064_11_1&r="+Math.random():(new Image).src=location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?idkey=68064_12_1&r="+Math.random(),K({url:"/mp/newappmsgvote",data:o,dataType:"json",type:"post",success:function(t){if(t.base_resp&&1*t.base_resp.ret==0){for(var n=0;n<i.length;n++)for(var o=0;o<i[n].options.length;o++){const t=e.shadowRoot.querySelector("#vote_".concat(n,"_").concat(o));t&&t.checked&&(i[n].options[o].selected=!0,i[n].options[o].cnt++,i[n].total_cnt++)}r=!1,function(e,t){e.setAttribute("data-votesubject",JSON.stringify(t))}(e,i)}else t.base_resp&&1*t.base_resp.ret==-7?(r=!1,window.weui.toast("关注公众号后才可以投票",{extClass:"weui-toast_text"})):t.base_resp&&1*t.base_resp.ret==-6?(r=!1,window.weui.toast("投票过于频繁，请稍后再试",{extClass:"weui-toast_text"})):t.base_resp&&1*t.base_resp.ret==166001?window.weui.toast("投票已过期",{extClass:"weui-toast_text"}):t.base_resp&&1*t.base_resp.ret==166002?window.weui.toast("投票已删除",{extClass:"weui-toast_text"}):(r=!1,window.weui.toast("投票失败，请稍后再试",{extClass:"weui-toast_text"}))},error:function(){r=!1,window.weui.toast("投票失败，请稍后再试",{extClass:"weui-toast_text"})}})})),s&&pe.on(s,"click",".js_refresh_btn",(()=>{e.setAttribute("data-retry","1"),La(n).then((t=>{Na(e,JSON.parse(t))})).catch((()=>{Na(e,{super_vote_id:n,expire_time:"",fail:1})}))})),new ke({container:e.shadowRoot.querySelector(".jsVoteList"),isHttpsRes:!0})}function Na(e,t){let i=Ra.loginCheckFailed;oe.isWechat||oe.isWindowsWechat||oe.isMacWechat||(i=1);let n=e;if(1*t.del_flag==0){if(e.tagName.toLowerCase()!==Ra.tagName){const t=document.createElement(Ra.tagName),i=document.createElement("section");i.setAttribute("class","mp_vote_iframe_wrp"),i.appendChild(t);const o=e.parentNode.parentNode;o&&(o.appendChild(i),o.removeChild(e.parentNode)),n=t}n.setAttribute("data-supervoteid",t.super_vote_id),n.setAttribute("data-logincheckfailed",i),n.setAttribute("data-expiretime",t.expire_time),n.setAttribute("data-votesubject",t.vote_subject?JSON.stringify(t.vote_subject):"[]"),n.setAttribute("data-fail",t.fail||"0"),n.setAttribute("data-retry","0"),setTimeout((()=>{Ba(n,t)}),0)}else n.parentNode.removeChild(n)}function La(e){return new Promise(((t,i)=>{K({type:"GET",dataType:"json",url:"/mp/newappmsgvote?action=show&supervoteid=".concat(e,"&__biz=").concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx),timeout:1e4,success:e=>{e&&e.base_resp&&1*e.base_resp.ret==0&&e.data?(Ra.loginCheckFailed=1*e.login_check_failed,t(e.data)):i()},error:e=>{i(e)}})}))}function Pa(){!function(){if(!document.getElementById("js_content"))return;const e=document.querySelectorAll("iframe");let t=[];for(let n=0;n<e.length;n++){const i=e[n],o=i.getAttribute("data-src")||"",a=i.className||"";o.indexOf("newappmsgvote")>-1&&(a.indexOf("js_editor_vote_card")>=0||a.indexOf("vote_iframe")>=0)&&t.push(i)}const i=(Array.from(document.getElementsByTagName(Ra.tagName))||[]).concat(t);for(let n=0;n<i.length;n++){let e=i[n];const t=e.getAttribute("data-supervoteid")||"";La(t).then((t=>{Na(e,JSON.parse(t))})).catch((()=>{Na(e,{super_vote_id:t,expire_time:"",fail:1})}))}}()}const Da={tagName:"mp-common-answer",isWechat:(oe.isAndroid||oe.isIOS)&&oe.isWechat&&!oe.isWxWork&&!oe.isNewMpApp},qa=document.getElementsByTagName(Da.tagName),za={EXPOSE:1,CLICK:2};function Oa(e){let t=[];try{const i=JSON.parse(e);i&&i.list&&Array.isArray(i.list)&&(t=i.list)}catch(i){console.error(i)}return t}function Ma(e,t){const i=window.parseInt(t.dataset.usertype,10),n=Oa(t.dataset.picture_list),o=Oa(t.dataset.video_list);ue.report(30376,{bizuin:Number(window.atob(window.biz))||0,msgid:window.parseInt(window.mid,10)||0,itemidx:window.parseInt(window.idx,10)||0,title:window.msg_title||"",accountType:1===i?2:1,accountUin:t.dataset.username,answerCardId:t.dataset.aid,questionId:t.dataset.qid,hasComment:t.dataset.comment?1:0,hasPicture:n.length>0?1:0,hasVideo:o.length>0?1:0,actionType:e})}function Wa(e,t=100){if(e)return e.replace(/\n|\r|\t/g," ").replace(/"|'/g,"").slice(0,t)}function Ha(){if(!qa||!qa.length)return;const e={count:qa.length,type:[],username:[],aid:[],qid:[]};qa.forEach((t=>{const{usertype:i,username:n,aid:o,qid:a}=t.dataset;e.type.push(i),e.username.push(n),e.aid.push(o),e.qid.push(a)})),K({type:"POST",url:"/mp/zhuge_appmsg?action=get_answer_info",data:e,dataType:"json",timeout:3e3,success:e=>{if(e&&e.base_resp&&-1!==e.base_resp.ret){const t=e.answer_list;if(t&&Array.isArray(t)){const e=t.map((e=>{var t,i,n,o,a,s,r,c,d,l,p,m;const _=null==(i=null==(t=e.answer_content)?void 0:t.video_list)?void 0:i.map((e=>null==e?void 0:e.media_info));let u="";(null==(n=e.answer_content)?void 0:n.text)&&(u=Wa(e.answer_content.text,350));let w="";if(null==(a=null==(o=e.answer_top_comment)?void 0:o.content)?void 0:a.text){const t=Wa(e.answer_top_comment.content.text,100),i=e.answer_top_comment.nickname;t&&(w="".concat(i,"：").concat(t))}return{question_text:e.question_text,state:e.answer_content.state,usertype:e.type,like_count:e.like_count||0,forward_count:e.forward_count||0,comment_count:e.comment_count||0,username:null==(s=e.user_info)?void 0:s.username,nickname:null==(r=e.user_info)?void 0:r.nickname,headimg_url:null==(c=e.user_info)?void 0:c.headimg_url,aid:null==(d=e.answer_content)?void 0:d.aid,qid:null==(l=e.answer_content)?void 0:l.qid,content_text:u,content_type:null==(p=e.answer_content)?void 0:p.type,picture_list:null==(m=e.answer_content)?void 0:m.picture_list,video_list:_,comment:w}}));qa.forEach(((t,i)=>{const n=e[i].state;4!==n?(2===n?t.dataset.message="回答仍在审核中":8===n?t.dataset.message="回答审核不通过":64===n&&(t.dataset.message="回答已删除"),t.dataset.status=2):(t.dataset.like_count=e[i].like_count,t.dataset.forward_count=e[i].forward_count,t.dataset.comment_count=e[i].comment_count,t.dataset.comment=e[i].comment,t.classList.add("js_wx_tap_highlight"))}))}}},complete:()=>{qa.forEach((e=>{1===Number(e.dataset.status)&&(e.dataset.status=0)}))}})}function Ua(){Ha(),function(){for(const e of qa)pe.tap(e,(function(){var t;Ma(za.CLICK,e),2!==Number(e.dataset.status)&&(Da.isWechat?ae.invoke("openLiteApp",{appId:"wxalite2fd372f050eecd471a4392786dfae78c",page:"pages/question/entry",query:{qid:e.dataset.qid,aid:e.dataset.aid,scene:7,sceneNote:"".concat(window.atob(window.biz),"_").concat(window.mid,"_").concat(window.idx)}},(e=>{console.log("open w1w",e)})):(t="请在手机微信端打开",setTimeout((function(){window.weui?window.weui.alert(t):window.alert(t)}),0)))}))}(),function(){let e=null;e=new IntersectionObserver((function(t,i){t.forEach((t=>{if(t.isIntersecting){const i=t.target;Ma(za.EXPOSE,i),e.unobserve(i)}}))}),{threshold:0}),qa.forEach((t=>{e.observe(t)}))}()}const Fa={tagName:"mp-common-product",CHANNEL_PRODUCT_DOMAIN:"https://mp.weixin.qq.com",isWechat:(oe.isAndroid||oe.isIOS)&&oe.isWechat&&!oe.isWxWork&&!oe.isNewMpApp,exposureInit:!1};function Ja(e,t,i,n){try{e.postMessage(JSON.stringify({action:t,value:i}),n||"*")}catch(o){console.log("postMessage error",o)}}const Va=document.querySelectorAll(Fa.tagName);function Xa(e){setTimeout((function(){window.weui&&window.weui.alert(e)}),0)}function $a(e,t,i){if(e){if(i){i.parentNode.style.margin="0 auto 24px";const e={compEle:i,compType:"channelProduct",compIdx:Array.from(document.querySelectorAll("mp-common-product")).indexOf(i)};de.renderCompSilentlyPreHandler(e),et(i,i.getAttribute("data-windowproduct")),de.renderCompSilently(e)}Ja(e,"setPageData",{darkMode:window.matchMedia("(prefers-color-scheme: dark)").matches}),function(){if(Fa.exposureInit)return;Fa.exposureInit=!0;let e=null;e=new IntersectionObserver((function(t,i){t.forEach((t=>{if(t.isIntersecting){const n=t.target;try{const t=n.shadowRoot.querySelector("iframe");t&&t.contentWindow&&(Ja(t.contentWindow,"webEvent",{type:"expose"}),e.unobserve(n))}catch(i){console.error(i)}}}))}),{threshold:1}),Va.forEach((t=>{e.observe(t)}))}()}}function Ga(e,t){Fa.isWechat?ae.invoke("openFinderProduct",t,(t=>{-1===t.err_msg.indexOf(":ok")&&ae.invoke("confirmDialog",{title:"请更新至微信最新版本再打开",confirmText:"去更新",cancelText:"取消"},(e=>{if(-1!==e.err_msg.indexOf(":ok")){const e="https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1",t="https://support.weixin.qq.com/update/";location.href=oe.isIOS?e:t}else-1!==e.err_msg.indexOf("system:")&&Xa("请更新至微信最新版本再打开")})),function(e,t,i){Ja(e,"openWeAppCallback",{data:t},i||"*")}(e,t)})):Xa("请在微信手机端打开")}ae.on("menu:setfont",se.debounce((e=>{for(let t of Va){const i=t.shadowRoot.querySelector("iframe");i&&i.contentWindow&&Ja(i.contentWindow,"setPageData",{fontSize:e.fontSize||"1"})}}),100));const Ka="/mp/c_psmaterial_info?action=get_windowproduct";function Qa(e,t){const i={base_req:{action:e},ext_info:JSON.stringify(t)};return{data:JSON.stringify(i)}}function Ya(){if(Va.length){const e=Y.getQuery("ecsource"),t=Y.getQuery("exportkey");Va.forEach((i=>{e&&i.setAttribute("data-ecsource",e),t&&i.setAttribute("data-exportkey",t)})),K({type:"POST",url:Ka,timeout:5e3,dataType:"json",data:Qa("GenWxaEcSource",{share_scene:6}),success:function(e){const{ret:t,extInfo:i}=function(e){const t=e&&e.base_resp&&e.base_resp.ret;let i={};if(e.ext_info)try{i=JSON.parse(e.ext_info)}catch(n){console.error(n)}return{ret:t,extInfo:i}}(e);i.ec_source&&(window.ecsource=e.ec_source)},error(){console.log("[error]")}})}}const Za={init:function(){Ya(),window.addEventListener("message",(e=>{const{iframeEle:t,productEle:i}=function(e){let t,i;for(let n=0;n<Va.length;n++)if(t=Va[n].shadowRoot.querySelector("iframe"),t&&t.contentWindow===e){i=Va[n];break}return{iframeEle:t,productEle:i}}(e.source);if(e.origin===Fa.CHANNEL_PRODUCT_DOMAIN&&i&&t)try{const{action:n,value:o}=JSON.parse(e.data);if(!n)return;const a=t.contentWindow;switch(n){case"changeFrameStyle":!function(e,t,i){if(e&&t&&i&&"object"==typeof i)try{const n={compEle:t,compType:"channelProduct",subCompType:"cardHeight",compIdx:Array.from(document.querySelectorAll("mp-common-product")).indexOf(t)};for(let t of Object.keys(i))"height"===t&&de.renderCompSilentlyPreHandler(n),e.style[t]=i[t],"height"===t&&de.renderCompSilently(n)}catch(n){console.error(n)}}(t,i,o);break;case"onFrameReady":$a(a,0,i);break;case"openWeapp":Ga(a,o);break;case"report":!function(e){if(!e)return;const{logid:t,data:i}=e;K({type:"POST",url:Ka,timeout:5e3,dataType:"json",data:Qa("ReportMMData23782",{...i}),success:function(e){},error(){console.log("[error]")}})}(o)}}catch(n){console.error(n)}}))}};function es(){window.addEventListener&&window.addEventListener("load",(function(){window.__moonsafe_mutation_report_keys||(window.__moonsafe_mutation_report_keys={});let e=window.moon&&moon.moonsafe_id||29715,t=window.moon&&moon.moonsafe_key||0,i=[],n={},o=function(e,t,o){o=o||1,n[e]||(n[e]=0),n[e]+=o,t&&(!function(e){return"[object Array]"==Object.prototype.toString.call(e)}(t)?i.push(t):i=i.concat(t)),setTimeout((function(){a()}),1500)},a=function(){let o=[],s=i.length,r=["r="+Math.random()];for(let i in n)n.hasOwnProperty(i)&&o.push(e+"_"+(1*i+1*t)+"_"+n[i]);for(let e=0;e<s&&!(e>=10);++e)r.push("log"+e+"="+encodeURIComponent(i[e]));if(0==o.length&&r.length<=1)return;let c,d="idkey="+o.join(";")+"&lc="+(r.length-1)+"&"+r.join("&");if(window.ActiveXObject)try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(ps){try{c=new ActiveXObject("Microsoft.XMLHTTP")}catch(l){c=!1}}else window.XMLHttpRequest&&(c=new XMLHttpRequest);c&&(c.open("POST",location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?",!0),c.setRequestHeader("cache-control","no-cache"),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.onreadystatechange=function(){4===c.readyState&&(i.length>10?(i=i.slice(10),a()):(i=[],n={}))},i=[],n={},c.send(d))};try{if(!window.__observer)return;let e=window.__observer_data;if(window.__observer.takeRecords){let t=window.__observer.takeRecords();if(t&&t.length){e.count++;let i=new Date;t.forEach((function(t){let i=t.addedNodes;for(let n=0;n<i.length;n++){let t=i[n];if("SCRIPT"===t.tagName){let i=t.src;!i||/qq\.com/.test(i)||/weishi\.com/.test(i)||e.list.push(i)}}})),e.exec_time+=new Date-i}}window.__observer.disconnect();let t=window.__moonsafe_mutation_report_keys.observer||2,i=window.__moonsafe_mutation_report_keys.script_src||8,n=window.__moonsafe_mutation_report_keys.setattribute||9,a=window.__moonsafe_mutation_report_keys.ajax||10,s=25;for(let c=0;c<e.list.length;c++){let i=e.list[c],n=["[moonsafe][observer][url]:"+location.href,"[moonsafe][observer][src]:"+i,"[moonsafe][observer][ua]:"+navigator.userAgent];e.list.length==c+1&&(n.push("[moonsafe][observer][count]:"+e.count),n.push("[moonsafe][observer][exec_time]:"+e.exec_time+"ms")),o(t,n),"inlinescript_without_nonce"==i&&o(s,n)}let r=window.__danger_src;if(r){let e=[{key:"xmlhttprequest",idkey:a},{key:"script_src",idkey:i},{key:"script_setAttribute",idkey:n}];for(let t=0;t<e.length;t++){let i=e[t].key,n=r[i];if(n&&n.length)for(let a=0;a<n.length;a++){let s=["[moonsafe]["+i+"][url]:"+location.href,"[moonsafe]["+i+"][src]:"+n[a],"[moonsafe]["+i+"][ua]:"+navigator.userAgent];o(e[t].idkey,s)}}}}catch(ps){o(3,["[moonsafe][observer][exception]:"+ps])}}),!1)}if(window.localStorage&&window.localStorage.getItem){const e=4500,t="loadSec-"+window.biz+"-"+window.mid+"-"+window.idx;let i=window.localStorage.getItem(t);i&&window.write_sceen_time-parseInt(i,10)>e&&(ue.report(20801,{Bizuin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,Url:window.msg_source_url||"",Title:window.msg_title||""}),window.localStorage.removeItem(t))}const ts=function(){let e=window.location.href.split("?")[1];if(e){let t=e.split("&");for(let e=0;e<t.length;e++){const[i,n]=t[e].split("=");if("imageIndex"===i)return parseInt(n,10)}return""}return""}();function is(e){return e&&e.getBoundingClientRect?e.getBoundingClientRect().top+function(){let e=0;return void 0!==window.pageXOffset?e=window.pageXOffset:void 0!==document.compatMode&&"BackCompat"!==document.compatMode?e=document.documentElement.scrollTop:void 0!==document.body&&(e=document.body.scrollTop),e}():0}function ns(){if(""===ts)return;const e=function(){const e=[],t=document.getElementsByTagName("img");for(let i=0,n=t.length;i<n;i++){const n=t.item(i);n.getAttribute("data-src")&&e.push(n)}return e}();if(ts>e.length)return;const t=is(e[ts]);window.scroll(0,t)}function os(){let e=!1,t=window.performance||window.msPerformance||window.webkitPerformance;if(!(t&&t.timing&&t.timing.navigationStart))return!1;e=t.timing.navigationStart,function(){let t=window.performance&&window.performance.timing,i=window.write_sceen_time-e,n=window.first_sceen__time-e,o=window.page_endtime-e,a=(window.onload_endtime||+new Date)-e;-1!=navigator.userAgent.indexOf("MicroMessenger")&&(i=real_show_page_time-e,n=real_show_page_time-e);let s=window.logs.jsapi_ready_time?window.logs.jsapi_ready_time-e:void 0,r=window.logs.a8key_ready_time?window.logs.a8key_ready_time-e:void 0,c=t&&t.connectEnd-t.connectStart,d=t&&t.secureConnectionStart&&t.connectEnd-t.secureConnectionStart,l=t&&t.domainLookupEnd&&t.domainLookupStart&&t.domainLookupEnd-t.domainLookupStart;if(window.logs.pagetime.wtime=i,window.logs.pagetime.ftime=n,window.logs.pagetime.ptime=o,window.logs.pagetime.onload_time=a,window.logs.pagetime.jsapi_ready_time=s,window.logs.pagetime.a8key_ready_time=r,need_report_cost?K({url:"/mp/report_cost",type:"post",data:{id_key_list:["1|1|"+o,"1|2|"+n,"1|3|"+a,"1|4|"+s,"1|5|"+r,"1|6|"+c,"1|7|"+d,"1|8|"+l].join(";")}}):Math.random()<.01&&K({url:"/mp/report_cost",type:"post",data:{id_key_list:["#1|1|"+o,"1|2|"+n,"1|3|"+a,"1|4|"+s,"1|5|"+r,"1|6|"+c,"1|7|"+d,"1|8|"+l].join(";")}}),need_report_cost&&n>3e3){let e=new Image,t=(new Date).getTime();e.onload=function(){let e=(new Date).getTime()-t,i=(new Date).getTime(),n=new Image;n.onload=function(){let t=(new Date).getTime()-i;K({url:"/mp/report_cost",type:"post",data:{id_key_list:["^2|1|"+e,"2|2|"+t].join(";")}})},n.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()},e.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()}function p(){if(-1==navigator.userAgent.indexOf("NetType/"))return!1;let e=["2G","cmwap","cmnet","uninet","uniwap","ctwap","ctnet"];for(let t=0,i=e.length;t<i;++t)if(-1!=navigator.userAgent.indexOf(e[t]))return!0;return!1}Math.random()>.2||a<0||i<0||n<0||o<0||(s&&ee.setAvg(27822,15,s),r&&ee.setAvg(27822,17,r),o>=15e3?ee.setAvg(27822,29,o):(ee.setAvg(27822,1,o).setAvg(27822,3,a).setAvg(27822,5,n),window.isWeixinCached&&ee.setAvg(27822,19,o),p()?(ee.setAvg(27822,9,o),window.isWeixinCached&&ee.setAvg(27822,23,o)):"wifi"==networkType?(ee.setAvg(27822,7,o),window.isWeixinCached&&ee.setAvg(27822,21,o)):"2g/3g"==networkType?(ee.setAvg(27822,11,o),window.isWeixinCached&&ee.setAvg(27822,25,o)):"4g"==networkType?(ee.setAvg(27822,14,o),window.isWeixinCached&&ee.setAvg(27822,26,o)):(ee.setAvg(27822,13,o),window.isWeixinCached&&ee.setAvg(27822,28,o)),window.moon&&moon.clearSample&&(ee.setAvg(27822,71,o),p()?ee.setAvg(27822,73,o):"wifi"==networkType?ee.setAvg(27822,75,o):"2g/3g"==networkType?ee.setAvg(27822,77,o):"4g"==networkType?ee.setAvg(27822,78,o):ee.setAvg(27822,79,o)),c&&ee.setAvg(27822,65,c),d&&ee.setAvg(27822,67,d),l&&ee.setAvg(27822,69,l)))}(),window.logs.jsapi_ready_fail&&ee.setSum(24729,55,window.logs.jsapi_ready_fail),function(){const e=document.getElementById("page-content");if(!e||Math.random()>.1)return;const i=function(){const n=document.getElementById("js_content_end"),o=window.pageYOffset||document.documentElement.scrollTop,a=n.offsetTop;if(o+_e.getInnerHeight()>=a){let n,o,a=e.getElementsByTagName("img"),s={},r=[],c=0,d=0,l=0;for(let e=0,t=a.length;e<t;++e){let t=a[e];n=t.getAttribute("data-src")||t.getAttribute("src"),o=t.getAttribute("src"),n&&(n.isCDN()?d++:l++,c++,s[o]={})}if(r.push("1="+1e3*c),r.push("2="+1e3*d),r.push("3="+1e3*l),t.getEntries){let e=t.getEntries(),i=window.logs&&window.logs.img&&window.logs.img.download;if(!i)return;let n=[0,0,0],o=[0,0,0];c=d=0;for(let t=0,r=e.length;t<r;++t){let i=e[t],a=i.name;a&&"img"==i.initiatorType&&s[a]&&(a.isCDN()&&(o[0]+=i.duration,d++),n[0]+=i.duration,c++,s[a]={startTime:i.startTime,responseEnd:i.responseEnd})}n[0]>0&&c>0&&(n[2]=n[0]/c),o[0]>0&&d>0&&(o[2]=o[0]/d);for(let t in i)if(i.hasOwnProperty(t)){let e=i[t],a=0,r=0,c=0,d=0;for(let t=0,i=e.length;t<i;++t){let i=e[t];if(s[i]&&s[i].startTime&&s[i].responseEnd){let e=s[i].startTime,t=s[i].responseEnd;a=Math.max(a,t),r=r?Math.min(r,e):e,i.isCDN()&&(c=Math.max(a,t),d=r?Math.min(r,e):e)}}n[1]+=Math.round(a-r),o[1]+=Math.round(c-d)}let a=4,l=7;for(let t=0;t<3;t++)n[t]=Math.round(n[t]),o[t]=Math.round(o[t]),n[t]>0&&(r.push(a+t+"="+n[t]),"wifi"==networkType?r.push(a+t+6+"="+n[t]):"2g/3g"!=networkType&&"4g"!=networkType||r.push(a+t+12+"="+n[t])),o[t]>0&&(r.push(l+t+"="+o[t]),"wifi"==networkType?r.push(l+t+6+"="+o[t]):"2g/3g"!=networkType&&"4g"!=networkType||r.push(l+t+12+"="+o[t]))}pe.off(window,"scroll",i,!1)}};pe.on(window,"scroll",i,!1)}(),function(){if(Math.random()>.001)return;const e=document.createElement("iframe"),t=Math.ceil(10*Math.random())-1,i=uin+mid+idx+Math.ceil(1e3*Math.random())+(new Date).getTime();e.style.display="none",e.id="js_ajax",e.setAttribute("data-time",t),e.src="/mp/iframetest?action=page&traceid="+i+"&devicetype="+devicetype+"&timeout="+[600,800,1e3,1200,1500,2e3,3e3,5e3,1e4,18e3][t];document.getElementById("js_article").appendChild(e)}()}""!==ts&&"scrollRestoration"in history&&(history.scrollRestoration="manual"),"loading"!==document.readyState?ns():window.addEventListener("DOMContentLoaded",(function(){ns()})),pe.on(window,"load",(function(){if(""==networkType&&window.isInWeixinApp()){let e={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};JSAPI.invoke("getNetworkType",{},(function(t){networkType=e[t.err_msg],"network_type:edge"!=t.err_msg&&"network_type:wwan"!=t.err_msg||(t.detailtype&&"4g"==t.detailtype||t.subtype&&"4g"==t.subtype)&&(networkType="4g"),os()}))}else os()}),!1),window.page_endtime=+new Date;const as="https://mp.weixin.qq.com/s/bpYquVzmjFzY_IrmCsxniQ",ss=oe.isWp||oe.isIOS||oe.isAndroid;const rs=Ee({components:{[w.name]:w},data:()=>({isNavShow:!0}),mounted(){document.addEventListener("visibilitychange",(()=>{var e;!this.isNavShow&&!document.hidden&&(null==(e=this.secControl)?void 0:e.ad_violation_middle_page)>0&&(this.isNavShow=!0,i.hide(),i.show({alpha:.6}))}))},computed:{...m({secControl:e=>e.extRes.sec_control})},watch:{secControl:{handler(e){(null==e?void 0:e.ad_violation_middle_page)>0&&this.$nextTick((()=>{ss?this.show():(document.body.parentNode.style.overflow="hidden",window.weui.dialog({content:"当前内容可能存在未经审核的第三方商业营销信息，请确认是否继续访问。",buttons:[{label:"继续访问",type:"default",onClick:()=>{this.report(1),document.body.parentNode.style.overflow="auto"}},{label:"取消",type:"primary",onClick:()=>{this.closePage()}}],isAndroid:oe.isAndroid}))}))},immediate:!0}},methods:{show(){this.$refs.bottomModal.show()},hide(){this.report(1),this.$refs.bottomModal.hide(),this.isNavShow&&i.hide()},closePage(){this.report(2),oe.isWechat?ae.invoke("closeWindow",(e=>{-1===e.err_msg.indexOf("ok")&&(window.close(),window.open("about:blank","_top").close())})):(window.close(),window.open("about:blank","_top").close())},onTermClick(e){e.preventDefault(),"A"===e.target.tagName&&(oe.isWechat?ae.invoke("openUrlWithExtraWebview",{url:as,openType:1},(e=>{-1===e.err_msg.indexOf("ok")?location.href=as:this.isNavShow=!1})):location.href=as)},report(e){ue.report(30608,{action:e,scene:1,url:location.href,mid:1*window.mid||0,idx:1*window.idx||0,bizuin:1*window.atob(window.biz)||0})}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"auto-height":"","has-header":!1,"hide-when-mask-click":!1},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"weui-half-screen-dialog__btn-area"},[t("a",{staticClass:"weui-btn weui-btn_default",attrs:{href:"javascript:","wah-hotarea":"click"},on:{click:e.hide}},[e._v("继续访问")]),t("a",{staticClass:"weui-btn weui-btn_primary",attrs:{href:"javascript:","wah-hotarea":"click"},on:{click:e.closePage}},[e._v("取消")])]),t("div",{staticClass:"weui-half-screen-dialog__attachment-area",on:{click:e.onTermClick}},[t("a",{staticClass:"weui-link",attrs:{href:"javacript:;"}},[e._v("微信公众平台广告规范指引")])])]},proxy:!0}])},[t("p",{staticClass:"ad_control-tips"},[e._v("当前内容可能存在未经审核的第三方商业营销信息，请确认是否继续访问。")])])}),[],!1,null,"f8e61417",null,null).exports,cs=2===window.show_version&&!Q.os.pc&&!oe.isNewMpApp&&document.querySelector("#article_bottom_bar_area");L(y),cs&&Qe(y,jn);try{Q.os.ios&&Q.os.getNumVersion()>=16&&(ee.setSum(110809,78,1),Q.isLockdownMode()&&ee.setSum(110809,79,1)),window.customElements?ee.setSum(110809,70,1):ee.setSum(110809,71,1),document.head.createShadowRoot||document.head.attachShadow?ee.setSum(110809,72,1):ee.setSum(110809,73,1)}catch(ms){console.log(ms)}Ae.setGvar({payType:0,pageType:0,albumId:window.appmsg_album_info.id||""}),t.config.errorHandler=(e,t,i)=>{e._info=i,window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.onError(e),console.error("Vue errorHandler",i,e)},console.info("[图文信息] 三元组:",window.biz,window.mid,window.idx),console.info("[用户信息] 设备信息: 是否安卓",Q.os.android,"是否IOS",Q.os.ios,"是否秒开场景",window.__second_open__,"系统版本",Q.os.version,"用户uin",window.user_uin,"是否小程序内打开",oe.isInMiniProgram),window.__immersiveListMode&&ae.invoke("disableBounceScroll",{place:["top","bottom"]}),P.initHtmlMinHeight(),window.__second_open__||window.ext_complete||G.setExtLoadDom(),le.on("ext-complete",(()=>{window.requestAnimationFrame(G.removeExtLoadDom)})),le.on("interact-ext-complete",(()=>{window.requestAnimationFrame(G.removeExtLoadDom)}));let ds=-1,ls=!1;if(window.logs.pagetime.jsapi_ready_time=+new Date,window.logs.idkeys={},Z.log("[Appmsg] start run index.js init"),function(){let e=(new Date).getHours(),t=function(e,t){t=t||"",window.isSg?(t=["uin:sougou","resp:"+t].join("|"),(new Image).src="/mp/jsreport?key="+e+"&content="+t+"&r="+Math.random()+"&from=sougou"):(t=["uin:"+window.user_uin,"resp:"+t].join("|"),(new Image).src="/mp/jsreport?key="+e+"&content="+t+"&r="+Math.random())},i=e>=11&&e<=17&&Math.random()<1;window.__report=t,window.__commonVideoReport=function(e,n){i&&t(e,n)},window.__addIdKeyReport=function(e,t,i){let n=e+"_"+t;i=i||1,window.logs.idkeys[n]||(window.logs.idkeys[n]={val:0}),window.logs.idkeys[n].val+=i}}(),_e.initWebCompt(["wxOpen"],(e=>{window.__is_support_wxOpen=e.err_msg&&e.err_msg.indexOf(":ok")>-1,(document.getElementsByTagName("mpsubscribe")&&document.getElementsByTagName("mpsubscribe").length||document.getElementsByTagName("mp-common-subscribe")&&document.getElementsByTagName("mp-common-subscribe").length)&&la()})),function(){setTimeout((()=>{let e=document.getElementsByClassName("wx-edui-video_source_link");e=Array.prototype.slice.call(e),e.forEach((e=>{e&&e.addEventListener("click",(()=>{const t=e.dataset.hitUsername,i=e.dataset.hitBiz;se.goProfile({biz:i},{username:t})}))}))}),500);let e=!1;if((()=>{try{const t=_e.getParam("anchor_list");let i=!1;if(t&&2!==window.copyright_stat){e=!0;const n=document.getElementById("js_content"),o=Ce(n,{ignoreNotWriteableChildren:!0});let a=decodeURIComponent(t).split("#");for(let e=0;e<a.length;e++){let t=a[e].split(",");if(t&&3===t.length){let e=o[t[0]],n=1*t[1],a=1*t[2];window.__addIdKeyReport("306353","3");const s=je(e,n,a);i||(window.__addIdKeyReport("306353","1"),window.scrollTo(0,s.getBoundingClientRect().top+_e.getScrollTop()-68),i=!0)}}}}catch(t){window.__addIdKeyReport("306353","2"),console.error(t)}})(),function(){if(window.is_teenager)return void ee.setSum(286024,0,1);const e=document.getElementsByTagName("mpcps");e.length>0&&D.getCpsData(e)}(),Za.init(),window.is_new_msg&&-1!=navigator.userAgent.indexOf("MicroMessenger")){window.title&&(window.title=window.title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),window.msg_title&&(window.msg_title=window.msg_title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),hd_head_img||a.jsmonitor({id:115849,key:26,value:1}),cs&&$(!1);const e=document.querySelectorAll("mp-common-product, mp-common-videosnap");let t={userName:window.user_name,bizNickName:window.nickname,bizNickNameBackup:window.title,cover:"",title:window.msg_title,headImg:window.hd_head_img,roundHeadImg:window.round_head_img,digest:window.msg_desc,reportData:{BizUin:window.biz,AppMsgID:1*window.mid,ItemIndex:1*window.idx,Scene:1*window.source,SubScene:1*window.subscene,EnterId:1*window.enterid,SessionId:window.sessionid,ItemShowType:1*window.item_show_type},hasFinderElement:e.length>0?1:0,canReadArticle:!window.tempkey&&window.tts_is_show&&tt(document.querySelector("#js_content"))>300};if(oe.isAndroid){t.cover="",X.init(t);let e=window.cdn_url_1_1||window.cdn_url_235_1||"",i=new Image;e&&(i.src=e,i.onload=()=>{i.width<2048&&i.height<2048&&(t.cover=e,X.init(t)),window.topbarInited=!0},i.onerror=()=>{window.topbarInited=!0})}else t.cover=window.cdn_url_1_1||window.cdn_url_235_1||window.msg_cdn_url,X.init(t);pe.on(window,"scroll",(()=>{ls||oe.isAndroid&&!window.topbarInited||(Se(0),ls=!0)})),ae.invoke("createWebViewForFastLoad",{scene:1},(function(e){console.log(e)}))}let i=document.getElementsByTagName("body");if(!i||!i[0])return!1;i=i[0];(function(){let e=[],t=document.getElementById("js_content").getElementsByTagName("a");for(let s=0;s<t.length;s++)null!==t[s].getAttribute("data-itemshowtype")&&e.push(t[s]);let i=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("h5_image_link"),(function(e){e.parentNode.getAttribute("href")&&e.parentNode.getAttribute("href").length>0&&i.push(e)}));let n=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("weapp_image_link"),(function(e){n.push(e)}));let o=window.innerHeight||document.documentElement.clientHeight;function a(){!function(){if(e.length){let t=document.documentElement.scrollTop||document.body.scrollTop;for(let i=0;i<e.length;i++)if(1!=e[i].getAttribute("hasload")){let n=e[i].getBoundingClientRect();(n.top<o+t&&n.top>t||n.top+n.height>t&&n.top+n.height<o+t)&&e[i].getAttribute("href").length>0&&(e[i].setAttribute("hasload",1),ae.invoke("downloadPageDataForFastLoad",{itemList:[{item_show_type:e[i].getAttribute("data-itemshowtype"),url:e[i].getAttribute("href")}]},(function(e){console.log(e)})),e.splice(i,1),i--)}}}(),function(){for(let e=0;e<i.length;e++){let t=i[e],n=t.getBoundingClientRect();(n.top<=0&&n.top+n.height>=0||n.top>0&&n.top<o)&&(i.splice(e,1),e--,V.report([1,V.getRedirectType(t.parentNode.getAttribute("href")),"",window.img_popup?1:0,window.source,V.getUrlData(t.parentNode.getAttribute("href"))]))}for(let e=0;e<n.length;e++){let t=n[e],i=t.getBoundingClientRect();(i.top<=0&&i.top+i.height>=0||i.top>0&&i.top<o)&&(n.splice(e,1),e--,V.report([1,1,"",window.img_popup?1:0,window.source,t.getAttribute("data-miniprogram-appid")]))}}()}pe.on(window,"scroll",a),a()})(),(()=>{const e=document.querySelector("#js_ting_heard");if(e){new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&(t.unobserve(e.target),X.topbarReport(4),ee.setSum(293511,4,1))}))}),{threshold:.5}).observe(e),pe.on(e,"click",(function(e){X.topbarReport(5),ee.setSum(293511,5,1);const t={openPlayerUI:!0,itemList:[{type:2,startTime:0,duration:123,srcId:location.href,title:window.msg_title||"",webUrl:window.msg_link||location.href,author:window.nickname||window.cgiData.nick_name||"",cover:window.cdn_url_1_1||window.__appmsgCgiData.hd_head_img||"",mpInfo:{username:window.user_name||"",name:window.nickname||window.cgiData.nick_name||"",bizUin:parseInt(window.atob(window.biz)),webUrl:window.msg_link||location.href}}]};console.log("+++++++++++++++ tingReadOpt",t),ae.invoke("setTingAudioState",t,(function(e){console.log("+++++++++++++++ tingReadRes",e),-1===e.err_msg.indexOf("ok")&&(window.weui.alert("暂无法朗读，请重试"),ee.setSum(293511,6,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("t1t read fail","res: ".concat(JSON.stringify(e)," | url: ").concat(location.href),{mid:"mmbizwap:t1t_read_fail",view:"wap_business"}))}))}))}})(),(()=>{try{if(anchor_tree_msg){const e=Date.now(),t=document.getElementById("js_content"),i=anchor_tree_msg?JSON.parse(anchor_tree_msg).anchor_tree:[],n=window.location.protocol;ji.init(t,i),a.saveSpeeds({sample:1,uin:uin,pid:"https:"==n?462:417,speeds:{sid:38,time:Date.now()-e}}),a.send()}}catch(e){"undefined"!=typeof WX_BJ_REPORT&&WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.onError(e,{anchor_tree_msg:anchor_tree_msg})}})();let n=/^http(s)?:\/\/mp\.weixin\.qq\.com\//g;try{if(top!=window&&(!top||top&&location.href&&n.test(location.href))&&!window.isSg)throw new Error("in iframe")}catch(ps){let t="";(new Image).src=("http://mp.weixin.qq.com/mp/jsreport?key=4&content=biz:"+biz+",mid:"+mid+",uin:"+uin+"[key4]"+t+"&r="+Math.random()).substr(0,1024)}if(window.isInWeixinApp()&&/#rd$/.test(location.href)&&!window.isWeixinCached&&!window.__second_open__&&!oe.isWxWork){let e=-1!=location.href.indexOf("?")?"&":"?";location.replace(location.href.replace(/#rd$/,e+"rd2werd=1#wechat_redirect"))}const r=!oe.isWp&&-1==navigator.userAgent.indexOf("MicroMessenger");window.__review_image__=!r||oe.isNewMpApp||/wxwork\/([\d.]+)/i.test(navigator.userAgent)?new ke({isHttpsRes:is_https_res}):null;const c=!isNaN(parseInt(ie("start")))&&!isNaN(parseInt(ie("end")));if(function(){const e=document.getElementById("js_content");let t=!1;const i=e.getElementsByTagName("img");for(let n=0,o=i.length;n<o;n++){const e=i[n].getAttribute("data-src");if(e&&e.canHevc()){t=!0;break}}if(!t){const i=e.querySelectorAll("[data-lazy-bgimg]");for(let e=0,n=i.length;e<n;e++){const n=i[e].getAttribute("data-lazy-bgimg");if(n&&n.canHevc()){t=!0;break}}}t?Me((e=>{Gn(e,!1)})):Gn(!1,!1),We()}(),window.__review_image__){const e=document.getElementById("js_cover");window.__review_image__.add({container:document.getElementById("js_content"),imgs:e?[e]:[]})}q(),new t({store:y,render:e=>e(Rn)}).$mount("#content_bottom_area"),new t({store:y,render:e=>e(Jn)}).$mount("#page_bottom_area"),z(y),new t({store:y,render:e=>e(rs)}).$mount("#js_ad_control"),function(){let e=document.getElementById("profileBt"),t=document.getElementById("copyright_info"),i=[];if(e){let t="57";"28"==window.source&&(t="96"),"31"===window.source&&(t="103"),"30"===window.source&&(t="102"),"29"==window.source&&(t="39"),"15"==window.source&&(t="121"),i.push({dom:e,username:user_name,profileReportInfo:window.profileReportInfo||"",scene:t})}t&&source_encode_biz&&i.push({dom:t,source_encode_biz:source_encode_biz,scene:"161"});for(let n=0,o=i.length;n<o;n++)!function(e){pe.on(e.dom,"click",(function(t){if("copyright_info"==e.dom.id&&source_encode_biz)Di.card_click_report({scene:"0"}),se.goProfile({biz:e.source_encode_biz,scene:e.scene},{username:source_username,scene:e.scene+""});else{if(Z.log("[Appmsg] profile_click_before_loadprofile: username:"+e.username+", scene:"+e.scene),re.profileReport({hotspotjson:JSON.stringify({hotspotinfolist:window.hotspotInfoList})}),profileReportInfo){let e=String(profileReportInfo).split("_");3==e.length&&K({url:"/mp/ad_biz_info?action=report&__biz="+window.biz+"&report_type=2&aid="+e[1]+"&tid="+e[2],type:"GET",dataType:"json",async:!0,success:function(e){}})}oe.isWxWork&&(oe.isIOS||oe.isAndroid)?ce():1==isprofileblock?ae.invoke("openUrlWithExtraWebview",{url:"https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect",openType:1},(function(e){-1==e.err_msg.indexOf("ok")&&(location.href="https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect")})):ae.invoke("profile",{username:e.username,profileReportInfo:e.profileReportInfo||"",scene:e.scene+"",bizuin:1*window.atob(window.biz)||0},(function(t){window.__addIdKeyReport("28307","1"),Z.log("[Appmsg] profile_click_after_loadprofile: username:"+e.username+", scene:"+e.scene+", profileReportInfo:"+e.profileReportInfo+", res.err_msg:"+t.err_msg)}))}t.preventDefault()})),oe.isWp&&e.dom.setAttribute("href","weixin://profile/"+e.username)}(i[n])}(),function(){function e(){let e=function(){if("hidden"in document)return"hidden";let e=["webkit","moz","ms","o"];for(let t=0;t<e.length;t++)return e[t]+"Hidden";return null}();return!!e&&document[e]}function t(t){if(e())for(let e=0;e<window.originalVideoAdFrames.length;e++)window.originalVideoAdFrames[e].contentWindow.postMessage({action:"pauseAd",value:""},"*");else window.originalVideoAdCurrentFrame&&window.originalVideoAdCurrentFrame.contentWindow.postMessage({action:"playAd"},"*")}document.webkitVisibilityState?document.addEventListener("webkitvisibilitychange",t,!1):document.msVisibilityState?document.addEventListener("msvisibilitychange",t,!1):document.visibilityState&&document.addEventListener("visibilitychange",t,!1)}();try{let e=document.getElementById("js_author_name");if(e){let t="";pe.on(e,"click",(function(i){return!!ne.hasClass(e,"rich_media_meta_link")&&(window.is_temp_url?(window.weui.alert("预览状态下不能操作"),!1):!!e.getAttribute("data-rewardsn")&&(1==e.getAttribute("data-canreward")&&(t="https://mp.weixin.qq.com/mp/author?action=show&author_id="+author_id+"&rewardsn="+e.getAttribute("data-rewardsn")+"&timestamp="+e.getAttribute("data-timestamp")+"&__biz="+window.biz+"&appmsgid="+window.appmsgid+"&idx="+window.idx+"&scene=142&rscene=129&from_scene="+window.source+"&from_subscene="+window.subscene+"&from_enterid="+window.enterid+"&from_sessionid="+window.sessionid+"&is_fans="+window.isFans+"#wechat_redirect",!oe.isInMiniProgram&&void(-1!=navigator.userAgent.indexOf("MicroMessenger")&&(oe.isIOS||oe.isAndroid||oe.isWp)?(window.__addIdKeyReport("110809","1"),ae.invoke("openUrlWithExtraWebview",{url:t,openType:1},(function(e){-1==e.err_msg.indexOf("ok")&&(location.href=t)}))):window.open(t)))))}))}}catch(ps){}new ye({container:document.getElementById("js_content"),changeHref:function(e,t){if(e=e.trim(),1===window.ban_jump_link.block_atag)return ban_jump_link.atag_intcp_url;if(!e||0!=e.indexOf("http://mp.weixin.qq.com/")&&0!=e.indexOf("https://mp.weixin.qq.com/")){if(18==ban_scene)return"/mp/ban?action=check&__biz="+biz+"&mid="+mid+"&idx="+idx+"&scene="+ban_scene+"#wechat_redirect";if(0!=e.indexOf("http://mp.weixinbridge.com/mp/wapredirect")&&0!=e.indexOf("https://mp.weixinbridge.com/mp/wapredirect")&&0!=e.indexOf("https://support.weixin.qq.com/cgi-bin/mmsupport-bin/showredpacket"))return"https://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(e)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&type="+t+"&scene=0"}else{let t="&";-1==(e=(e=(e=e.replace(/#rd\s*$/,"")).replace(/#wechat_redirect\s*$/,"")).replace(/[\?&]scene=21/,"")).indexOf("?")&&(t="?"),e+=t+"scene=21#wechat_redirect"}return e}}),function(){if(!document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_section"),t=document.getElementsByClassName("js_product_a"),i=[];function n(e){let t=window.pageYOffset||document.documentElement.scrollTop;for(let n=0;n<i.length;++n){let e=i[n];if(!e.isReport){let i=e.offsetTop;t<=i&&t+_e.getInnerHeight()>=i&&(e.isReport=!0,(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=1&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+e.product_id+"&order="+e.order+"&r="+Math.random())}}}for(let o=0;o<e.length;++o){let t=e[o];t.dataset&&t.dataset.product_id&&t.dataset.order&&i.push({dom:t,offsetTop:t.offsetTop,product_id:t.dataset.product_id||"",order:t.dataset.order||"",isReport:!1})}i.length>0&&(pe.on(window,"scroll",n),n());for(let o=0;o<t.length;++o)!function(e){pe.on(e,"click",(function(t){let i=e.dataset||{};return(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=2&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+(i.product_id||"")+"&order="+(i.order||"")+"&r="+Math.random(),!!i.href&&(setTimeout((function(){location.href="https://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(i.href)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&scene=0"}),300),!1)}),!0)}(t[o])}(),window.originalVideoAdFrames=[],window.originalVideoAdCurrentFrame=null,window.originalVideoAdFramesUnsetList=[],window.addEventListener("message",(function(e){let t="",i=document.getElementsByTagName("iframe");if(e.data&&"originalVideoAdNeedData"==e.data.action&&e.data.vid)if(window.originalVideoAdFramesAdData){window.originalVideoAdFramesAdData&&window.originalVideoAdFramesAdData[e.data.vid]&&(t=window.originalVideoAdFramesAdData[e.data.vid]);for(let n=0;n<i.length;n++)i[n].dataset&&i[n].dataset.mpvid==e.data.vid&&i[n].contentWindow.postMessage({action:"receiveOriginalVideoData",vid:e.data.vid,adData:t},"*")}else console.log(e.data.vid," has no ad data yet"),window.originalVideoAdFramesUnsetList.push(e.data.vid)})),Pa(),window.fromWeixinCached||O();D.getAdData(window.reportVid);let d=[];voiceList&&voiceList.voice_in_appmsg&&voiceList.voice_in_appmsg.length>0&&(d=voiceList.voice_in_appmsg);ro(d),function(){try{new to}catch(ms){console.error("initMusic err",ms)}}(),M(),Ie(),(()=>{const e=document.querySelectorAll(uo.oldTagName);for(let i=0;i<e.length;i++){let t=e[i];const n=document.createElement("mp-common-search"),o=t.getAttribute("data-keywords");t.parentNode.appendChild(n),t.parentNode.removeChild(t),n.setAttribute("data-nickname",window.nickname),n.setAttribute("data-headImg",window.round_head_img),n.setAttribute("data-keywords",o)}const t=document.querySelectorAll(uo.tagName);if(!(t.length<=0))for(let i=0,n=t.length;i<n;i++){let e=t[i];e.classList.add("js_wx_tap_highlight");let n=[];try{n=JSON.parse(window.decodeURIComponent(e.getAttribute("data-keywords")))}catch(ps){ee.setSum(110809,50,1)}if(n.length){let t={nickname:window.nickname,avatar:window.round_head_img,keywords:n};uo.keywords=n;let i=e.parentNode.querySelector('[data-preloadingid="mp-common-search"]');i&&i.parentNode.removeChild(i),wo({dom:e,keywords:t.keywords})}}})(),(()=>{const e=document.querySelectorAll(lo.oldTagName);for(const n of e){const e=document.createElement(lo.tagName);n.parentNode.appendChild(e),n.parentNode.removeChild(n);const t=["pluginname","id","poiid","districtid","name","address","img","longitude","latitude","provice","city","hasreport","type"];for(const i of t){const t="data-".concat(i);e.setAttribute(t,n.getAttribute(t))}}const t=document.querySelectorAll(lo.tagName);for(let n=0,o=t.length;n<o;n++){let e=t[n];e.classList.add("js_wx_tap_highlight");const i={id:decodeURIComponent(e.getAttribute("data-id")||""),name:decodeURIComponent(e.getAttribute("data-name")||""),address:decodeURIComponent(e.getAttribute("data-address")||""),img:decodeURIComponent(e.getAttribute("data-img")||""),longitude:decodeURIComponent(e.getAttribute("data-longitude")||""),latitude:decodeURIComponent(e.getAttribute("data-latitude")||""),type:decodeURIComponent(e.getAttribute("data-type")||"")};let o=e.parentNode.querySelector('[data-preloadingid="'+i.id+'"]');o&&o.parentNode.removeChild(o),lo.poiDom.push(e),mo({poiInfo:i,dom:e})}const i=document.getElementsByClassName("js_poi_entry");for(let n=0;n<i.length;n++)(e=>{const t=i[e];ne.removeClass(t,"ct_geography_loc_tip"),ne.addClass(t,"wx_poi_link"),ne.addClass(t,"js_wx_tap_highlight"),ne.addClass(t,"wx_tap_link"),lo.poiDom.push(t),pe.on(t,"click",(e=>{e.stopPropagation(),e.preventDefault();const i={id:decodeURIComponent(t.getAttribute("data-id")||""),name:decodeURIComponent(t.getAttribute("data-name")||""),address:decodeURIComponent(t.getAttribute("data-address")||""),img:decodeURIComponent(t.getAttribute("data-img")||""),longitude:decodeURIComponent(t.getAttribute("data-longitude")||""),latitude:decodeURIComponent(t.getAttribute("data-latitude")||""),type:decodeURIComponent(t.getAttribute("data-type")||"")};return i.longitude&&i.latitude&&i.name&&i.address&&(ue.report(19937,Object.assign({},lo.commonReportData,{type:1,actiontype:2})),ee.setSum(110809,57,1),po(i)),!1}),!0)})(n);_o(),pe.on(window,"scroll",_o)})(),W.initCpslink(),H.init(),1===window.show_msg_voice&&(Kn(),console.log("load voicemsg"));!window.__appmsgCgiData||1!=window.__appmsgCgiData.wxa_product&&1!=window.__appmsgCgiData.wxa_cps||ta();U.init(),document.getElementsByTagName("mp-qa").length&&ui.renderQaCard({mid:window.mid,idx:window.idx,isLogin:!!window.is_login,userUin:window.user_uin,biz:window.biz,itemShowType:window.item_show_type,sessionId:window.sessionid,enterId:window.enterid,scene:window.source,subScene:window.subscene});const l=document.getElementsByTagName("mp-common-videosnap");(document.getElementsByTagName("mpvideosnap")&&document.getElementsByTagName("mpvideosnap").length||l&&l.length)&&Zo();const p=document.getElementsByTagName("mp-common-profile");(document.getElementsByTagName("mpprofile")&&document.getElementsByTagName("mpprofile").length||p&&p.length)&&va();document.getElementsByTagName("mp-common-sticker")&&document.getElementsByTagName("mp-common-sticker").length&&ja();if(function(){qa&&qa.length&&Ua()}(),document.getElementsByTagName("mp-wxaproduct").length){const e=window.__appmsgCgiData.minishopCardData?JSON.parse(decodeURIComponent(window.__appmsgCgiData.minishopCardData)):"";mt({biz:window.biz,mid:window.mid,idx:window.idx,source:1*window.source,subscene:1*window.subscene,enterid:1*window.enterid,minishopCards:e})}function m(){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e.timing){let t=e.timing;Z.log("[Appmsg] dns:"+(t.domainLookupEnd-t.domainLookupStart)+"^^^ ssl:"+(0==t.secureConnectionStart?0:t.connectEnd-t.secureConnectionStart)+"^^^ tcp:"+(t.connectEnd-t.connectStart)+"^^^ request:"+(t.responseStart-t.requestStart)+"^^^ getPackageTime:"+(t.responseEnd-t.responseStart)+"^^^ domCententLoaded:"+(t.domContentLoadedEventStart-t.domLoading)+"^^^ domComplete:"+(t.domComplete-t.domLoading)+"^^^ firstViewTime:"+(real_show_page_time-t.navigationStart)+"^^^ interactiveTime:"+(window.page_endtime-t.navigationStart)),window.navigator.userAgent,setTimeout((function(){t.loadEventEnd&&Z.log("[Appmsg] onload:"+(t.loadEventEnd-t.loadEventStart))}),100)}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),""==document.getElementById("js_content").innerHTML.trim()&&ee.setSum(24729,94,1);Math.random()<.001&&document.getElementById("js_read_area3")&&document.getElementById("js_read_area3").innerText&&document.getElementById("js_read_area3").innerText.indexOf("Pageview")>-1&&ee.setSum(24729,95,1),window.__wxjs_is_wkwebview&&ee.setSum(28307,67,1)}ae.invoke("getNetworkType",{},(function(e){networkType=ma[e.err_msg],"network_type:edge"!=e.err_msg&&"network_type:wwan"!=e.err_msg||(e.detailtype&&"4g"==e.detailtype||e.subtype&&"4g"==e.subtype)&&(networkType="4g"),pa()})),void pe.on(window,"load",pa,!1),new Ri({biz:window.biz,isPaySubscribe:window.isPaySubscribe,container:document.getElementById("js_content"),logid:18504,baseData:["",window.biz,window.mid,window.idx,window.location.href,window.msg_title]}),setTimeout((function(){pe.tap(document.getElementById("copyright_logo"),(function(){const e="http://kf.qq.com/touch/sappfaq/150211YfyMVj150326iquI3e.html";window.__second_open__?ae.invoke("openUrlWithExtraWebview",{url:e,openType:1},(function(t){-1==t.err_msg.indexOf("ok")&&(location.href=e)})):location.href=e})),nt(),F.init({dom:document.getElementById("js_report_article3"),title:window.msg_title.htmlDecode(),link:window.msg_link}),function(){if(r&&!window.cps_article_data){document.title=window.msg_title.htmlDecode(),ne.addClass(i,"not_in_mm");let e=document.getElementById("js_pc_qr_code_img");if(e){let t=10000004,i=document.referrer;if(0==i.indexOf("http://weixin.sogou.com")?t=10000001:0==i.indexOf("https://wx.qq.com")&&(t=10000003),window.isSg)e.setAttribute("src",sg_qr_code.htmlDecode());else{e.setAttribute("src","/mp/qrcode?scene="+t+"&size=102&__biz="+biz+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&send_time="+send_time),(new Image).src="/mp/report?action=pcclick&__biz="+biz+"&uin="+uin+"&scene="+t+"&r="+Math.random()}document.getElementById("js_pc_qr_code").style.display="block"}let t=document.getElementById("js_profile_qrcode"),n=document.getElementById("js_profile_arrow_wrp"),o=document.getElementById("profileBt");if(t&&o&&n){let e=function(){let e=10000005,i=document.referrer;0==i.indexOf("http://weixin.sogou.com")?e=10000006:0==i.indexOf("https://wx.qq.com")&&(e=10000007);let a=document.getElementById("js_profile_qrcode_img");if(a)if(window.isSg)a.setAttribute("src",sg_qr_code.htmlDecode());else{a.setAttribute("src","/mp/qrcode?scene="+e+"&size=102&__biz="+biz+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&send_time="+send_time),(new Image).src="/mp/report?action=pcclick&__biz="+biz+"&uin="+uin+"&scene="+e+"&r="+Math.random()}return t.style.display="block",n.style.left=o.offsetWidth/2-8+"px",!1};pe.on(o,"click",e),pe.on(t,"click",e),pe.on(document,"click",(function(e){let i=e.target||e.srcElement;i!=o&&i!=t&&(t.style.display="none")}))}}else{const e=document.getElementById("js_report_article3");e&&(e.style.display="")}}();const e=document.getElementsByTagName("map");for(let i=0,n=e.length;i<n;++i)e[i].parentNode.removeChild(e[i]);if(Di.card_pv_report(),Math.random()<.01)try{let e="https://js.aq.qq.com/js/aq_common.js",t=document.createElement("script");t.src=e,document.getElementsByTagName("head")[0].appendChild(t)}catch(ps){}const t=document.getElementById("js_close_temp");pe.on(t,"click",(function(){t.parentNode.parentNode.removeChild(t.parentNode),ne.removeClass(document.getElementById("js_article"),"preview_appmsg")}))}),1e3),function(){if(!Q.os.ios||!("onorientationchange"in window))return;const e=[],t="onorientationchange"in window?"orientationchange":"resize";let i=!1,n=function(){return 90===Math.abs(window.orientation)?1:2};1!==n()||i||(Ae.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report","biz: ".concat("function"==typeof window.atob?window.atob(window.biz):window.biz," | mid: ").concat(window.mid," | idx: ").concat(window.idx," | url: ").concat(location.href),{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),i=!0),e.push({ori:n(),scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1});const o=(new Date).getHours();pe.on(window,t,(function(){const t=e.length-2,a=n();if(ds=+new Date,t>=0){const i=e[t];e[e.length-1].istouchmove||(o>=11&&o<=17&&window.__report(63),setTimeout((function(){window.scrollTo(0,i.scroll)}),100))}e.push({ori:a,scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1}),1!==a||i||(Ae.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report","biz: ".concat("function"==typeof window.atob?window.atob(window.biz):window.biz," | mid: ").concat(window.mid," | idx: ").concat(window.idx," | url: ").concat(location.href),{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),i=!0)})),pe.on(window,"scroll",(function(){const t=e.length-1,i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,o=Date.now();if(-1!=ds){if(console.log("[横屏滚动检测]",o-ds),o-ds<500)return void(ds=-1)}else ds=-1;e[t].ori==n()&&(e[t].scroll=i,e[t].istouchmove=!0)}))}(),Z.log("[Appmsg] href:"+location.href+"^^^ ua:"+window.navigator.userAgent),window.addEventListener?window.addEventListener("load",m,!1):window.attachEvent&&window.attachEvent("onload",m);void(window.addEventListener&&document.getElementsByTagName("body")[0].addEventListener("copy",(function(){ee.setSum(28307,18,1),oe.isIOS&&ee.setSum(28307,19,1),oe.isAndroid&&ee.setSum(28307,20,1)}),!1)),window.__observer&&window.__observer_data&&es();"undefined"!=typeof isSg&&function(){if(document.getElementById("js_report_article3")&&(document.getElementById("js_report_article3").style.display="none"),document.getElementById("js_content_end")&&(document.getElementById("js_content_end").style.display="none"),function(){let e=document.createElement("div");e&&(e.innerHTML=me.tmpl(co,{}),document.body.appendChild(e))}(),new o.Emotion({emotionPanel:s("#js_emotion_panel"),inputArea:s("#js_cmt_input"),emotionPanelArrowWrp:s("#js_emotion_panel_arrow_wrp"),emotionSwitcher:s("#js_emotion_switch"),emotionSlideWrapper:s("#js_slide_wrapper"),emotionNavBar:s("#js_navbar"),submitBtn:s("#js_cmt_submit")}),navigator.userAgent.toLowerCase().match(/ios/)){let t=navigator.userAgent.toLowerCase().match(/(?:sogousearch\/ios\/)(.*)/);if(t&&t[1]){let i=t[1].replace(/\./g,"");parseInt(i)>422&&e("ios")}}else e("android");function e(e){let t=document.getElementById("js_cover"),i=[];t&&i.push(t);let n=document.getElementById("js_content");if(n){let e=n.getElementsByTagName("img")||[];for(let t=0,n=e.length;t<n;t++)i.push(e.item(t))}let o=[];for(let a=0,s=i.length;a<s;a++){let t=i[a],n=t.getAttribute("data-src")||t.getAttribute("src");n&&(o.push(n),function(i){pe.on(t,"click",(function(t){return"ios"==e?window.JSInvoker&&window.JSInvoker.openImageList&&window.JSInvoker.openImageList(JSON.stringify({index:i,array:o})):window.JSInvoker&&JSInvoker.weixin_openImageList&&window.JSInvoker.weixin_openImageList(JSON.stringify({index:i,array:o})),!1}))}(a))}}window.onerror=function(e){(new Image).src="/mp/jsreport?key=86&content="+e+"&r="+Math.random()}}();setTimeout((function(){const e=function(){ee.setLogs({id:28307,key:49,value:1,lc:1,log0:"[28307_49_appmsg_fe_filter]"+encodeURIComponent(location.href)})},t=(window.appmsg_fe_filter||"").split(","),i=function(t,i){try{if(!t)return;if(t.querySelectorAll){const n=t.querySelectorAll("*["+i+"]");if(n&&n.length>0){e();for(let e=0;e<n.length;++e)n[e]&&n[e].removeAttribute&&n[e].removeAttribute(i)}return}const n=t.childNodes;if(t.hasAttribute&&t.hasAttribute(i)&&e(),t.removeAttribute&&t.removeAttribute(i),n&&n.length)for(let e=0;e<n.length;++e)filterContenteditable(n[e])}catch(ps){}};let n=document.getElementById("js_content");for(let o=0;o<t.length;++o)t[o]&&i(n,t[o])}),0),setTimeout((function(){const e="//mmbiz.qpic.cn/mmbiz_png/7lG1x2vpicdic0p5bBthpD9lsJcINicsSzd6uKQQJyoj5oTl8lFIs9K0fIibgxCzms0enDLTRxTHLpDPCLpSvIExiag/640",t=(new Date).getHours();if(t<11||t>16||Math.random()<.99)return;const i=new Image;i.onload=function(){const e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;640===e&&407===t||window.__addIdKeyReport("28307","wifi"===window.networkType?120:123),window.__addIdKeyReport("28307","wifi"===window.networkType?121:124)},i.src="http:"+e;const n=new Image;n.onload=function(){const e=n.naturalWidth||n.width,t=n.naturalHeight||n.height;640===e&&407===t||window.__addIdKeyReport("28307",126),window.__addIdKeyReport("28307",127)},n.src="https:"+e}),3e3);if(Math.random()<2e-4)try{const e=document.getElementsByTagName("img"),t=window.screen.height,i=window.screen.width,n=window.devicePixelRatio;let o="";for(let a=0,s=e.length;a<s;a++){const s=e[a].getAttribute("data-src");if(s){let r=e[a].getBoundingClientRect();o+=i+"|"+t+"|"+r.left.toFixed(2)+"|"+(i-r.right).toFixed(2)+"|"+r.width.toFixed(2)+"|"+n.toFixed(2)+"|"+s+";"}}K({url:"/mp/wapreport?action=img_display_report",data:{key:o},type:"POST",dataType:"json",async:!0})}catch(ps){}setTimeout((function(){J&&J("updatePageHeight")}),2e3),oe.isIOS&&location.href.match(/fontScale=\d+/)&&T.isIPadOS13&&setTimeout((function(){if(window.ipados13_font_scale)return;const e=location.href.match(/fontScale=(\d+)/);window.ipados13_font_scale=parseFloat(e[1]),T.setFontSize(document.getElementsByTagName("html").item(0),window.ipados13_font_scale/100)}),500);Z.log("[PagePos] init entry"),console.log("[PagePos] init entry"),P.init({hasSpAd:!0,disableScroll:window.isPaySubscribe&&!window.isPaid&&window.jump2pay||e||c}),window.__main_process_finish__=!0}(),!window.__second_open__){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e&&e.timing){const t=window.location.protocol;a.saveSpeeds({uin:uin,pid:"https:"==t?462:417,speeds:{sid:34,time:Date.now()-e.timing.navigationStart}}),a.send()}Te({isPaySubscribe:window.isPaySubscribe})}export{e as __vite_legacy_guard};
